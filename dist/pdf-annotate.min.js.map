{"version":3,"file":"pdf-annotate.min.js","mappings":"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","sources":["webpack://PDFAnnotate/webpack/universalModuleDefinition","webpack://PDFAnnotate/./node_modules/create-stylesheet/index.js","webpack://PDFAnnotate/./node_modules/events/events.js","webpack://PDFAnnotate/./node_modules/object-assign/index.js","webpack://PDFAnnotate/webpack/bootstrap","webpack://PDFAnnotate/webpack/runtime/compat get default export","webpack://PDFAnnotate/webpack/runtime/define property getters","webpack://PDFAnnotate/webpack/runtime/hasOwnProperty shorthand","webpack://PDFAnnotate/webpack/runtime/make namespace object","webpack://PDFAnnotate/./src/utils/abstractFunction.js","webpack://PDFAnnotate/./src/UI/utils.js","webpack://PDFAnnotate/./src/UI/event.js","webpack://PDFAnnotate/./src/adapter/StoreAdapter.js","webpack://PDFAnnotate/./src/utils/uuid.js","webpack://PDFAnnotate/./src/adapter/LocalStoreAdapter.js","webpack://PDFAnnotate/./src/utils/setAttributes.js","webpack://PDFAnnotate/./src/utils/normalizeColor.js","webpack://PDFAnnotate/./src/render/renderPoint.js","webpack://PDFAnnotate/./src/render/renderRect.js","webpack://PDFAnnotate/./src/render/appendChild.js","webpack://PDFAnnotate/./src/render/renderLine.js","webpack://PDFAnnotate/./src/render/renderText.js","webpack://PDFAnnotate/./src/render/renderPath.js","webpack://PDFAnnotate/./src/a11y/createScreenReaderOnly.js","webpack://PDFAnnotate/./src/a11y/insertElementWithinElement.js","webpack://PDFAnnotate/./src/a11y/insertElementWithinChildren.js","webpack://PDFAnnotate/./src/a11y/insertScreenReaderComment.js","webpack://PDFAnnotate/./src/a11y/renderScreenReaderComments.js","webpack://PDFAnnotate/./src/a11y/insertScreenReaderHint.js","webpack://PDFAnnotate/./src/a11y/initEventHandlers.js","webpack://PDFAnnotate/./src/a11y/renderScreenReaderHints.js","webpack://PDFAnnotate/./src/UI/edit.js","webpack://PDFAnnotate/./src/UI/pen.js","webpack://PDFAnnotate/./src/UI/point.js","webpack://PDFAnnotate/./src/UI/rect.js","webpack://PDFAnnotate/./src/UI/text.js","webpack://PDFAnnotate/./src/UI/page.js","webpack://PDFAnnotate/./src/UI/index.js","webpack://PDFAnnotate/./src/PDFJSAnnotate.js","webpack://PDFAnnotate/./src/render/index.js","webpack://PDFAnnotate/./index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PDFAnnotate\"] = factory();\n\telse\n\t\troot[\"PDFAnnotate\"] = factory();\n})(self, function() {\nreturn ","module.exports = function createStyleSheet(blocks) {\n  var style = document.createElement('style');\n  var text = Object.keys(blocks).map(function (selector) {\n    return processRuleSet(selector, blocks[selector]);\n  }).join('\\n');\n  \n  style.setAttribute('type', 'text/css');\n  style.appendChild(document.createTextNode(text));\n\n  return style;\n}\n\nfunction processRuleSet(selector, block) {\n  return selector + ' {\\n' + processDeclarationBlock(block) + '\\n}';\n}\n\nfunction processDeclarationBlock(block) {\n  return Object.keys(block).map(function (prop) {\n    return processDeclaration(prop, block[prop]);\n  }).join('\\n');\n}\n\nfunction processDeclaration(prop, value) {\n  if (!isNaN(value) && value != 0) {\n    value = value + 'px';\n  }\n\n  return hyphenate(prop) + ': ' + value + ';';\n}\n\nfunction hyphenate(prop) {\n  return prop.replace(/[A-Z]/g, function (match) {\n    return '-' + match.toLowerCase();\n  });\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\r\n * Throw an Error for an abstract function that hasn't been implemented.\r\n *\r\n * @param {String} name The name of the abstract function\r\n */\r\nexport default function abstractFunction(name) {\r\n  throw new Error(name + ' is not implemented');\r\n}\r\n","import createStyleSheet from 'create-stylesheet';\r\n\r\nexport const BORDER_COLOR = '#00BFFF';\r\n\r\nconst userSelectStyleSheet = createStyleSheet({\r\n  body: {\r\n    '-webkit-user-select': 'none',\r\n       '-moz-user-select': 'none',\r\n        '-ms-user-select': 'none',\r\n            'user-select': 'none'\r\n  }\r\n});\r\nuserSelectStyleSheet.setAttribute('data-pdf-annotate-user-select', 'true');\r\n\r\n/**\r\n * Find the SVGElement that contains all the annotations for a page\r\n *\r\n * @param {Element} node An annotation within that container\r\n * @return {SVGElement} The container SVG or null if it can't be found\r\n */\r\nexport function findSVGContainer(node) {\r\n  let parentNode = node;\r\n\r\n  while ((parentNode = parentNode.parentNode) &&\r\n          parentNode !== document) {\r\n    if (parentNode.nodeName.toUpperCase() === 'SVG' &&\r\n        parentNode.getAttribute('data-pdf-annotate-container') === 'true') {\r\n      return parentNode;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Find an SVGElement container at a given point\r\n *\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @return {SVGElement} The container SVG or null if one can't be found\r\n */\r\nexport function findSVGAtPoint(x, y) {\r\n  let elements = document.querySelectorAll('svg[data-pdf-annotate-container=\"true\"]');\r\n\r\n  for (let i=0, l=elements.length; i<l; i++) {\r\n    let el = elements[i];\r\n    let rect = el.getBoundingClientRect();\r\n\r\n    if (pointIntersectsRect(x, y, rect)) {\r\n\r\n      return el;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Find an Element that represents an annotation at a given point\r\n *\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @return {Element} The annotation element or null if one can't be found\r\n */\r\nexport function findAnnotationAtPoint(x, y) {\r\n  let svg = findSVGAtPoint(x, y);\r\n  if (!svg) { return; }\r\n  let elements = svg.querySelectorAll('[data-pdf-annotate-type]');\r\n\r\n  // Find a target element within SVG\r\n  for (let i=0, l=elements.length; i<l; i++) {\r\n    let el = elements[i];\r\n    if (pointIntersectsRect(x, y, getOffsetAnnotationRect(el))) {   \r\n      return el;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Determine if a point intersects a rect\r\n *\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @param {Object} rect The points of a rect (likely from getBoundingClientRect)\r\n * @return {Boolean} True if a collision occurs, otherwise false\r\n */\r\nexport function pointIntersectsRect(x, y, rect) {\r\n  return y >= rect.top && y <= rect.bottom && x >= rect.left && x <= rect.right;\r\n}\r\n\r\n/**\r\n * Get the rect of an annotation element accounting for offset.\r\n *\r\n * @param {Element} el The element to get the rect of\r\n * @return {Object} The dimensions of the element\r\n */\r\nexport function getOffsetAnnotationRect(el) {\r\n  let rect = getAnnotationRect(el);\r\n  let { offsetLeft, offsetTop } = getOffset(el);\r\n  return {\r\n    top: rect.top + offsetTop,\r\n    left: rect.left + offsetLeft,\r\n    right: rect.right + offsetLeft,\r\n    bottom: rect.bottom + offsetTop\r\n  };\r\n}\r\n\r\n/**\r\n * Get the rect of an annotation element.\r\n *\r\n * @param {Element} el The element to get the rect of\r\n * @return {Object} The dimensions of the element\r\n */\r\nexport function getAnnotationRect(el) {\r\n  let h = 0, w = 0, x = 0, y = 0;\r\n  let rect = el.getBoundingClientRect();\r\n  // TODO this should be calculated somehow\r\n  const LINE_OFFSET = 16;\r\n\r\n  switch (el.nodeName.toLowerCase()) {\r\n    case 'path':\r\n    let minX, maxX, minY, maxY;\r\n\r\n    el.getAttribute('d').replace(/Z/, '').split('M').splice(1).forEach((p) => {\r\n      var s = p.split(' ').map(i => parseInt(i, 10));\r\n\r\n      if (typeof minX === 'undefined' || s[0] < minX) { minX = s[0]; }\r\n      if (typeof maxX === 'undefined' || s[2] > maxX) { maxX = s[2]; }\r\n      if (typeof minY === 'undefined' || s[1] < minY) { minY = s[1]; }\r\n      if (typeof maxY === 'undefined' || s[3] > maxY) { maxY = s[3]; }\r\n    });\r\n\r\n    h = maxY - minY;\r\n    w = maxX - minX;\r\n    x = minX;\r\n    y = minY;\r\n    break;\r\n\r\n    case 'line':\r\n    h = parseInt(el.getAttribute('y2'), 10) - parseInt(el.getAttribute('y1'), 10);\r\n    w = parseInt(el.getAttribute('x2'), 10) - parseInt(el.getAttribute('x1'), 10);\r\n    x = parseInt(el.getAttribute('x1'), 10);\r\n    y = parseInt(el.getAttribute('y1'), 10);\r\n\r\n    if (h === 0) {\r\n      h += LINE_OFFSET;\r\n      y -= (LINE_OFFSET / 2);\r\n    }\r\n    break;\r\n\r\n    case 'text':\r\n    h = rect.height;\r\n    w = rect.width;\r\n    x = parseInt(el.getAttribute('x'), 10);\r\n    y = parseInt(el.getAttribute('y'), 10) - h;\r\n    break;\r\n\r\n    case 'g':\r\n    let { offsetLeft, offsetTop } = getOffset(el);\r\n    h = rect.height;\r\n    w = rect.width;\r\n    x = rect.left - offsetLeft;\r\n    y = rect.top - offsetTop;\r\n\r\n    if (el.getAttribute('data-pdf-annotate-type') === 'strikeout') {\r\n      h += LINE_OFFSET;\r\n      y -= (LINE_OFFSET / 2);\r\n    }\r\n    break;\r\n\r\n    case 'rect':\r\n    case 'svg':\r\n    h = parseInt(el.getAttribute('height'), 10);\r\n    w = parseInt(el.getAttribute('width'), 10);\r\n    x = parseInt(el.getAttribute('x'), 10);\r\n    y = parseInt(el.getAttribute('y'), 10);\r\n    break;\r\n  }\r\n\r\n  // Result provides same properties as getBoundingClientRect\r\n  let result = {\r\n    top: y,\r\n    left: x,\r\n    width: w,\r\n    height: h,\r\n    right: x + w,\r\n    bottom: y + h\r\n  };\r\n\r\n  // For the case of nested SVG (point annotations) and grouped\r\n  // lines or rects no adjustment needs to be made for scale.\r\n  // I assume that the scale is already being handled\r\n  // natively by virtue of the `transform` attribute.\r\n  if (!['svg', 'g'].includes(el.nodeName.toLowerCase())) {\r\n    result = scaleUp(findSVGAtPoint(rect.left, rect.top), result);\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Adjust scale from normalized scale (100%) to rendered scale.\r\n *\r\n * @param {SVGElement} svg The SVG to gather metadata from\r\n * @param {Object} rect A map of numeric values to scale\r\n * @return {Object} A copy of `rect` with values scaled up\r\n */\r\nexport function scaleUp(svg, rect) {\r\n  let result = {};\r\n  let { viewport } = getMetadata(svg);\r\n\r\n  Object.keys(rect).forEach((key) => {\r\n    result[key] = rect[key] * viewport.scale;\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Adjust scale from rendered scale to a normalized scale (100%).\r\n *\r\n * @param {SVGElement} svg The SVG to gather metadata from\r\n * @param {Object} rect A map of numeric values to scale\r\n * @return {Object} A copy of `rect` with values scaled down\r\n */\r\nexport function scaleDown(svg, rect) {\r\n  let result = {};\r\n  let { viewport } = getMetadata(svg);\r\n\r\n  Object.keys(rect).forEach((key) => {\r\n    result[key] = rect[key] / viewport.scale;\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Get the scroll position of an element, accounting for parent elements\r\n *\r\n * @param {Element} el The element to get the scroll position for\r\n * @return {Object} The scrollTop and scrollLeft position\r\n */\r\nexport function getScroll(el) {\r\n  let scrollTop = 0;\r\n  let scrollLeft = 0;\r\n  let parentNode = el;\r\n\r\n  while ((parentNode = parentNode.parentNode) &&\r\n          parentNode !== document) {\r\n    scrollTop += parentNode.scrollTop;\r\n    scrollLeft += parentNode.scrollLeft;\r\n  }\r\n\r\n  return { scrollTop, scrollLeft };\r\n}\r\n\r\n/**\r\n * Get the offset position of an element, accounting for parent elements\r\n *\r\n * @param {Element} el The element to get the offset position for\r\n * @return {Object} The offsetTop and offsetLeft position\r\n */\r\nexport function getOffset(el) {\r\n  let parentNode = el;\r\n\r\n  while ((parentNode = parentNode.parentNode) &&\r\n          parentNode !== document) {\r\n    if (parentNode.nodeName.toUpperCase() === 'SVG') {\r\n      break;\r\n    }\r\n  }\r\n\r\n  let rect = parentNode.getBoundingClientRect();\r\n\r\n  return { offsetLeft: rect.left, offsetTop: rect.top };\r\n}\r\n\r\n/**\r\n * Disable user ability to select text on page\r\n */\r\nexport function disableUserSelect() {\r\n  if (!userSelectStyleSheet.parentNode) {\r\n    document.head.appendChild(userSelectStyleSheet);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * Enable user ability to select text on page\r\n */\r\nexport function enableUserSelect() {\r\n  if (userSelectStyleSheet.parentNode) {\r\n    userSelectStyleSheet.parentNode.removeChild(userSelectStyleSheet);\r\n  }\r\n}\r\n\r\n/**\r\n * Get the metadata for a SVG container\r\n *\r\n * @param {SVGElement} svg The SVG container to get metadata for\r\n */\r\nexport function getMetadata(svg) {\r\n  return {\r\n    documentId: svg.getAttribute('data-pdf-annotate-document'),\r\n    pageNumber: parseInt(svg.getAttribute('data-pdf-annotate-page'), 10),\r\n    viewport: JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'))\r\n  };\r\n}\r\n","import EventEmitter from 'events';\r\nimport {\r\n  findAnnotationAtPoint,\r\n  findSVGAtPoint\r\n} from './utils';\r\n\r\nconst emitter = new EventEmitter;\r\n\r\nlet clickNode;\r\n\r\n/**\r\n * Handle document.click event\r\n *\r\n * @param {Event} e The DOM event to be handled\r\n */\r\ndocument.addEventListener('click', function handleDocumentClick(e) {\r\n  if (!findSVGAtPoint(e.clientX, e.clientY)) { return; }\r\n\r\n  let target = findAnnotationAtPoint(e.clientX, e.clientY);\r\n\r\n  // Emit annotation:blur if clickNode is no longer clicked\r\n  if (clickNode && clickNode !== target) {\r\n    emitter.emit('annotation:blur', clickNode);\r\n  }\r\n\r\n  // Emit annotation:click if target was clicked\r\n  if (target) {\r\n    emitter.emit('annotation:click', target);\r\n  }\r\n\r\n  clickNode = target;\r\n});\r\n\r\n// let mouseOverNode;\r\n// document.addEventListener('mousemove', function handleDocumentMousemove(e) {\r\n//   let target = findAnnotationAtPoint(e.clientX, e.clientY);\r\n//\r\n//   // Emit annotation:mouseout if target was mouseout'd\r\n//   if (mouseOverNode && !target) {\r\n//     emitter.emit('annotation:mouseout', mouseOverNode);\r\n//   }\r\n//\r\n//   // Emit annotation:mouseover if target was mouseover'd\r\n//   if (target && mouseOverNode !== target) {\r\n//     emitter.emit('annotation:mouseover', target);\r\n//   }\r\n//\r\n//   mouseOverNode = target;\r\n// });\r\n\r\nexport function fireEvent() { emitter.emit(...arguments); };\r\nexport function addEventListener() { emitter.on(...arguments); };\r\nexport function removeEventListener() { emitter.removeListener(...arguments); };\r\n","import abstractFunction from '../utils/abstractFunction';\r\nimport { fireEvent } from '../UI/event';\r\n\r\n// Adapter should never be invoked publicly\r\nexport default class StoreAdapter {\r\n  /**\r\n   * Create a new StoreAdapter instance\r\n   *\r\n   * @param {Object} [definition] The definition to use for overriding abstract methods\r\n   */\r\n  constructor(definition = {}) {\r\n    // Copy each function from definition if it is a function we know about\r\n    Object.keys(definition).forEach((key) => {\r\n      if (typeof definition[key] === 'function' &&\r\n          typeof this[key] === 'function') {\r\n        this[key] = definition[key];\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get all the annotations for a given document and page number.\r\n   *\r\n   * @param {String} documentId The ID for the document the annotations belong to\r\n   * @param {Number} pageNumber The number of the page the annotations belong to\r\n   * @return {Promise}\r\n   */\r\n  __getAnnotations(documentId, pageNumber) { abstractFunction('getAnnotations'); }\r\n  get getAnnotations() { return this.__getAnnotations; }\r\n  set getAnnotations(fn) {\r\n    this.__getAnnotations = function getAnnotations(documentId, pageNumber) {\r\n      return fn(...arguments).then((annotations) => {\r\n        // TODO may be best to have this happen on the server\r\n        if (annotations.annotations) {\r\n          annotations.annotations.forEach((a) => {\r\n            a.documentId = documentId;\r\n          });\r\n        }\r\n        return annotations;\r\n      });\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get the definition for a specific annotation.\r\n   *\r\n   * @param {String} documentId The ID for the document the annotation belongs to\r\n   * @param {String} annotationId The ID for the annotation\r\n   * @return {Promise}\r\n   */\r\n  getAnnotation(documentId, annotationId) { abstractFunction('getAnnotation'); }\r\n\r\n  /**\r\n   * Add an annotation\r\n   *\r\n   * @param {String} documentId The ID for the document to add the annotation to\r\n   * @param {String} pageNumber The page number to add the annotation to\r\n   * @param {Object} annotation The definition for the new annotation\r\n   * @return {Promise}\r\n   */\r\n  __addAnnotation(documentId, pageNumber, annotation) { abstractFunction('addAnnotation'); }\r\n  get addAnnotation() { return this.__addAnnotation; }\r\n  set addAnnotation(fn) {\r\n    this.__addAnnotation = function addAnnotation(documentId, pageNumber, annotation) {\r\n      return fn(...arguments).then((annotation) => {\r\n        fireEvent('annotation:add', documentId, pageNumber, annotation);\r\n        return annotation;\r\n      });\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Edit an annotation\r\n   *\r\n   * @param {String} documentId The ID for the document\r\n   * @param {String} pageNumber the page number of the annotation\r\n   * @param {Object} annotation The definition of the modified annotation\r\n   * @return {Promise}\r\n   */\r\n  __editAnnotation(documentId, pageNumber, annotation) { abstractFunction('editAnnotation'); }\r\n  get editAnnotation() { return this.__editAnnotation; }\r\n  set editAnnotation(fn) {\r\n    this.__editAnnotation = function editAnnotation(documentId, annotationId, annotation) {\r\n      return fn(...arguments).then((annotation) => {\r\n        fireEvent('annotation:edit', documentId, annotationId, annotation);\r\n        return annotation;\r\n      });\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Delete an annotation\r\n   *\r\n   * @param {String} documentId The ID for the document\r\n   * @param {String} annotationId The ID for the annotation\r\n   * @return {Promise}\r\n   */\r\n  __deleteAnnotation(documentId, annotationId) { abstractFunction('deleteAnnotation'); }\r\n  get deleteAnnotation() { return this.__deleteAnnotation; }\r\n  set deleteAnnotation(fn) {\r\n    this.__deleteAnnotation = function deleteAnnotation(documentId, annotationId) {\r\n      return fn(...arguments).then((success) => {\r\n        if (success) {\r\n          fireEvent('annotation:delete', documentId, annotationId);\r\n        }\r\n        return success;\r\n      });\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get all the comments for an annotation\r\n   *\r\n   * @param {String} documentId The ID for the document\r\n   * @param {String} annotationId The ID for the annotation\r\n   * @return {Promise}\r\n   */\r\n  getComments(documentId, annotationId) { abstractFunction('getComments'); }\r\n\r\n  /**\r\n   * Add a new comment\r\n   *\r\n   * @param {String} documentId The ID for the document\r\n   * @param {String} annotationId The ID for the annotation\r\n   * @param {Object} content The definition of the comment\r\n   * @return {Promise}\r\n   */\r\n  __addComment(documentId, annotationId, content) { abstractFunction('addComment'); }\r\n  get addComment() { return this.__addComment; }\r\n  set addComment(fn) {\r\n    this.__addComment = function addComment(documentId, annotationId, content) {\r\n      return fn(...arguments).then((comment) => {\r\n        fireEvent('comment:add', documentId, annotationId, comment);\r\n        return comment;\r\n      });\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Delete a comment\r\n   *\r\n   * @param {String} documentId The ID for the document\r\n   * @param {String} commentId The ID for the comment\r\n   * @return {Promise}\r\n   */\r\n  __deleteComment(documentId, commentId) { abstractFunction('deleteComment'); }\r\n  get deleteComment() { return this.__deleteComment; }\r\n  set deleteComment(fn) {\r\n    this.__deleteComment = function deleteComment(documentId, commentId) {\r\n      return fn(...arguments).then((success) => {\r\n        if (success) {\r\n          fireEvent('comment:delete', documentId, commentId);\r\n        }\r\n        return success;\r\n      });\r\n    };\r\n  }\r\n}\r\n","const REGEXP = /[xy]/g\r\nconst PATTERN = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\r\n\r\nfunction replacement(c) {\r\n  let r = Math.random()*16|0;\r\n  let v = c == 'x' ? r : (r&0x3|0x8);\r\n  return v.toString(16);\r\n}\r\n\r\n/**\r\n * Generate a univierally unique identifier\r\n *\r\n * @return {String}\r\n */\r\nexport default function uuid() {\r\n  return PATTERN.replace(REGEXP, replacement);\r\n}\r\n","import uuid from '../utils/uuid';\r\nimport StoreAdapter from './StoreAdapter';\r\n\r\n// StoreAdapter for working with localStorage\r\n// This is ideal for testing, examples, and prototyping\r\nexport default class LocalStoreAdapter extends StoreAdapter {\r\n  constructor() {\r\n    super({\r\n      getAnnotations(documentId, pageNumber) {\r\n        return new Promise((resolve, reject) => {\r\n          let annotations = getAnnotations(documentId).filter((i) => {\r\n            return i.page === pageNumber && i.class === 'Annotation';\r\n          });\r\n\r\n          resolve({\r\n            documentId,\r\n            pageNumber,\r\n            annotations\r\n          });\r\n        });\r\n      },\r\n\r\n      getAnnotation(documentId, annotationId) {\r\n        return Promise.resolve(getAnnotations(documentId)[findAnnotation(documentId, annotationId)]);\r\n      },\r\n\r\n      addAnnotation(documentId, pageNumber, annotation) {\r\n        return new Promise((resolve, reject) => {\r\n          annotation.class = 'Annotation';\r\n          annotation.uuid = uuid();\r\n          annotation.page = pageNumber;\r\n\r\n          let annotations = getAnnotations(documentId);\r\n          annotations.push(annotation);\r\n          updateAnnotations(documentId, annotations);\r\n\r\n          resolve(annotation);\r\n        });\r\n      },\r\n\r\n      editAnnotation(documentId, annotationId, annotation) {\r\n        return new Promise((resolve, reject) => {\r\n          let annotations = getAnnotations(documentId);\r\n          annotations[findAnnotation(documentId, annotationId)] = annotation;\r\n          updateAnnotations(documentId, annotations);\r\n\r\n          resolve(annotation);\r\n        });\r\n      },\r\n\r\n      deleteAnnotation(documentId, annotationId) {\r\n        return new Promise((resolve, reject) => {\r\n          let index = findAnnotation(documentId, annotationId);\r\n          if (index > -1) {\r\n            let annotations = getAnnotations(documentId);\r\n            annotations.splice(index, 1);\r\n            updateAnnotations(documentId, annotations);\r\n          }\r\n\r\n          resolve(true);\r\n        });\r\n      },\r\n\r\n      getComments(documentId, annotationId) {\r\n        return new Promise((resolve, reject) => {\r\n          resolve(getAnnotations(documentId).filter((i) => {\r\n            return i.class === 'Comment' && i.annotation === annotationId;\r\n          }));\r\n        });\r\n      },\r\n\r\n      addComment(documentId, annotationId, content) {\r\n        return new Promise((resolve, reject) => {\r\n          let comment = {\r\n            class: 'Comment',\r\n            uuid: uuid(),\r\n            annotation: annotationId,\r\n            content: content\r\n          };\r\n\r\n          let annotations = getAnnotations(documentId);\r\n          annotations.push(comment);\r\n          updateAnnotations(documentId, annotations);\r\n\r\n          resolve(comment);\r\n        });\r\n      },\r\n\r\n      deleteComment(documentId, commentId) {\r\n        return new Promise((resolve, reject) => {\r\n          getAnnotations(documentId);\r\n          let index = -1;\r\n          let annotations = getAnnotations(documentId);\r\n          for (let i=0, l=annotations.length; i<l; i++) {\r\n            if (annotations[i].uuid === commentId) {\r\n              index = i;\r\n              break;\r\n            }\r\n          }\r\n\r\n          if (index > -1) {\r\n            annotations.splice(index, 1);\r\n            updateAnnotations(documentId, annotations);\r\n          }\r\n\r\n          resolve(true);\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction getAnnotations(documentId) {\r\n  return JSON.parse(localStorage.getItem(`${documentId}/annotations`)) || [];\r\n}\r\n\r\nfunction updateAnnotations(documentId, annotations) {\r\n  localStorage.setItem(`${documentId}/annotations`, JSON.stringify(annotations));\r\n}\r\n\r\nfunction findAnnotation(documentId, annotationId) {\r\n  let index = -1;\r\n  let annotations = getAnnotations(documentId);\r\n  for (let i=0, l=annotations.length; i<l; i++) {\r\n    if (annotations[i].uuid === annotationId) {\r\n      index = i;\r\n      break;\r\n    }\r\n  }\r\n  return index;\r\n}\r\n","const UPPER_REGEX = /[A-Z]/g;\r\n\r\n// Don't convert these attributes from camelCase to hyphenated-attributes\r\nconst BLACKLIST = [\r\n  'viewBox'\r\n];\r\n\r\nlet keyCase = (key) => {\r\n  if (BLACKLIST.indexOf(key) === -1) {\r\n    key = key.replace(UPPER_REGEX, match => '-' + match.toLowerCase());\r\n  }\r\n  return key;\r\n}\r\n\r\n/**\r\n * Set attributes for a node from a map\r\n *\r\n * @param {Node} node The node to set attributes on\r\n * @param {Object} attributes The map of key/value pairs to use for attributes\r\n */\r\nexport default function setAttributes(node, attributes) {\r\n  Object.keys(attributes).forEach((key) => {\r\n    node.setAttribute(keyCase(key), attributes[key]);\r\n  });\r\n}\r\n","const REGEX_HASHLESS_HEX = /^([a-f0-9]{6}|[a-f0-9]{3})$/i;\r\n\r\n/**\r\n * Normalize a color value\r\n *\r\n * @param {String} color The color to normalize\r\n * @return {String}\r\n */\r\nexport default function normalizeColor(color) {\r\n  if (REGEX_HASHLESS_HEX.test(color)) {\r\n    color = `#${color}`;\r\n  }\r\n  return color;\r\n}\r\n","import setAttributes from '../utils/setAttributes';\r\n\r\nconst SIZE = 25;\r\nconst D = 'M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z';\r\n\r\n/**\r\n * Create SVGElement from an annotation definition.\r\n * This is used for anntations of type `comment`.\r\n *\r\n * @param {Object} a The annotation definition\r\n * @return {SVGElement} A svg to be rendered\r\n */\r\nexport default function renderPoint(a) {\r\n  let outerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n  let innerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n  let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n\r\n  setAttributes(outerSVG,  {\r\n    width: SIZE,\r\n    height: SIZE,\r\n    x: a.x,\r\n    y: a.y\r\n  });\r\n\r\n  setAttributes(innerSVG, {\r\n    width: SIZE,\r\n    height: SIZE,\r\n    x: 0,\r\n    y: (SIZE * 0.05) * -1,\r\n    viewBox: '0 0 1000 1000'\r\n  });\r\n\r\n  setAttributes(rect, {\r\n    width: SIZE,\r\n    height: SIZE,\r\n    stroke: '#000',\r\n    fill: '#ff0'\r\n  });\r\n\r\n  setAttributes(path, {\r\n    d: D,\r\n    strokeWidth: 50,\r\n    stroke: '#000',\r\n    fill: '#fff'\r\n  });\r\n\r\n  innerSVG.appendChild(path);\r\n  outerSVG.appendChild(rect);\r\n  outerSVG.appendChild(innerSVG);\r\n\r\n  return outerSVG;\r\n}\r\n","import setAttributes from '../utils/setAttributes';\r\nimport normalizeColor from '../utils/normalizeColor';\r\n\r\n/**\r\n * Create SVGRectElements from an annotation definition.\r\n * This is used for anntations of type `area` and `highlight`.\r\n *\r\n * @param {Object} a The annotation definition\r\n * @return {SVGGElement|SVGRectElement} A group of all rects to be rendered\r\n */\r\nexport default function renderRect(a) {\r\n  if (a.type === 'highlight') {\r\n    let group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\r\n    setAttributes(group, {\r\n      fill: normalizeColor(a.color || '#ff0'),\r\n      fillOpacity: 0.2\r\n    });\r\n    \r\n    a.rectangles.forEach((r) => {\r\n      group.appendChild(createRect(r));\r\n    });\r\n\r\n    return group;\r\n  } else {\r\n    let rect = createRect(a);\r\n    setAttributes(rect, {\r\n      stroke: normalizeColor(a.color || '#f00'),\r\n      fill: 'none'\r\n    });\r\n\r\n    return rect;\r\n  }\r\n}\r\n\r\nfunction createRect(r) {\r\n  let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n\r\n  setAttributes(rect, {\r\n    x: r.x,\r\n    y: r.y,\r\n    width: r.width,\r\n    height: r.height\r\n  });\r\n\r\n  return rect;\r\n}\r\n","import objectAssign from 'object-assign';\r\nimport renderLine from './renderLine';\r\nimport renderPath from './renderPath';\r\nimport renderPoint from './renderPoint';\r\nimport renderRect from './renderRect';\r\nimport renderText from './renderText';\r\n\r\nconst isFirefox = /firefox/i.test(navigator.userAgent);\r\n\r\n/**\r\n * Get the x/y translation to be used for transforming the annotations\r\n * based on the rotation of the viewport.\r\n *\r\n * @param {Object} viewport The viewport data from the page\r\n * @return {Object}\r\n */\r\nfunction getTranslation(viewport) {\r\n  let x;\r\n  let y;\r\n\r\n  // Modulus 360 on the rotation so that we only\r\n  // have to worry about four possible values.\r\n  switch(viewport.rotation % 360) {\r\n    case 0:\r\n      x = y = 0;\r\n      break;\r\n    case 90:\r\n      x = 0;\r\n      y = (viewport.width / viewport.scale) * -1;\r\n      break;\r\n    case 180:\r\n      x = (viewport.width / viewport.scale) * -1;\r\n      y = (viewport.height / viewport.scale) * -1;\r\n      break;\r\n    case 270:\r\n      x = (viewport.height / viewport.scale) * -1;\r\n      y = 0;\r\n      break;\r\n  }\r\n\r\n  return { x, y };\r\n}\r\n\r\n/**\r\n * Transform the rotation and scale of a node using SVG's native transform attribute.\r\n *\r\n * @param {Node} node The node to be transformed\r\n * @param {Object} viewport The page's viewport data\r\n * @return {Node}\r\n */\r\nfunction transform(node, viewport) {\r\n  let trans = getTranslation(viewport);\r\n\r\n  // Let SVG natively transform the element\r\n  node.setAttribute('transform', `scale(${viewport.scale}) rotate(${viewport.rotation}) translate(${trans.x}, ${trans.y})`);\r\n  \r\n  // Manually adjust x/y for nested SVG nodes\r\n  if (!isFirefox && node.nodeName.toLowerCase() === 'svg') {\r\n    node.setAttribute('x', parseInt(node.getAttribute('x'), 10) * viewport.scale);\r\n    node.setAttribute('y', parseInt(node.getAttribute('y'), 10) * viewport.scale);\r\n\r\n    let x = parseInt(node.getAttribute('x', 10));\r\n    let y = parseInt(node.getAttribute('y', 10));\r\n    let width = parseInt(node.getAttribute('width'), 10);\r\n    let height = parseInt(node.getAttribute('height'), 10);\r\n    let path = node.querySelector('path');\r\n    let svg = path.parentNode;\r\n   \r\n    // Scale width/height\r\n    [node, svg, path, node.querySelector('rect')].forEach((n) => {\r\n      n.setAttribute('width', parseInt(n.getAttribute('width'), 10) * viewport.scale);\r\n      n.setAttribute('height', parseInt(n.getAttribute('height'), 10) * viewport.scale);\r\n    });\r\n\r\n    // Transform path but keep scale at 100% since it will be handled natively\r\n    transform(path, objectAssign({}, viewport, { scale: 1 }));\r\n    \r\n    switch(viewport.rotation % 360) {\r\n      case 90:\r\n        node.setAttribute('x', viewport.width - y - width);\r\n        node.setAttribute('y', x);\r\n        svg.setAttribute('x', 1);\r\n        svg.setAttribute('y', 0);\r\n        break;\r\n      case 180:\r\n        node.setAttribute('x', viewport.width - x - width);\r\n        node.setAttribute('y', viewport.height - y - height);\r\n        svg.setAttribute('y', 2);\r\n        break;\r\n      case 270:\r\n        node.setAttribute('x', y);\r\n        node.setAttribute('y', viewport.height - x - height);\r\n        svg.setAttribute('x', -1);\r\n        svg.setAttribute('y', 0);\r\n        break;\r\n    }\r\n  }\r\n\r\n  return node;\r\n}\r\n\r\n/**\r\n * Append an annotation as a child of an SVG.\r\n *\r\n * @param {SVGElement} svg The SVG element to append the annotation to\r\n * @param {Object} annotation The annotation definition to render and append\r\n * @param {Object} viewport The page's viewport data\r\n * @return {SVGElement} A node that was created and appended by this function\r\n */\r\nexport default function appendChild(svg, annotation, viewport) {\r\n  if (!viewport) {\r\n    viewport = JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'));\r\n  }\r\n  \r\n  let child;\r\n  switch (annotation.type) {\r\n    case 'area':\r\n    case 'highlight':\r\n      child = renderRect(annotation);\r\n      break;\r\n    case 'strikeout':\r\n      child = renderLine(annotation);\r\n      break;\r\n    case 'point':\r\n      child = renderPoint(annotation);\r\n      break;\r\n    case 'textbox':\r\n      child = renderText(annotation);\r\n      break;\r\n    case 'drawing':\r\n      child = renderPath(annotation);\r\n      break;\r\n  }\r\n\r\n  // If no type was provided for an annotation it will result in node being null.\r\n  // Skip appending/transforming if node doesn't exist.\r\n  if (child) {\r\n    // Set attributes\r\n    child.setAttribute('data-pdf-annotate-id', annotation.uuid);\r\n    child.setAttribute('data-pdf-annotate-type', annotation.type);\r\n    child.setAttribute('aria-hidden', true);\r\n\r\n    svg.appendChild(transform(child, viewport));\r\n  }\r\n\r\n  return child;\r\n}\r\n","import setAttributes from '../utils/setAttributes';\r\nimport normalizeColor from '../utils/normalizeColor';\r\n\r\n/**\r\n * Create SVGLineElements from an annotation definition.\r\n * This is used for anntations of type `strikeout`.\r\n *\r\n * @param {Object} a The annotation definition\r\n * @return {SVGGElement} A group of all lines to be rendered\r\n */\r\nexport default function renderLine(a) {\r\n  let group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\r\n  setAttributes(group, {\r\n    stroke: normalizeColor(a.color || '#f00'),\r\n    strokeWidth: 1\r\n  });\r\n\r\n  a.rectangles.forEach((r) => {\r\n    let line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\r\n\r\n    setAttributes(line, {\r\n      x1: r.x,\r\n      y1: r.y,\r\n      x2: r.x + r.width,\r\n      y2: r.y,\r\n    });\r\n\r\n    group.appendChild(line);\r\n  });\r\n\r\n  return group;\r\n}\r\n","import setAttributes from '../utils/setAttributes';\r\nimport normalizeColor from '../utils/normalizeColor';\r\n\r\n/**\r\n * Create SVGTextElement from an annotation definition.\r\n * This is used for anntations of type `textbox`.\r\n *\r\n * @param {Object} a The annotation definition\r\n * @return {SVGTextElement} A text to be rendered\r\n */\r\nexport default function renderText(a) {\r\n  var text = document.createElementNS('http://www.w3.org/2000/svg', 'text');\r\n\r\n  setAttributes(text, {\r\n    x: a.x,\r\n    y: a.y + parseInt(a.size, 10),\r\n    fill: normalizeColor(a.color || '#000'),\r\n    fontSize: a.size\r\n  });\r\n  text.innerHTML = a.content;\r\n\r\n  return text;\r\n}\r\n","import setAttributes from '../utils/setAttributes';\r\nimport normalizeColor from '../utils/normalizeColor';\r\n\r\n/**\r\n * Create SVGPathElement from an annotation definition.\r\n * This is used for anntations of type `drawing`.\r\n *\r\n * @param {Object} a The annotation definition\r\n * @return {SVGPathElement} The path to be rendered\r\n */\r\nexport default function renderPath(a) {\r\n  let d = [];\r\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n  \r\n  for (let i=0, l=a.lines.length; i<l; i++) {\r\n    var p1 = a.lines[i];\r\n    var p2 = a.lines[i+1];\r\n    if (p2) {\r\n      d.push(`M${p1[0]} ${p1[1]} ${p2[0]} ${p2[1]}`);\r\n    }\r\n  }\r\n  \r\n  setAttributes(path, {\r\n    d: `${d.join(' ')}Z`,\r\n    stroke: normalizeColor(a.color || '#000'),\r\n    strokeWidth: a.width || 1,\r\n    fill: 'none'\r\n  });\r\n\r\n  return path;\r\n}\r\n","/**\r\n * Create a node that is only visible to screen readers\r\n *\r\n * @param {String} content The text content that should be read by screen reader\r\n * @param {String} [annotationId] The ID of the annotation assocaited\r\n * @return {Element} An Element that is only visible to screen readers\r\n */\r\nexport default function createScreenReaderOnly(content, annotationId) {\r\n  let node = document.createElement('div');\r\n  let text = document.createTextNode(content);\r\n  node.appendChild(text);\r\n  node.setAttribute('id', `pdf-annotate-screenreader-${annotationId}`);\r\n  node.style.position = 'absolute';\r\n  node.style.left = '-10000px';\r\n  node.style.top = 'auto';\r\n  node.style.width = '1px';\r\n  node.style.height = '1px';\r\n  node.style.overflow = 'hidden';\r\n  return node;\r\n}\r\n","import {\r\n  pointIntersectsRect,\r\n  scaleUp,\r\n  scaleDown\r\n} from '../UI/utils'; \r\n\r\n/**\r\n * Insert an element at a point within the document.\r\n * This algorithm will only insert within an element amidst it's text content.\r\n *\r\n * @param {Element} el The element to be inserted\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @param {Number} pageNumber The page number to limit elements to\r\n * @param {Boolean} insertBefore Whether the element is to be inserted before or after x\r\n * @return {Boolean} True if element was able to be inserted, otherwise false\r\n */\r\nexport default function insertElementWithinElement(el, x, y, pageNumber, insertBefore) {\r\n  const OFFSET_ADJUST = 2;\r\n\r\n  // If inserting before adjust `x` by looking for element a few px to the right\r\n  // Otherwise adjust a few px to the left\r\n  // This is to allow a little tolerance by searching within the box, instead\r\n  // of getting a false negative by testing right on the border.\r\n  x = Math.max(x + (OFFSET_ADJUST * (insertBefore ? 1 : -1)), 0);\r\n\r\n  let node = textLayerElementFromPoint(x, y + OFFSET_ADJUST, pageNumber);\r\n  if (!node) {\r\n    return false;\r\n  }\r\n  \r\n  // Now that node has been found inverse the adjustment for `x`.\r\n  // This is done to accomodate tolerance by cutting off on the outside of the\r\n  // text boundary, instead of missing a character by cutting off within.\r\n  x = x + (OFFSET_ADJUST * (insertBefore ? -1 : 1));\r\n\r\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\r\n  let left = scaleDown(svg, {left: node.getBoundingClientRect().left}).left - svg.getBoundingClientRect().left;\r\n  let temp = node.cloneNode(true);\r\n  let head = temp.innerHTML.split('');\r\n  let tail = [];\r\n\r\n  // Insert temp off screen\r\n  temp.style.position = 'absolute';\r\n  temp.style.top = '-10000px';\r\n  temp.style.left = '-10000px';\r\n  document.body.appendChild(temp);\r\n\r\n  while (head.length) {\r\n    // Don't insert within HTML tags\r\n    if (head[head.length - 1] === '>') {\r\n      while(head.length) {\r\n        tail.unshift(head.pop());\r\n        if (tail[0] === '<') {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Check if width of temp based on current head value satisfies x\r\n    temp.innerHTML = head.join('');\r\n    let width = scaleDown(svg, {width: temp.getBoundingClientRect().width}).width;\r\n    if (left + width <= x) {\r\n      break;\r\n    }\r\n    tail.unshift(head.pop());\r\n  }\r\n  \r\n  // Update original node with new markup, including element to be inserted\r\n  node.innerHTML = head.join('') + el.outerHTML + tail.join('');\r\n  temp.parentNode.removeChild(temp);\r\n\r\n  return true;\r\n}\r\n\r\n/**\r\n * Get a text layer element at a given point on a page\r\n *\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @param {Number} pageNumber The page to limit elements to\r\n * @return {Element} First text layer element found at the point\r\n */\r\nfunction textLayerElementFromPoint(x, y, pageNumber) {\r\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\r\n  let rect = svg.getBoundingClientRect();\r\n  y = scaleUp(svg, {y}).y + rect.top;\r\n  x = scaleUp(svg, {x}).x + rect.left;\r\n  return [...svg.parentNode.querySelectorAll('.textLayer [data-canvas-width]')].filter((el) => {\r\n    return pointIntersectsRect(x, y, el.getBoundingClientRect());\r\n  })[0];\r\n}\r\n","import insertElementWithinElement from './insertElementWithinElement';\r\nimport { pointIntersectsRect } from '../UI/utils';\r\nimport { scaleUp } from '../UI/utils'; \r\n\r\n/**\r\n * Insert an element at a point within the document.\r\n * This algorithm will try to insert between elements if possible.\r\n * It will however use `insertElementWithinElement` if it is more accurate.\r\n *\r\n * @param {Element} el The element to be inserted\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @param {Number} pageNumber The page number to limit elements to\r\n * @return {Boolean} True if element was able to be inserted, otherwise false\r\n */\r\nexport default function insertElementWithinChildren(el, x, y, pageNumber) {\r\n  // Try and use most accurate method of inserting within an element\r\n  if (insertElementWithinElement(el, x, y, pageNumber, true)) {\r\n    return true;\r\n  }\r\n\r\n  // Fall back to inserting between elements\r\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\r\n  let rect = svg.getBoundingClientRect();\r\n  let nodes = [...svg.parentNode.querySelectorAll('.textLayer > div')];\r\n\r\n  y = scaleUp(svg, {y}).y + rect.top;\r\n  x = scaleUp(svg, {x}).x + rect.left;\r\n\r\n  // Find the best node to insert before\r\n  for (let i=0, l=nodes.length; i<l; i++) {\r\n    let n = nodes[i];\r\n    let r = n.getBoundingClientRect();\r\n    if (y <= r.top) {\r\n      n.parentNode.insertBefore(el, n);\r\n      return true;\r\n    }\r\n  }\r\n\r\n  // If all else fails try to append to the bottom\r\n  let textLayer = svg.parentNode.querySelector('.textLayer');\r\n  if (textLayer) {\r\n    let textRect = textLayer.getBoundingClientRect();\r\n    if (pointIntersectsRect(x, y, textRect)) {\r\n      textLayer.appendChild(el);\r\n      return true;\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n","/**\r\n * Insert a comment into the DOM to be available by screen reader\r\n *\r\n * @param {Object} comment The comment to be inserted\r\n */\r\nexport default function insertScreenReaderComment(comment) {\r\n  if (!comment) {\r\n    return;\r\n  }\r\n\r\n  let list = document.querySelector(`#pdf-annotate-screenreader-${comment.annotation} ol`);\r\n  if (list) {\r\n    let item = document.createElement('li');\r\n    item.setAttribute('id', `pdf-annotate-screenreader-comment-${comment.uuid}`);\r\n    item.appendChild(document.createTextNode(`${comment.content}`));\r\n    list.appendChild(item);\r\n  }\r\n}\r\n","import PDFJSAnnotate from '../PDFJSAnnotate';\r\nimport insertScreenReaderComment from './insertScreenReaderComment';\r\n\r\n/**\r\n * Insert the comments into the DOM to be available by screen reader\r\n *\r\n * Example output:\r\n *   <div class=\"screenReaderOnly\">\r\n *    <div>Begin highlight 1</div>\r\n *    <ol aria-label=\"Comments\">\r\n *      <li>Foo</li>\r\n *      <li>Bar</li>\r\n *      <li>Baz</li>\r\n *      <li>Qux</li>\r\n *    </ol>\r\n *  </div>\r\n *  <div>Some highlighted text goes here...</div>\r\n *  <div class=\"screenReaderOnly\">End highlight 1</div>\r\n *\r\n * NOTE: `screenReaderOnly` is not a real class, just used for brevity\r\n *\r\n * @param {String} documentId The ID of the document\r\n * @param {String} annotationId The ID of the annotation\r\n * @param {Array} [comments] Optionally preloaded comments to be rendered\r\n * @return {Promise}\r\n */\r\nexport default function renderScreenReaderComments(documentId, annotationId, comments) {\r\n  let promise;\r\n\r\n  if (Array.isArray(comments)) {\r\n    promise = Promise.resolve(comments);\r\n  } else {\r\n    promise = PDFJSAnnotate.getStoreAdapter().getComments(documentId, annotationId);\r\n  }\r\n\r\n  return promise.then((comments) => {\r\n    // Node needs to be found by querying DOM as it may have been inserted as innerHTML\r\n    // leaving `screenReaderNode` as an invalid reference (see `insertElementWithinElement`).\r\n    let node = document.getElementById(`pdf-annotate-screenreader-${annotationId}`);\r\n    if (node) { \r\n      let list = document.createElement('ol');\r\n      list.setAttribute('id', `pdf-annotate-screenreader-comment-list-${annotationId}`);\r\n      list.setAttribute('aria-label', 'Comments');\r\n      node.appendChild(list);\r\n      comments.forEach(insertScreenReaderComment);\r\n    }\r\n  });\r\n}\r\n","import createScreenReaderOnly from './createScreenReaderOnly';\r\nimport insertElementWithinChildren from './insertElementWithinChildren';\r\nimport insertElementWithinElement from './insertElementWithinElement';\r\nimport renderScreenReaderComments from './renderScreenReaderComments';\r\n\r\n// Annotation types that support comments\r\nconst COMMENT_TYPES = ['highlight', 'point', 'area'];\r\n\r\n/**\r\n * Insert a hint into the DOM for screen readers for a specific annotation.\r\n *\r\n * @param {Object} annotation The annotation to insert a hint for\r\n * @param {Number} num The number of the annotation out of all annotations of the same type\r\n */\r\nexport default function insertScreenReaderHint(annotation, num = 0) {\r\n  switch (annotation.type) {\r\n    case 'highlight':\r\n    case 'strikeout':\r\n      let rects = annotation.rectangles;\r\n      let first = rects[0];\r\n      let last = rects[rects.length - 1];\r\n\r\n      insertElementWithinElement(\r\n        createScreenReaderOnly(`Begin ${annotation.type} annotation ${num}`, annotation.uuid),\r\n        first.x, first.y, annotation.page, true\r\n      );\r\n\r\n      insertElementWithinElement(\r\n        createScreenReaderOnly(`End ${annotation.type} annotation ${num}`, `${annotation.uuid}-end`),\r\n        last.x + last.width, last.y, annotation.page, false\r\n      );\r\n      break;\r\n\r\n    case 'textbox':\r\n    case 'point':\r\n      let text = annotation.type === 'textbox' ? ` (content: ${annotation.content})` : '';\r\n\r\n      insertElementWithinChildren(\r\n        createScreenReaderOnly(`${annotation.type} annotation ${num}${text}`, annotation.uuid),\r\n        annotation.x, annotation.y, annotation.page\r\n      );\r\n      break;\r\n\r\n    case 'drawing':\r\n    case 'area':\r\n      let x = typeof annotation.x !== 'undefined' ? annotation.x : annotation.lines[0][0];\r\n      let y = typeof annotation.y !== 'undefined' ? annotation.y : annotation.lines[0][1];\r\n\r\n      insertElementWithinChildren(\r\n        createScreenReaderOnly(`Unlabeled drawing`, annotation.uuid),\r\n        x, y, annotation.page\r\n      );\r\n      break;\r\n  }\r\n\r\n  // Include comments in screen reader hint\r\n  if (COMMENT_TYPES.includes(annotation.type)) {\r\n    renderScreenReaderComments(annotation.documentId, annotation.uuid);\r\n  }\r\n}\r\n","import insertScreenReaderHint from './insertScreenReaderHint';\r\nimport renderScreenReaderHints from './renderScreenReaderHints';\r\nimport insertScreenReaderComment from './insertScreenReaderComment';\r\nimport renderScreenReaderComments from './renderScreenReaderComments';\r\nimport { addEventListener } from '../UI/event';\r\nimport PDFJSAnnotate from '../PDFJSAnnotate';\r\n\r\n/**\r\n * Initialize the event handlers for keeping screen reader hints synced with data\r\n */\r\nexport default function initEventHandlers() {\r\n  addEventListener('annotation:add', (documentId, pageNumber, annotation) => {\r\n    reorderAnnotationsByType(documentId, pageNumber, annotation.type);\r\n  });\r\n  addEventListener('annotation:edit', (documentId, annotationId, annotation) => {\r\n    reorderAnnotationsByType(documentId, annotation.page, annotation.type);\r\n  });\r\n  addEventListener('annotation:delete', removeAnnotation);\r\n  addEventListener('comment:add', insertComment);\r\n  addEventListener('comment:delete', removeComment);\r\n}\r\n\r\n/**\r\n * Reorder the annotation numbers by annotation type\r\n *\r\n * @param {String} documentId The ID of the document\r\n * @param {Number} pageNumber The page number of the annotations\r\n * @param {Strig} type The annotation type\r\n */\r\nfunction reorderAnnotationsByType(documentId, pageNumber, type) {\r\n  PDFJSAnnotate.getStoreAdapter().getAnnotations(documentId, pageNumber)\r\n    .then((annotations) => {\r\n      return annotations.annotations.filter((a) => {\r\n        return a.type === type;\r\n      });\r\n    })\r\n    .then((annotations) => {\r\n      annotations.forEach((a) => {\r\n        removeAnnotation(documentId, a.uuid);\r\n      });\r\n\r\n      return annotations;\r\n    })\r\n    .then(renderScreenReaderHints);\r\n}\r\n\r\n/**\r\n * Remove the screen reader hint for an annotation\r\n *\r\n * @param {String} documentId The ID of the document\r\n * @param {String} annotationId The Id of the annotation\r\n */\r\nfunction removeAnnotation(documentId, annotationId) {\r\n  removeElementById(`pdf-annotate-screenreader-${annotationId}`);\r\n  removeElementById(`pdf-annotate-screenreader-${annotationId}-end`);\r\n}\r\n\r\n/**\r\n * Insert a screen reader hint for a comment\r\n *\r\n * @param {String} documentId The ID of the document\r\n * @param {String} annotationId The ID of tha assocated annotation\r\n * @param {Object} comment The comment to insert a hint for\r\n */\r\nfunction insertComment(documentId, annotationId, comment) {\r\n  let list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\r\n  let promise;\r\n\r\n  if (!list) {\r\n    promise = renderScreenReaderComments(documentId, annotationId, []).then(() => {\r\n      list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\r\n      return true;\r\n    });\r\n  } else {\r\n    promise = Promise.resolve(true);\r\n  }\r\n\r\n  promise.then(() => {\r\n    insertScreenReaderComment(comment);\r\n  });\r\n}\r\n\r\n/**\r\n * Remove a screen reader hint for a comment\r\n *\r\n * @param {String} documentId The ID of the document\r\n * @param {String} commentId The ID of the comment\r\n */\r\nfunction removeComment(documentId, commentId) {\r\n  removeElementById(`pdf-annotate-screenreader-comment-${commentId}`);\r\n}\r\n\r\n/**\r\n * Remove an element from the DOM by it's ID if it exists\r\n *\r\n * @param {String} elementID The ID of the element to be removed\r\n */\r\nfunction removeElementById(elementId) {\r\n  let el = document.getElementById(elementId);\r\n  if (el) {\r\n    el.parentNode.removeChild(el);\r\n  }\r\n}\r\n","import insertScreenReaderHint from './insertScreenReaderHint';\r\nimport initEventHandlers from './initEventHandlers';\r\n\r\n// TODO This is not the right place for this to live\r\ninitEventHandlers();\r\n\r\n/**\r\n * Insert hints into the DOM for screen readers.\r\n *\r\n * @param {Array} annotations The annotations that hints are inserted for\r\n */\r\nexport default function renderScreenReaderHints(annotations) {\r\n  annotations = Array.isArray(annotations) ? annotations : [];\r\n\r\n  // Insert hints for each type\r\n  Object.keys(SORT_TYPES).forEach((type) => {\r\n    let sortBy = SORT_TYPES[type];\r\n    annotations\r\n      .filter((a) => a.type === type)\r\n      .sort(sortBy)\r\n      .forEach((a, i) => insertScreenReaderHint(a, i + 1));\r\n  });\r\n}\r\n\r\n// Sort annotations first by y, then by x.\r\n// This allows hints to be injected in the order they appear,\r\n// which makes numbering them easier.\r\nfunction sortByPoint(a, b) {\r\n  if (a.y < b.y) {\r\n    return a.x - b.x;\r\n  } else {\r\n    return 1;\r\n  }\r\n}\r\n\r\n// Sort annotation by it's first rectangle\r\nfunction sortByRectPoint(a, b) {\r\n  return sortByPoint(a.rectangles[0], b.rectangles[0]);\r\n}\r\n\r\n// Sort annotation by it's first line\r\nfunction sortByLinePoint(a, b) {\r\n  let lineA = a.lines[0];\r\n  let lineB = b.lines[0];\r\n  return sortByPoint(\r\n    {x: lineA[0], y: lineA[1]},\r\n    {x: lineB[0], y: lineB[1]}\r\n  );\r\n}\r\n\r\n// Arrange supported types and associated sort methods\r\nconst SORT_TYPES = {\r\n  'highlight': sortByRectPoint,\r\n  'strikeout': sortByRectPoint,\r\n  'drawing': sortByLinePoint,\r\n  'textbox': sortByPoint,\r\n  'point': sortByPoint,\r\n  'area': sortByPoint\r\n};\r\n\r\n","import PDFJSAnnotate from '../PDFJSAnnotate';\r\n\r\nimport appendChild from '../render/appendChild';\r\nimport {\r\n  addEventListener,\r\n  removeEventListener\r\n} from './event';\r\nimport {\r\n  BORDER_COLOR,\r\n  disableUserSelect,\r\n  enableUserSelect,\r\n  findSVGContainer,\r\n  findSVGAtPoint,\r\n  getAnnotationRect,\r\n  getMetadata,\r\n  scaleDown,\r\n  scaleUp\r\n} from './utils';\r\n\r\nlet _enabled = false;\r\nlet isDragging = false, overlay;\r\nlet dragOffsetX, dragOffsetY, dragStartX, dragStartY;\r\nconst OVERLAY_BORDER_SIZE = 3;\r\n\r\n/**\r\n * Create an overlay for editing an annotation.\r\n *\r\n * @param {Element} target The annotation element to apply overlay for\r\n */\r\nfunction createEditOverlay(target) {\r\n  destroyEditOverlay();\r\n\r\n  overlay = document.createElement('div');\r\n  let anchor = document.createElement('a');\r\n  let parentNode = findSVGContainer(target).parentNode;\r\n  let id = target.getAttribute('data-pdf-annotate-id');\r\n  let rect = getAnnotationRect(target);\r\n  let styleLeft = rect.left - OVERLAY_BORDER_SIZE;\r\n  let styleTop = rect.top - OVERLAY_BORDER_SIZE;\r\n  \r\n  overlay.setAttribute('id', 'pdf-annotate-edit-overlay');\r\n  overlay.setAttribute('data-target-id', id);\r\n  overlay.style.boxSizing = 'content-box';\r\n  overlay.style.position = 'absolute';\r\n  overlay.style.top = `${styleTop}px`;\r\n  overlay.style.left = `${styleLeft}px`;\r\n  overlay.style.width = `${rect.width}px`;\r\n  overlay.style.height = `${rect.height}px`;\r\n  overlay.style.border = `${OVERLAY_BORDER_SIZE}px solid ${BORDER_COLOR}`;\r\n  overlay.style.borderRadius = `${OVERLAY_BORDER_SIZE}px`;\r\n\r\n  anchor.innerHTML = '';\r\n  anchor.setAttribute('href', 'javascript://');\r\n  anchor.style.background = '#fff';\r\n  anchor.style.borderRadius = '20px';\r\n  anchor.style.border = '1px solid #bbb';\r\n  anchor.style.color = '#bbb';\r\n  anchor.style.fontSize = '16px';\r\n  anchor.style.padding = '2px';\r\n  anchor.style.textAlign = 'center';\r\n  anchor.style.textDecoration = 'none';\r\n  anchor.style.position = 'absolute';\r\n  anchor.style.top = '-13px';\r\n  anchor.style.right = '-13px';\r\n  anchor.style.width = '25px';\r\n  anchor.style.height = '25px';\r\n  \r\n  overlay.appendChild(anchor);\r\n  parentNode.appendChild(overlay);\r\n  document.addEventListener('click', handleDocumentClick);\r\n  document.addEventListener('keyup', handleDocumentKeyup);\r\n  document.addEventListener('mousedown', handleDocumentMousedown);\r\n  anchor.addEventListener('click', deleteAnnotation);\r\n  anchor.addEventListener('mouseover', () => {\r\n    anchor.style.color = '#35A4DC';\r\n    anchor.style.borderColor = '#999';\r\n    anchor.style.boxShadow = '0 1px 1px #ccc';\r\n  });\r\n  anchor.addEventListener('mouseout', () => {\r\n    anchor.style.color = '#bbb';\r\n    anchor.style.borderColor = '#bbb';\r\n    anchor.style.boxShadow = '';\r\n  });\r\n  overlay.addEventListener('mouseover', () => {\r\n    if (!isDragging) { anchor.style.display = ''; }\r\n  });\r\n  overlay.addEventListener('mouseout', () => {\r\n    anchor.style.display = 'none';\r\n  });\r\n}\r\n\r\n/**\r\n * Destroy the edit overlay if it exists.\r\n */\r\nfunction destroyEditOverlay() {\r\n  if (overlay) {\r\n    overlay.parentNode.removeChild(overlay);\r\n    overlay = null;\r\n  }\r\n\r\n  document.removeEventListener('click', handleDocumentClick);\r\n  document.removeEventListener('keyup', handleDocumentKeyup);\r\n  document.removeEventListener('mousedown', handleDocumentMousedown);\r\n  document.removeEventListener('mousemove', handleDocumentMousemove);\r\n  document.removeEventListener('mouseup', handleDocumentMouseup);\r\n  enableUserSelect();\r\n}\r\n\r\n/**\r\n * Delete currently selected annotation\r\n */\r\nfunction deleteAnnotation() {\r\n  if (!overlay) { return; }\r\n\r\n  let annotationId = overlay.getAttribute('data-target-id');\r\n  let nodes = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\r\n  let svg = overlay.parentNode.querySelector('svg.drawingLayer');\r\n  let { documentId } = getMetadata(svg);\r\n\r\n  [...nodes].forEach((n) => {\r\n    n.parentNode.removeChild(n);\r\n  });\r\n  \r\n  PDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, annotationId);\r\n\r\n  destroyEditOverlay();\r\n}\r\n\r\n/**\r\n * Handle document.click event\r\n *\r\n * @param {Event} e The DOM event that needs to be handled\r\n */\r\nfunction handleDocumentClick(e) {\r\n  if (!findSVGAtPoint(e.clientX, e.clientY)) { return; }\r\n\r\n  // Remove current overlay\r\n  let overlay = document.getElementById('pdf-annotate-edit-overlay');\r\n  if (overlay) {\r\n    if (isDragging || e.target === overlay) {\r\n      return;\r\n    }\r\n\r\n    destroyEditOverlay();\r\n  }\r\n}\r\n\r\n/**\r\n * Handle document.keyup event\r\n *\r\n * @param {Event} e The DOM event that needs to be handled\r\n */\r\nfunction handleDocumentKeyup(e) {\r\n  if (overlay && e.keyCode === 46 &&\r\n      e.target.nodeName.toLowerCase() !== 'textarea' &&\r\n      e.target.nodeName.toLowerCase() !== 'input') {\r\n    deleteAnnotation();\r\n  }\r\n}\r\n\r\n/**\r\n * Handle document.mousedown event\r\n *\r\n * @param {Event} e The DOM event that needs to be handled\r\n */\r\nfunction handleDocumentMousedown(e) {\r\n  if (e.target !== overlay) { return; }\r\n\r\n  // Highlight and strikeout annotations are bound to text within the document.\r\n  // It doesn't make sense to allow repositioning these types of annotations.\r\n  let annotationId = overlay.getAttribute('data-target-id');\r\n  let target = document.querySelector(`[data-pdf-annotate-id=\"${annotationId}\"]`);\r\n  let type = target.getAttribute('data-pdf-annotate-type');\r\n\r\n  if (type === 'highlight' || type === 'strikeout') { return; }\r\n\r\n  isDragging = true;\r\n  dragOffsetX = e.clientX;\r\n  dragOffsetY = e.clientY;\r\n  dragStartX = overlay.offsetLeft;\r\n  dragStartY = overlay.offsetTop;\r\n\r\n  overlay.style.background = 'rgba(255, 255, 255, 0.7)';\r\n  overlay.style.cursor = 'move';\r\n  overlay.querySelector('a').style.display = 'none';\r\n\r\n  document.addEventListener('mousemove', handleDocumentMousemove);\r\n  document.addEventListener('mouseup', handleDocumentMouseup);\r\n  disableUserSelect();\r\n}\r\n\r\n/**\r\n * Handle document.mousemove event\r\n *\r\n * @param {Event} e The DOM event that needs to be handled\r\n */\r\nfunction handleDocumentMousemove(e) {\r\n  let annotationId = overlay.getAttribute('data-target-id');\r\n  let parentNode = overlay.parentNode;\r\n  let rect = parentNode.getBoundingClientRect();\r\n  let y = (dragStartY + (e.clientY - dragOffsetY));\r\n  let x = (dragStartX + (e.clientX - dragOffsetX));\r\n  let minY = 0;\r\n  let maxY = rect.height;\r\n  let minX = 0;\r\n  let maxX = rect.width;\r\n\r\n  if (y > minY && y + overlay.offsetHeight < maxY) {\r\n    overlay.style.top = `${y}px`;\r\n  }\r\n\r\n  if (x > minX && x + overlay.offsetWidth < maxX) {\r\n    overlay.style.left = `${x}px`;\r\n  }\r\n}\r\n\r\n/**\r\n * Handle document.mouseup event\r\n *\r\n * @param {Event} e The DOM event that needs to be handled\r\n */\r\nfunction handleDocumentMouseup(e) {\r\n  let annotationId = overlay.getAttribute('data-target-id');\r\n  let target = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\r\n  let type = target[0].getAttribute('data-pdf-annotate-type');\r\n  let svg = overlay.parentNode.querySelector('svg.drawingLayer');\r\n  let { documentId } = getMetadata(svg);\r\n  \r\n  overlay.querySelector('a').style.display = '';\r\n\r\n  function getDelta(propX, propY) {\r\n    return calcDelta(parseInt(target[0].getAttribute(propX), 10), parseInt(target[0].getAttribute(propY), 10));\r\n  }\r\n\r\n  function calcDelta(x, y) {\r\n    return {\r\n      deltaX: OVERLAY_BORDER_SIZE + scaleDown(svg, {x: overlay.offsetLeft}).x - x,\r\n      deltaY: OVERLAY_BORDER_SIZE + scaleDown(svg, {y: overlay.offsetTop}).y - y\r\n    };\r\n  }\r\n\r\n  PDFJSAnnotate.getStoreAdapter().getAnnotation(documentId, annotationId).then((annotation) => {\r\n    if (['area', 'highlight', 'point', 'textbox'].indexOf(type) > -1) {\r\n      let { deltaX, deltaY } = getDelta('x', 'y');\r\n      [...target].forEach((t, i) => {\r\n        if (deltaY !== 0) {\r\n          let modelY = parseInt(t.getAttribute('y'), 10) + deltaY;\r\n          let viewY = modelY;\r\n\r\n          if (type === 'textbox') {\r\n            viewY += annotation.size;\r\n          }\r\n\r\n          if (type === 'point') {\r\n            viewY = scaleUp(svg, { viewY }).viewY;\r\n          }\r\n\r\n          t.setAttribute('y', viewY);\r\n          if (annotation.rectangles) {\r\n            annotation.rectangles[i].y = modelY;\r\n          } else if (annotation.y) {\r\n            annotation.y = modelY;\r\n          }\r\n        }\r\n        if (deltaX !== 0) {\r\n          let modelX = parseInt(t.getAttribute('x'), 10) + deltaX;\r\n          let viewX = modelX;\r\n\r\n          if (type === 'point') {\r\n            viewX = scaleUp(svg, { viewX }).viewX;\r\n          }\r\n\r\n          t.setAttribute('x', viewX);\r\n          if (annotation.rectangles) {\r\n            annotation.rectangles[i].x = modelX;\r\n          } else if (annotation.x) {\r\n            annotation.x = modelX;\r\n          }\r\n        }\r\n      });\r\n    // } else if (type === 'strikeout') {\r\n    //   let { deltaX, deltaY } = getDelta('x1', 'y1');\r\n    //   [...target].forEach(target, (t, i) => {\r\n    //     if (deltaY !== 0) {\r\n    //       t.setAttribute('y1', parseInt(t.getAttribute('y1'), 10) + deltaY);\r\n    //       t.setAttribute('y2', parseInt(t.getAttribute('y2'), 10) + deltaY);\r\n    //       annotation.rectangles[i].y = parseInt(t.getAttribute('y1'), 10);\r\n    //     }\r\n    //     if (deltaX !== 0) {\r\n    //       t.setAttribute('x1', parseInt(t.getAttribute('x1'), 10) + deltaX);\r\n    //       t.setAttribute('x2', parseInt(t.getAttribute('x2'), 10) + deltaX);\r\n    //       annotation.rectangles[i].x = parseInt(t.getAttribute('x1'), 10);\r\n    //     }\r\n    //   });\r\n    } else if (type === 'drawing') {\r\n      let rect = scaleDown(svg, getAnnotationRect(target[0]));\r\n      let [originX, originY] = annotation.lines[0];\r\n      let { deltaX, deltaY } = calcDelta(originX, originY);\r\n\r\n      // origin isn't necessarily at 0/0 in relation to overlay x/y\r\n      // adjust the difference between overlay and drawing coords\r\n      deltaY += (originY - rect.top);\r\n      deltaX += (originX - rect.left);\r\n\r\n      annotation.lines.forEach((line, i) => {\r\n        let [x, y] = annotation.lines[i];\r\n        annotation.lines[i][0] = x + deltaX;\r\n        annotation.lines[i][1] = y + deltaY;\r\n      });\r\n\r\n      target[0].parentNode.removeChild(target[0]);\r\n      appendChild(svg, annotation);\r\n    }\r\n\r\n    PDFJSAnnotate.getStoreAdapter().editAnnotation(documentId, annotationId, annotation);\r\n  });\r\n\r\n  setTimeout(() => {\r\n    isDragging = false;\r\n  }, 0);\r\n\r\n  overlay.style.background = '';\r\n  overlay.style.cursor = '';\r\n\r\n  document.removeEventListener('mousemove', handleDocumentMousemove);\r\n  document.removeEventListener('mouseup', handleDocumentMouseup);\r\n  enableUserSelect();\r\n}\r\n\r\n/**\r\n * Handle annotation.click event\r\n *\r\n * @param {Element} e The annotation element that was clicked\r\n */\r\nfunction handleAnnotationClick(target) {\r\n  createEditOverlay(target);\r\n}\r\n\r\n/**\r\n * Enable edit mode behavior.\r\n */\r\nexport function enableEdit () {\r\n  if (_enabled) { return; }\r\n\r\n  _enabled = true;\r\n  addEventListener('annotation:click', handleAnnotationClick);\r\n};\r\n\r\n/**\r\n * Disable edit mode behavior.\r\n */\r\nexport function disableEdit () {\r\n  destroyEditOverlay();\r\n\r\n  if (!_enabled) { return; }\r\n\r\n  _enabled = false;\r\n  removeEventListener('annotation:click', handleAnnotationClick);\r\n};\r\n\r\n","import PDFJSAnnotate from '../PDFJSAnnotate';\r\nimport appendChild from '../render/appendChild';\r\nimport {\r\n  disableUserSelect,\r\n  enableUserSelect,\r\n  findSVGAtPoint,\r\n  getMetadata,\r\n  scaleDown\r\n} from './utils';\r\n\r\nlet _enabled = false;\r\nlet _penSize;\r\nlet _penColor;\r\nlet path;\r\nlet lines;\r\n\r\n/**\r\n * Handle document.mousedown event\r\n */\r\nfunction handleDocumentMousedown() {\r\n  path = null;\r\n  lines = [];\r\n\r\n  document.addEventListener('mousemove', handleDocumentMousemove);\r\n  document.addEventListener('mouseup', handleDocumentMouseup);\r\n}\r\n\r\n/**\r\n * Handle document.mouseup event\r\n *\r\n * @param {Event} e The DOM event to be handled\r\n */\r\nfunction handleDocumentMouseup(e) {\r\n  let svg;\r\n  if (lines.length > 1 && (svg = findSVGAtPoint(e.clientX, e.clientY))) {\r\n    let { documentId, pageNumber } = getMetadata(svg);\r\n\r\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, {\r\n        type: 'drawing',\r\n        width: _penSize,\r\n        color: _penColor,\r\n        lines\r\n      }\r\n    ).then((annotation) => {\r\n      if (path) {\r\n        svg.removeChild(path);\r\n      }\r\n\r\n      appendChild(svg, annotation);\r\n    });\r\n  }\r\n\r\n  document.removeEventListener('mousemove', handleDocumentMousemove);\r\n  document.removeEventListener('mouseup', handleDocumentMouseup);\r\n}\r\n\r\n/**\r\n * Handle document.mousemove event\r\n *\r\n * @param {Event} e The DOM event to be handled\r\n */\r\nfunction handleDocumentMousemove(e) {\r\n  savePoint(e.clientX, e.clientY);\r\n}\r\n\r\n/**\r\n * Handle document.keyup event\r\n *\r\n * @param {Event} e The DOM event to be handled\r\n */\r\nfunction handleDocumentKeyup(e) {\r\n  // Cancel rect if Esc is pressed\r\n  if (e.keyCode === 27) {\r\n    lines = null;\r\n    path.parentNode.removeChild(path);\r\n    document.removeEventListener('mousemove', handleDocumentMousemove);\r\n    document.removeEventListener('mouseup', handleDocumentMouseup);\r\n  }\r\n}\r\n\r\n/**\r\n * Save a point to the line being drawn.\r\n *\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n */\r\nfunction savePoint(x, y) {\r\n  let svg = findSVGAtPoint(x, y);\r\n  if (!svg) {\r\n    return;\r\n  }\r\n\r\n  let rect = svg.getBoundingClientRect();\r\n  let point = scaleDown(svg, {\r\n    x: x - rect.left,\r\n    y: y - rect.top\r\n  });\r\n\r\n  lines.push([point.x, point.y]);\r\n\r\n  if (lines.length <= 1) {\r\n    return;\r\n  }\r\n\r\n  if (path) {\r\n    svg.removeChild(path);\r\n  }\r\n\r\n  path = appendChild(svg, {\r\n    type: 'drawing',\r\n    color: _penColor,\r\n    width: _penSize,\r\n    lines\r\n  });\r\n}\r\n\r\n/**\r\n * Set the attributes of the pen.\r\n *\r\n * @param {Number} penSize The size of the lines drawn by the pen\r\n * @param {String} penColor The color of the lines drawn by the pen\r\n */\r\nexport function setPen(penSize = 1, penColor = '000000') {\r\n  _penSize = parseInt(penSize, 10);\r\n  _penColor = penColor;\r\n}\r\n\r\n/**\r\n * Enable the pen behavior\r\n */\r\nexport function enablePen() {\r\n  if (_enabled) { return; }\r\n\r\n  _enabled = true;\r\n  document.addEventListener('mousedown', handleDocumentMousedown);\r\n  document.addEventListener('keyup', handleDocumentKeyup);\r\n  disableUserSelect();\r\n}\r\n\r\n/**\r\n * Disable the pen behavior\r\n */\r\nexport function disablePen() {\r\n  if (!_enabled) { return; }\r\n\r\n  _enabled = false;\r\n  document.removeEventListener('mousedown', handleDocumentMousedown);\r\n  document.removeEventListener('keyup', handleDocumentKeyup);\r\n  enableUserSelect();\r\n}\r\n\r\n","import PDFJSAnnotate from '../PDFJSAnnotate';\r\nimport appendChild from '../render/appendChild';\r\nimport {\r\n  BORDER_COLOR,\r\n  findSVGAtPoint,\r\n  getMetadata,\r\n  scaleDown\r\n} from './utils';\r\n\r\nlet _enabled = false;\r\nlet input;\r\n\r\n/**\r\n * Handle document.mouseup event\r\n *\r\n * @param {Event} The DOM event to be handled\r\n */\r\nfunction handleDocumentMouseup(e) {\r\n  if (input || !findSVGAtPoint(e.clientX, e.clientY)) {\r\n    return\r\n  }\r\n  \r\n  input = document.createElement('input');\r\n  input.setAttribute('id', 'pdf-annotate-point-input');\r\n  input.setAttribute('placeholder', 'Enter comment');\r\n  input.style.border = `3px solid ${BORDER_COLOR}`;\r\n  input.style.borderRadius = '3px';\r\n  input.style.position = 'absolute';\r\n  input.style.top = `${e.clientY}px`;\r\n  input.style.left = `${e.clientX}px`;\r\n\r\n  input.addEventListener('blur', handleInputBlur);\r\n  input.addEventListener('keyup', handleInputKeyup);\r\n\r\n  document.body.appendChild(input);\r\n  input.focus();\r\n}\r\n\r\n/**\r\n * Handle input.blur event\r\n */\r\nfunction handleInputBlur() {\r\n  savePoint();\r\n}\r\n\r\n/**\r\n * Handle input.keyup event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleInputKeyup(e) {\r\n  if (e.keyCode === 27) {\r\n    closeInput();\r\n  } else if (e.keyCode === 13) {\r\n    savePoint();\r\n  }\r\n}\r\n\r\n/**\r\n * Save a new point annotation from input\r\n */\r\nfunction savePoint() {\r\n  if (input.value.trim().length > 0) {\r\n    let clientX = parseInt(input.style.left, 10);\r\n    let clientY = parseInt(input.style.top, 10);\r\n    let content = input.value.trim();\r\n    let svg = findSVGAtPoint(clientX, clientY);\r\n    if (!svg) {\r\n      return;\r\n    }\r\n\r\n    let rect = svg.getBoundingClientRect();\r\n    let { documentId, pageNumber } = getMetadata(svg);\r\n    let annotation = Object.assign({\r\n        type: 'point'\r\n      }, scaleDown(svg, {\r\n        x: clientX - rect.left,\r\n        y: clientY - rect.top\r\n      })\r\n    );\r\n\r\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\r\n      .then((annotation) => {\r\n        PDFJSAnnotate.getStoreAdapter().addComment(\r\n          documentId,\r\n          annotation.uuid,\r\n          content\r\n        );\r\n\r\n        appendChild(svg, annotation);\r\n      });\r\n  }\r\n\r\n  closeInput();\r\n}\r\n\r\n/**\r\n * Close the input element\r\n */\r\nfunction closeInput() {\r\n  input.removeEventListener('blur', handleInputBlur);\r\n  input.removeEventListener('keyup', handleInputKeyup);\r\n  document.body.removeChild(input);\r\n  input = null;\r\n}\r\n\r\n/**\r\n * Enable point annotation behavior\r\n */\r\nexport function enablePoint() {\r\n  if (_enabled) { return; }\r\n\r\n  _enabled = true;\r\n  document.addEventListener('mouseup', handleDocumentMouseup);\r\n}\r\n\r\n/**\r\n * Disable point annotation behavior\r\n */\r\nexport function disablePoint() {\r\n  if (!_enabled) { return; }\r\n\r\n  _enabled = false;\r\n  document.removeEventListener('mouseup', handleDocumentMouseup);\r\n}\r\n\r\n","import PDFJSAnnotate from '../PDFJSAnnotate';\r\nimport appendChild from '../render/appendChild';\r\nimport {\r\n  BORDER_COLOR,\r\n  disableUserSelect,\r\n  enableUserSelect,\r\n  findSVGAtPoint,\r\n  getMetadata,\r\n  getOffset,\r\n  scaleDown,\r\n  scaleUp\r\n} from './utils';\r\n\r\nlet _enabled = false;\r\nlet _type;\r\nlet overlay;\r\nlet originY;\r\nlet originX;\r\n\r\n/**\r\n * Get the current window selection as rects\r\n *\r\n * @return {Array} An Array of rects\r\n */\r\nfunction getSelectionRects() {\r\n  try {\r\n    let selection = window.getSelection();\r\n    let range = selection.getRangeAt(0);\r\n    let rects = range.getClientRects();\r\n\r\n    if (rects.length > 0 &&\r\n        rects[0].width > 0 &&\r\n        rects[0].height > 0) {\r\n      return rects;\r\n    }\r\n  } catch (e) {}\r\n  \r\n  return null;\r\n}\r\n\r\n/**\r\n * Handle document.mousedown event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleDocumentMousedown(e) {\r\n  let svg;\r\n  if (_type !== 'area' || !(svg = findSVGAtPoint(e.clientX, e.clientY))) {\r\n    return;\r\n  }\r\n\r\n  let rect = svg.getBoundingClientRect();\r\n  originY = e.clientY;\r\n  originX = e.clientX;\r\n\r\n  overlay = document.createElement('div');\r\n  overlay.style.position = 'absolute';\r\n  overlay.style.top = `${originY - rect.top}px`;\r\n  overlay.style.left = `${originX - rect.left}px`;\r\n  overlay.style.border = `3px solid ${BORDER_COLOR}`;\r\n  overlay.style.borderRadius = '3px';\r\n  svg.parentNode.appendChild(overlay);\r\n  \r\n  document.addEventListener('mousemove', handleDocumentMousemove);\r\n  disableUserSelect();\r\n}\r\n\r\n/**\r\n * Handle document.mousemove event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleDocumentMousemove(e) {\r\n  let svg = overlay.parentNode.querySelector('svg.drawingLayer');\r\n  let rect = svg.getBoundingClientRect();\r\n\r\n  if (originX + (e.clientX - originX) < rect.right) {\r\n    overlay.style.width = `${e.clientX - originX}px`;\r\n  }\r\n\r\n  if (originY + (e.clientY - originY) < rect.bottom) {\r\n    overlay.style.height = `${e.clientY - originY}px`;\r\n  }\r\n}\r\n\r\n/**\r\n * Handle document.mouseup event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleDocumentMouseup(e) {\r\n  let rects;\r\n  if (_type !== 'area' && (rects = getSelectionRects())) {\r\n    let svg = findSVGAtPoint(rects[0].left, rects[0].top);\r\n    saveRect(_type, [...rects].map((r) => {\r\n      return {\r\n        top: r.top,\r\n        left: r.left,\r\n        width: r.width,\r\n        height: r.height\r\n      };\r\n    }));\r\n  } else if (_type === 'area' && overlay) {\r\n    let svg = overlay.parentNode.querySelector('svg.drawingLayer');\r\n    let rect = svg.getBoundingClientRect();\r\n    saveRect(_type, [{\r\n      top: parseInt(overlay.style.top, 10) + rect.top,\r\n      left: parseInt(overlay.style.left, 10) + rect.left,\r\n      width: parseInt(overlay.style.width, 10),\r\n      height: parseInt(overlay.style.height, 10)\r\n    }]);\r\n\r\n    overlay.parentNode.removeChild(overlay);\r\n    overlay = null;\r\n\r\n    document.removeEventListener('mousemove', handleDocumentMousemove);\r\n    enableUserSelect();\r\n  }\r\n}\r\n\r\n/**\r\n * Handle document.keyup event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleDocumentKeyup(e) {\r\n  // Cancel rect if Esc is pressed\r\n  if (e.keyCode === 27) {\r\n    let selection = window.getSelection();\r\n    selection.removeAllRanges();\r\n    if (overlay && overlay.parentNode) {\r\n      overlay.parentNode.removeChild(overlay);\r\n      overlay = null;\r\n      document.removeEventListener('mousemove', handleDocumentMousemove);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Save a rect annotation\r\n *\r\n * @param {String} type The type of rect (area, highlight, strikeout)\r\n * @param {Array} rects The rects to use for annotation\r\n * @param {String} color The color of the rects\r\n */\r\nfunction saveRect(type, rects, color) {\r\n  let svg = findSVGAtPoint(rects[0].left, rects[0].top);\r\n  let node;\r\n  let annotation;\r\n\r\n  if (!svg) {\r\n    return;\r\n  }\r\n\r\n  let boundingRect = svg.getBoundingClientRect();\r\n\r\n  if (!color) {\r\n    if (type === 'highlight') {\r\n      color = 'FFFF00';\r\n    } else if (type === 'strikeout') {\r\n      color = 'FF0000';\r\n    }\r\n  }\r\n\r\n  // Initialize the annotation\r\n  annotation = {\r\n    type,\r\n    color,\r\n    rectangles: [...rects].map((r) => {\r\n      let offset = 0;\r\n\r\n      if (type === 'strikeout') {\r\n        offset = r.height / 2;\r\n      }\r\n\r\n      return scaleDown(svg, {\r\n        y: (r.top + offset) - boundingRect.top,\r\n        x: r.left - boundingRect.left,\r\n        width: r.width,\r\n        height: r.height\r\n      });\r\n    }).filter((r) => r.width > 0 && r.height > 0 && r.x > -1 && r.y > -1)\r\n  };\r\n  \r\n  // Short circuit if no rectangles exist\r\n  if (annotation.rectangles.length === 0) {\r\n    return;\r\n  }\r\n\r\n  // Special treatment for area as it only supports a single rect\r\n  if (type === 'area') {\r\n    let rect = annotation.rectangles[0];\r\n    delete annotation.rectangles;\r\n    annotation.x = rect.x;\r\n    annotation.y = rect.y;\r\n    annotation.width = rect.width;\r\n    annotation.height = rect.height;\r\n  }\r\n\r\n  let { documentId, pageNumber } = getMetadata(svg);\r\n\r\n  // Add the annotation\r\n  PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\r\n    .then((annotation) => {\r\n      appendChild(svg, annotation);\r\n    });\r\n}\r\n\r\n/**\r\n * Enable rect behavior\r\n */\r\nexport function enableRect(type) {\r\n  _type = type;\r\n  \r\n  if (_enabled) { return; }\r\n\r\n  _enabled = true;\r\n  document.addEventListener('mouseup', handleDocumentMouseup);\r\n  document.addEventListener('mousedown', handleDocumentMousedown);\r\n  document.addEventListener('keyup', handleDocumentKeyup);\r\n}\r\n\r\n/**\r\n * Disable rect behavior\r\n */\r\nexport function disableRect() {\r\n  if (!_enabled) { return; }\r\n\r\n  _enabled = false;\r\n  document.removeEventListener('mouseup', handleDocumentMouseup);\r\n  document.removeEventListener('mousedown', handleDocumentMousedown);\r\n  document.removeEventListener('keyup', handleDocumentKeyup);\r\n}\r\n\r\n","import PDFJSAnnotate from '../PDFJSAnnotate';\r\nimport appendChild from '../render/appendChild';\r\nimport {\r\n  BORDER_COLOR,\r\n  findSVGAtPoint,\r\n  getMetadata,\r\n  scaleDown\r\n} from './utils';\r\n\r\nlet _enabled = false;\r\nlet input;\r\nlet _textSize;\r\nlet _textColor;\r\n\r\n/**\r\n * Handle document.mouseup event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleDocumentMouseup(e) {\r\n  if (input || !findSVGAtPoint(e.clientX, e.clientY)) {\r\n    return;\r\n  }\r\n\r\n  input = document.createElement('input');\r\n  input.setAttribute('id', 'pdf-annotate-text-input');\r\n  input.setAttribute('placeholder', 'Enter text');\r\n  input.style.border = `3px solid ${BORDER_COLOR}`;\r\n  input.style.borderRadius = '3px';\r\n  input.style.position = 'absolute';\r\n  input.style.top = `${e.clientY}px`;\r\n  input.style.left = `${e.clientX}px`;\r\n  input.style.fontSize = `${_textSize}px`;\r\n\r\n  input.addEventListener('blur', handleInputBlur);\r\n  input.addEventListener('keyup', handleInputKeyup);\r\n\r\n  document.body.appendChild(input);\r\n  input.focus();\r\n}\r\n\r\n/**\r\n * Handle input.blur event\r\n */\r\nfunction handleInputBlur() {\r\n  saveText();\r\n}\r\n\r\n/**\r\n * Handle input.keyup event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleInputKeyup(e) {\r\n  if (e.keyCode === 27) {\r\n    closeInput();\r\n  } else if (e.keyCode === 13) {\r\n    saveText();\r\n  }\r\n}\r\n\r\n/**\r\n * Save a text annotation from input\r\n */\r\nfunction saveText() {\r\n  if (input.value.trim().length > 0) {\r\n    let clientX = parseInt(input.style.left, 10);\r\n    let clientY = parseInt(input.style.top, 10);\r\n    let svg = findSVGAtPoint(clientX, clientY);\r\n    if (!svg) {\r\n      return;\r\n    }\r\n\r\n    let { documentId, pageNumber } = getMetadata(svg);\r\n    let rect = svg.getBoundingClientRect();\r\n    let annotation = Object.assign({\r\n        type: 'textbox',\r\n        size: _textSize,\r\n        color: _textColor,\r\n        content: input.value.trim()\r\n      }, scaleDown(svg, {\r\n        x: clientX - rect.left,\r\n        y: clientY -  rect.top,\r\n        width: input.offsetWidth,\r\n        height: input.offsetHeight\r\n      })\r\n    );\r\n\r\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\r\n      .then((annotation) => {\r\n        appendChild(svg, annotation);\r\n      });\r\n  }\r\n  \r\n  closeInput();\r\n}\r\n\r\n/**\r\n * Close the input\r\n */\r\nfunction closeInput() {\r\n  if (input) {\r\n    input.removeEventListener('blur', handleInputBlur);\r\n    input.removeEventListener('keyup', handleInputKeyup);\r\n    document.body.removeChild(input);\r\n    input = null;\r\n  }\r\n}\r\n\r\n/**\r\n * Set the text attributes\r\n *\r\n * @param {Number} textSize The size of the text\r\n * @param {String} textColor The color of the text\r\n */\r\nexport function setText(textSize = 12, textColor = '000000') {\r\n  _textSize = parseInt(textSize, 10);\r\n  _textColor = textColor;\r\n}\r\n\r\n\r\n/**\r\n * Enable text behavior\r\n */\r\nexport function enableText() {\r\n  if (_enabled) { return; }\r\n\r\n  _enabled = true;\r\n  document.addEventListener('mouseup', handleDocumentMouseup);\r\n}\r\n\r\n\r\n/**\r\n * Disable text behavior\r\n */\r\nexport function disableText() {\r\n  if (!_enabled) { return; }\r\n\r\n  _enabled = false;\r\n  document.removeEventListener('mouseup', handleDocumentMouseup);\r\n}\r\n\r\n","import PDFJSAnnotate from '../PDFJSAnnotate';\r\nimport renderScreenReaderHints from '../a11y/renderScreenReaderHints';\r\n\r\n// Template for creating a new page\r\nconst PAGE_TEMPLATE = `\r\n  <div style=\"visibility: hidden;\" class=\"page\" data-loaded=\"false\">\r\n    <div class=\"canvasWrapper\">\r\n      <canvas></canvas>\r\n    </div>\r\n    <svg class=\"drawingLayer\"></svg>\r\n    <div class=\"textLayer\"></div>\r\n  </div>\r\n`;\r\n\r\n/**\r\n * Create a new page to be appended to the DOM.\r\n *\r\n * @param {Number} pageNumber The page number that is being created\r\n * @return {HTMLElement}\r\n */\r\nexport function createPage(pageNumber) {\r\n  let temp = document.createElement('div');\r\n  temp.innerHTML = PAGE_TEMPLATE;\r\n\r\n  let page = temp.children[0];\r\n  let canvas = page.querySelector('canvas');\r\n\r\n  page.setAttribute('id', `pageContainer${pageNumber}`);\r\n  page.setAttribute('data-page-number', pageNumber);\r\n\r\n  canvas.mozOpaque = true;\r\n  canvas.setAttribute('id', `page${pageNumber}`);\r\n\r\n  return page;\r\n}\r\n\r\n/**\r\n * Render a page that has already been created.\r\n *\r\n * @param {Number} pageNumber The page number to be rendered\r\n * @param {Object} renderOptions The options for rendering\r\n * @return {Promise} Settled once rendering has completed\r\n *  A settled Promise will be either:\r\n *    - fulfilled: [pdfPage, annotations]\r\n *    - rejected: Error\r\n */\r\nexport function renderPage(pageNumber, renderOptions) {\r\n  let {\r\n    documentId,\r\n    pdfDocument,\r\n    scale,\r\n    rotate\r\n  } = renderOptions;\r\n\r\n  // Load the page and annotations\r\n  return Promise.all([\r\n    pdfDocument.getPage(pageNumber),\r\n    PDFJSAnnotate.getAnnotations(documentId, pageNumber)\r\n  ]).then(([pdfPage, annotations]) => {\r\n    let page = document.getElementById(`pageContainer${pageNumber}`);\r\n    let svg = page.querySelector('.annotationLayer');\r\n    let canvas = page.querySelector('.canvasWrapper canvas');\r\n    let canvasContext = canvas.getContext('2d', {alpha: false});\r\n    let viewport = pdfPage.getViewport({scale, roation: rotate});\r\n    let transform = scalePage(pageNumber, viewport, canvasContext);\r\n    \r\n    // Render the page\r\n    return Promise.all([\r\n      pdfPage.render({ canvasContext, viewport, transform }),\r\n      PDFJSAnnotate.render(svg, viewport, annotations)\r\n    ]).then(() => {\r\n      // Text content is needed for a11y, but is also necessary for creating\r\n      // highlight and strikeout annotations which require selecting text.\r\n      return pdfPage.getTextContent({normalizeWhitespace: true}).then((textContent) => {\r\n        return new Promise((resolve, reject) => {\r\n          // Render text layer for a11y of text content\r\n          let textLayer = page.querySelector(`.textLayer`);\r\n          let textLayerFactory = new pdfjsViewer.DefaultTextLayerFactory();\r\n          let textLayerBuilder = textLayerFactory.createTextLayerBuilder(textLayer, pageNumber -1, viewport);\r\n          textLayerBuilder.setTextContent(textContent);\r\n          textLayerBuilder.render();\r\n\r\n          // Enable a11y for annotations\r\n          // Timeout is needed to wait for `textLayerBuilder.render`\r\n          setTimeout(() => {\r\n            try {\r\n              renderScreenReaderHints(annotations.annotations);\r\n              resolve();\r\n            } catch (e) {\r\n              reject(e);\r\n            }\r\n          });\r\n        });\r\n      });\r\n    }).then(() => {\r\n      // Indicate that the page was loaded\r\n      page.setAttribute('data-loaded', 'true');\r\n\r\n      return [pdfPage, annotations];\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Scale the elements of a page.\r\n *\r\n * @param {Number} pageNumber The page number to be scaled\r\n * @param {Object} viewport The viewport of the PDF page (see pdfPage.getViewport(scale, rotate))\r\n * @param {Object} context The canvas context that the PDF page is rendered to\r\n * @return {Array} The transform data for rendering the PDF page\r\n */\r\nfunction scalePage(pageNumber, viewport, context) {\r\n  let page = document.getElementById(`pageContainer${pageNumber}`);\r\n  let canvas = page.querySelector('.canvasWrapper canvas');\r\n  let svg = page.querySelector('.drawingLayer');\r\n  let wrapper = page.querySelector('.canvasWrapper');\r\n  let textLayer = page.querySelector('.textLayer');\r\n  let outputScale = getOutputScale(context);\r\n  let transform = !outputScale.scaled ? null : [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\r\n  let sfx = approximateFraction(outputScale.sx);\r\n  let sfy = approximateFraction(outputScale.sy);\r\n\r\n  // Adjust width/height for scale\r\n  page.style.visibility = '';\r\n  canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\r\n  canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\r\n  canvas.style.width = roundToDivide(viewport.width, sfx[1]) + 'px';\r\n  canvas.style.height = roundToDivide(viewport.height, sfx[1]) + 'px';\r\n  svg.setAttribute('width', viewport.width);\r\n  svg.setAttribute('height', viewport.height);\r\n  svg.style.width = `${viewport.width}px`;\r\n  svg.style.height = `${viewport.height}px`;\r\n  page.style.width = `${viewport.width}px`;\r\n  page.style.height = `${viewport.height}px`;\r\n  wrapper.style.width = `${viewport.width}px`;\r\n  wrapper.style.height = `${viewport.height}px`;\r\n  textLayer.style.width = `${viewport.width}px`;\r\n  textLayer.style.height = `${viewport.height}px`;\r\n\r\n  return transform;\r\n}\r\n\r\n/**\r\n * The following methods are taken from mozilla/pdf.js and as such fall under\r\n * the Apache License (http://www.apache.org/licenses/).\r\n *\r\n * Original source can be found at mozilla/pdf.js:\r\n * https://github.com/mozilla/pdf.js/blob/master/web/ui_utils.js\r\n */\r\n\r\n/**\r\n * Approximates a float number as a fraction using Farey sequence (max order\r\n * of 8).\r\n *\r\n * @param {Number} x Positive float number\r\n * @return {Array} Estimated fraction: the first array item is a numerator,\r\n *                 the second one is a denominator.\r\n */\r\nfunction approximateFraction(x) {\r\n  // Fast path for int numbers or their inversions.\r\n  if (Math.floor(x) === x) {\r\n    return [x, 1];\r\n  }\r\n\r\n  const xinv = 1 / x;\r\n  const limit = 8;\r\n  if (xinv > limit) {\r\n    return [1, limit];\r\n  } else if (Math.floor(xinv) === xinv) {\r\n    return [1, xinv];\r\n  }\r\n\r\n  const x_ = x > 1 ? xinv : x;\r\n  \r\n  // a/b and c/d are neighbours in Farey sequence.\r\n  let a = 0, b = 1, c = 1, d = 1;\r\n  \r\n  // Limit search to order 8.\r\n  while (true) {\r\n    // Generating next term in sequence (order of q).\r\n    let p = a + c, q = b + d;\r\n    if (q > limit) {\r\n      break;\r\n    }\r\n    if (x_ <= p / q) {\r\n      c = p; d = q;\r\n    } else {\r\n      a = p; b = q;\r\n    }\r\n  }\r\n\r\n  // Select closest of neighbours to x.\r\n  if (x_ - a / b < c / d - x_) {\r\n    return x_ === x ? [a, b] : [b, a];\r\n  } else {\r\n    return x_ === x ? [c, d] : [d, c];\r\n  }\r\n}\r\n\r\nfunction getOutputScale(ctx) {\r\n  let devicePixelRatio = window.devicePixelRatio || 1;\r\n  let backingStoreRatio = ctx.webkitBackingStorePixelRatio ||\r\n                          ctx.mozBackingStorePixelRatio ||\r\n                          ctx.msBackingStorePixelRatio ||\r\n                          ctx.oBackingStorePixelRatio ||\r\n                          ctx.backingStorePixelRatio || 1;\r\n  let pixelRatio = devicePixelRatio / backingStoreRatio;\r\n  return {\r\n    sx: pixelRatio,\r\n    sy: pixelRatio,\r\n    scaled: pixelRatio !== 1\r\n  };\r\n}\r\n\r\nfunction roundToDivide(x, div) {\r\n  let r = x % div;\r\n  return r === 0 ? x : Math.round(x - r + div);\r\n}\r\n","import { addEventListener, removeEventListener, fireEvent } from './event';\r\nimport { disableEdit, enableEdit } from './edit';\r\nimport { disablePen, enablePen, setPen } from './pen';\r\nimport { disablePoint, enablePoint } from './point';\r\nimport { disableRect, enableRect } from './rect';\r\nimport { disableText, enableText, setText } from './text';\r\nimport { createPage, renderPage } from './page';\r\n\r\nexport default {\r\n  addEventListener, removeEventListener, fireEvent,\r\n  disableEdit, enableEdit,\r\n  disablePen, enablePen, setPen,\r\n  disablePoint, enablePoint,\r\n  disableRect, enableRect,\r\n  disableText, enableText, setText,\r\n  createPage, renderPage\r\n};\r\n","import StoreAdapter from './adapter/StoreAdapter';\r\nimport LocalStoreAdapter from './adapter/LocalStoreAdapter';\r\nimport render from './render';\r\nimport UI from './UI';\r\n\r\nexport default {\r\n  /**\r\n   * Abstract class that needs to be defined so PDFJSAnnotate\r\n   * knows how to communicate with your server.\r\n   */\r\n  StoreAdapter,\r\n\r\n  /**\r\n   * Implementation of StoreAdapter that stores annotation data to localStorage.\r\n   */\r\n  LocalStoreAdapter,\r\n\r\n  /**\r\n   * Abstract instance of StoreAdapter\r\n   */\r\n  __storeAdapter: new StoreAdapter(),\r\n\r\n  /**\r\n   * Getter for the underlying StoreAdapter property\r\n   *\r\n   * @return {StoreAdapter}\r\n   */\r\n  getStoreAdapter() {\r\n    return this.__storeAdapter;\r\n  },\r\n\r\n  /**\r\n   * Setter for the underlying StoreAdapter property\r\n   *\r\n   * @param {StoreAdapter} adapter The StoreAdapter implementation to be used.\r\n   */\r\n  setStoreAdapter(adapter) {\r\n    // TODO this throws an error when bundled\r\n    // if (!(adapter instanceof StoreAdapter)) {\r\n    //   throw new Error('adapter must be an instance of StoreAdapter');\r\n    // }\r\n\r\n    this.__storeAdapter = adapter;\r\n  },\r\n\r\n  /**\r\n   * UI is a helper for instrumenting UI interactions for creating,\r\n   * editing, and deleting annotations in the browser.\r\n   */\r\n  UI,\r\n\r\n  /**\r\n   * Render the annotations for a page in the PDF Document\r\n   *\r\n   * @param {SVGElement} svg The SVG element that annotations should be rendered to\r\n   * @param {PageViewport} viewport The PDFPage.getViewport data\r\n   * @param {Object} data The StoreAdapter.getAnnotations data\r\n   * @return {Promise}\r\n   */\r\n  render,\r\n\r\n  /**\r\n   * Convenience method for getting annotation data\r\n   *\r\n   * @alias StoreAdapter.getAnnotations\r\n   * @param {String} documentId The ID of the document\r\n   * @param {String} pageNumber The page number\r\n   * @return {Promise}\r\n   */\r\n  getAnnotations(documentId, pageNumber) {\r\n    return this.getStoreAdapter().getAnnotations(...arguments);\r\n  }\r\n}\r\n","import PDFJSAnnotate from '../PDFJSAnnotate';\r\nimport appendChild from './appendChild';\r\nimport renderScreenReaderHints from '../a11y/renderScreenReaderHints';\r\n\r\n/**\r\n * Render the response from PDFJSAnnotate.getStoreAdapter().getAnnotations to SVG\r\n *\r\n * @param {SVGElement} svg The SVG element to render the annotations to\r\n * @param {Object} viewport The page viewport data\r\n * @param {Object} data The response from PDFJSAnnotate.getStoreAdapter().getAnnotations\r\n * @return {Promise} Settled once rendering has completed\r\n *  A settled Promise will be either:\r\n *    - fulfilled: SVGElement\r\n *    - rejected: Error\r\n */\r\nexport default function render(svg, viewport, data) {\r\n  return new Promise((resolve, reject) => {\r\n    // Reset the content of the SVG\r\n    svg.innerHTML = ''; \r\n    svg.setAttribute('data-pdf-annotate-container', true);\r\n    svg.setAttribute('data-pdf-annotate-viewport', JSON.stringify(viewport));\r\n    svg.removeAttribute('data-pdf-annotate-document');\r\n    svg.removeAttribute('data-pdf-annotate-page');\r\n\r\n    // If there's no data nothing can be done\r\n    if (!data) {\r\n      return resolve(svg);\r\n    }\r\n\r\n    svg.setAttribute('data-pdf-annotate-document', data.documentId);\r\n    svg.setAttribute('data-pdf-annotate-page', data.pageNumber);\r\n  \r\n    // Make sure annotations is an array\r\n    if (!Array.isArray(data.annotations) || data.annotations.length === 0) {\r\n      return resolve(svg);\r\n    }\r\n\r\n    // Append annotation to svg\r\n    data.annotations.forEach((a) => {\r\n      appendChild(svg, a, viewport);\r\n    });\r\n\r\n    resolve(svg);\r\n  });\r\n}\r\n","import PDFJSAnnotate from './src/PDFJSAnnotate';\r\n\r\nexport default PDFJSAnnotate;\r\n"],"names":["root","factory","exports","module","define","amd","self","blocks","style","document","createElement","text","Object","keys","map","selector","block","prop","value","isNaN","replace","match","toLowerCase","hyphenate","processDeclaration","join","processDeclarationBlock","processRuleSet","setAttribute","appendChild","createTextNode","ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","prototype","call","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","EventEmitter","init","this","once","emitter","name","Promise","resolve","reject","errorListener","err","removeListener","resolver","slice","arguments","eventTargetAgnosticAddListener","handler","flags","on","addErrorHandlerIfEventEmitter","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","m","events","existing","warning","create","newListener","emit","unshift","push","length","warned","w","Error","String","count","console","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","bind","_listeners","unwrap","evlistener","arr","ret","Array","i","unwrapListeners","arrayClone","listenerCount","n","copy","addEventListener","wrapListener","arg","removeEventListener","defineProperty","enumerable","get","set","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","message","context","len","listeners","addListener","prependListener","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","key","rawListeners","eventNames","hasOwnProperty","propIsEnumerable","propertyIsEnumerable","toObject","val","assign","test1","test2","fromCharCode","test3","split","forEach","letter","shouldUseNative","source","from","symbols","to","s","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","d","a","definition","o","obj","r","Symbol","toStringTag","abstractFunction","BORDER_COLOR","userSelectStyleSheet","createStyleSheet","body","findSVGAtPoint","x","y","elements","querySelectorAll","l","el","pointIntersectsRect","getBoundingClientRect","rect","top","bottom","left","right","getOffsetAnnotationRect","getAnnotationRect","getOffset","offsetLeft","offsetTop","h","nodeName","minX","maxX","minY","maxY","getAttribute","splice","p","parseInt","LINE_OFFSET","height","width","result","includes","scaleUp","svg","viewport","getMetadata","scale","scaleDown","parentNode","toUpperCase","disableUserSelect","head","enableUserSelect","removeChild","documentId","pageNumber","JSON","parse","clickNode","fireEvent","e","clientX","clientY","findAnnotationAtPoint","StoreAdapter","__getAnnotations","fn","then","annotations","annotationId","annotation","__addAnnotation","__editAnnotation","__deleteAnnotation","success","content","__addComment","comment","commentId","__deleteComment","REGEXP","replacement","c","Math","random","toString","uuid","LocalStoreAdapter","getAnnotations","filter","page","getAnnotation","findAnnotation","addAnnotation","updateAnnotations","editAnnotation","deleteAnnotation","getComments","addComment","class","deleteComment","localStorage","getItem","setItem","stringify","UPPER_REGEX","BLACKLIST","setAttributes","node","attributes","indexOf","keyCase","REGEX_HASHLESS_HEX","normalizeColor","color","test","SIZE","createRect","createElementNS","isFirefox","navigator","userAgent","transform","trans","rotation","getTranslation","path","querySelector","objectAssign","child","group","fill","fillOpacity","rectangles","stroke","renderRect","strokeWidth","line","x1","y1","x2","y2","outerSVG","innerSVG","viewBox","renderPoint","size","fontSize","innerHTML","renderText","lines","p1","p2","renderPath","createScreenReaderOnly","overflow","insertElementWithinElement","insertBefore","textLayerElementFromPoint","max","temp","cloneNode","tail","outerHTML","insertElementWithinChildren","nodes","textLayer","insertScreenReaderComment","item","renderScreenReaderComments","comments","isArray","PDFJSAnnotate","getStoreAdapter","getElementById","COMMENT_TYPES","reorderAnnotationsByType","removeAnnotation","renderScreenReaderHints","removeElementById","insertComment","removeComment","elementId","SORT_TYPES","sortBy","sort","num","rects","first","last","insertScreenReaderHint","sortByPoint","b","sortByRectPoint","lineA","lineB","overlay","dragOffsetX","dragOffsetY","dragStartX","dragStartY","_enabled","isDragging","createEditOverlay","destroyEditOverlay","anchor","findSVGContainer","id","styleLeft","styleTop","boxSizing","border","borderRadius","background","padding","textAlign","textDecoration","handleDocumentClick","handleDocumentKeyup","handleDocumentMousedown","borderColor","boxShadow","display","handleDocumentMousemove","handleDocumentMouseup","keyCode","cursor","offsetHeight","offsetWidth","calcDelta","deltaX","deltaY","propX","propY","t","modelY","viewY","modelX","viewX","originX","originY","setTimeout","handleAnnotationClick","_penSize","_penColor","point","savePoint","input","handleInputBlur","handleInputKeyup","focus","closeInput","trim","_type","window","getSelection","getRangeAt","getClientRects","getSelectionRects","saveRect","removeAllRanges","boundingRect","offset","_textSize","_textColor","saveText","approximateFraction","floor","xinv","x_","q","roundToDivide","div","round","disableEdit","enableEdit","disablePen","enablePen","setPen","penSize","penColor","disablePoint","enablePoint","disableRect","enableRect","disableText","enableText","setText","textSize","textColor","createPage","children","canvas","mozOpaque","renderPage","renderOptions","pdfDocument","rotate","all","getPage","pdfPage","canvasContext","getContext","alpha","getViewport","roation","wrapper","outputScale","ctx","devicePixelRatio","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","pixelRatio","sx","sy","scaled","sfx","sfy","visibility","scalePage","render","getTextContent","normalizeWhitespace","textContent","textLayerBuilder","pdfjsViewer","DefaultTextLayerFactory","createTextLayerBuilder","setTextContent","__storeAdapter","setStoreAdapter","adapter","UI","data","removeAttribute"],"sourceRoot":""}