{"version":3,"file":"pdf-annotate.js","mappings":"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kN,MAAL,KAAc,EAAd,GAAiB,CAAzB;AACA,MAAIC,CAAC,GAAG5M,CAAC,IAAI,GAAL,GAAWW,CAAX,GAAgBA,CAAC,GAAC,GAAF,GAAM,GAA9B;AACA,SAAOiM,CAAC,CAACC,QAAF,CAAW,EAAX,CAAP;AACD;AAED;AACA;AACA;AACA;AACA;;;AACe,SAAS3K,IAAT,GAAgB;AAC7B,SAAOuK,OAAO,CAACxH,OAAR,CAAgBuH,MAAhB,EAAwBE,WAAxB,CAAP;AACD;;;;;;;;;;AChBD;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA,uBAAuB,2CAA2C;AAClE;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA,4CAA4C;AAC5C;;AAEA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB;;AAEnB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,sBAAsB;AACxC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,eAAe;AACf;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;AACA,oBAAoB,SAAS;AAC7B;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;;AAEA,kCAAkC,QAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,QAAQ;AACR;AACA,uCAAuC,QAAQ;AAC/C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,OAAO;AACzB;AACA;AACA;;AAEA;AACA,SAAS,yBAAyB;AAClC;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,gBAAgB;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,8DAA8D,YAAY;AAC1E;AACA,8DAA8D,YAAY;AAC1E;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,qCAAqC,YAAY;AACjD;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;;;;;;;;;;;;AChfA;AACA;AACA;AACA;AACA;;AAEa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,QAAQ;AAC1B;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH,kCAAkC;AAClC;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;UCzFA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;ACNA;AAEA,iEAAe9Z,0DAAf,E","sources":["webpack://PDFAnnotate/webpack/universalModuleDefinition","webpack://PDFAnnotate/./src/PDFJSAnnotate.js","webpack://PDFAnnotate/./src/UI/edit.js","webpack://PDFAnnotate/./src/UI/event.js","webpack://PDFAnnotate/./src/UI/index.js","webpack://PDFAnnotate/./src/UI/page.js","webpack://PDFAnnotate/./src/UI/pen.js","webpack://PDFAnnotate/./src/UI/point.js","webpack://PDFAnnotate/./src/UI/rect.js","webpack://PDFAnnotate/./src/UI/text.js","webpack://PDFAnnotate/./src/UI/utils.js","webpack://PDFAnnotate/./src/a11y/createScreenReaderOnly.js","webpack://PDFAnnotate/./src/a11y/initEventHandlers.js","webpack://PDFAnnotate/./src/a11y/insertElementWithinChildren.js","webpack://PDFAnnotate/./src/a11y/insertElementWithinElement.js","webpack://PDFAnnotate/./src/a11y/insertScreenReaderComment.js","webpack://PDFAnnotate/./src/a11y/insertScreenReaderHint.js","webpack://PDFAnnotate/./src/a11y/renderScreenReaderComments.js","webpack://PDFAnnotate/./src/a11y/renderScreenReaderHints.js","webpack://PDFAnnotate/./src/adapter/LocalStoreAdapter.js","webpack://PDFAnnotate/./src/adapter/StoreAdapter.js","webpack://PDFAnnotate/./src/render/appendChild.js","webpack://PDFAnnotate/./src/render/index.js","webpack://PDFAnnotate/./src/render/renderLine.js","webpack://PDFAnnotate/./src/render/renderPath.js","webpack://PDFAnnotate/./src/render/renderPoint.js","webpack://PDFAnnotate/./src/render/renderRect.js","webpack://PDFAnnotate/./src/render/renderText.js","webpack://PDFAnnotate/./src/utils/abstractFunction.js","webpack://PDFAnnotate/./src/utils/normalizeColor.js","webpack://PDFAnnotate/./src/utils/setAttributes.js","webpack://PDFAnnotate/./src/utils/uuid.js","webpack://PDFAnnotate/./node_modules/create-stylesheet/index.js","webpack://PDFAnnotate/./node_modules/events/events.js","webpack://PDFAnnotate/./node_modules/object-assign/index.js","webpack://PDFAnnotate/webpack/bootstrap","webpack://PDFAnnotate/webpack/runtime/compat get default export","webpack://PDFAnnotate/webpack/runtime/define property getters","webpack://PDFAnnotate/webpack/runtime/hasOwnProperty shorthand","webpack://PDFAnnotate/webpack/runtime/make namespace object","webpack://PDFAnnotate/./index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PDFAnnotate\"] = factory();\n\telse\n\t\troot[\"PDFAnnotate\"] = factory();\n})(self, function() {\nreturn ","import StoreAdapter from './adapter/StoreAdapter';\r\nimport LocalStoreAdapter from './adapter/LocalStoreAdapter';\r\nimport render from './render';\r\nimport UI from './UI';\r\n\r\nexport default {\r\n  /**\r\n   * Abstract class that needs to be defined so PDFJSAnnotate\r\n   * knows how to communicate with your server.\r\n   */\r\n  StoreAdapter,\r\n\r\n  /**\r\n   * Implementation of StoreAdapter that stores annotation data to localStorage.\r\n   */\r\n  LocalStoreAdapter,\r\n\r\n  /**\r\n   * Abstract instance of StoreAdapter\r\n   */\r\n  __storeAdapter: new StoreAdapter(),\r\n\r\n  /**\r\n   * Getter for the underlying StoreAdapter property\r\n   *\r\n   * @return {StoreAdapter}\r\n   */\r\n  getStoreAdapter() {\r\n    return this.__storeAdapter;\r\n  },\r\n\r\n  /**\r\n   * Setter for the underlying StoreAdapter property\r\n   *\r\n   * @param {StoreAdapter} adapter The StoreAdapter implementation to be used.\r\n   */\r\n  setStoreAdapter(adapter) {\r\n    // TODO this throws an error when bundled\r\n    // if (!(adapter instanceof StoreAdapter)) {\r\n    //   throw new Error('adapter must be an instance of StoreAdapter');\r\n    // }\r\n\r\n    this.__storeAdapter = adapter;\r\n  },\r\n\r\n  /**\r\n   * UI is a helper for instrumenting UI interactions for creating,\r\n   * editing, and deleting annotations in the browser.\r\n   */\r\n  UI,\r\n\r\n  /**\r\n   * Render the annotations for a page in the PDF Document\r\n   *\r\n   * @param {SVGElement} svg The SVG element that annotations should be rendered to\r\n   * @param {PageViewport} viewport The PDFPage.getViewport data\r\n   * @param {Object} data The StoreAdapter.getAnnotations data\r\n   * @return {Promise}\r\n   */\r\n  render,\r\n\r\n  /**\r\n   * Convenience method for getting annotation data\r\n   *\r\n   * @alias StoreAdapter.getAnnotations\r\n   * @param {String} documentId The ID of the document\r\n   * @param {String} pageNumber The page number\r\n   * @return {Promise}\r\n   */\r\n  getAnnotations(documentId, pageNumber) {\r\n    return this.getStoreAdapter().getAnnotations(...arguments);\r\n  }\r\n}\r\n","import PDFJSAnnotate from \"../PDFJSAnnotate\";\r\n\r\nimport appendChild from \"../render/appendChild\";\r\nimport { addEventListener, removeEventListener } from \"./event\";\r\nimport {\r\n  BORDER_COLOR,\r\n  disableUserSelect,\r\n  enableUserSelect,\r\n  findSVGContainer,\r\n  findSVGAtPoint,\r\n  getAnnotationRect,\r\n  getMetadata,\r\n  scaleDown,\r\n  scaleUp,\r\n} from \"./utils\";\r\n\r\nlet _enabled = false;\r\nlet isDragging = false,\r\n  overlay;\r\nlet dragOffsetX, dragOffsetY, dragStartX, dragStartY;\r\nconst OVERLAY_BORDER_SIZE = 3;\r\n\r\n/**\r\n * Create an overlay for editing an annotation.\r\n *\r\n * @param {Element} target The annotation element to apply overlay for\r\n */\r\nfunction createEditOverlay(target) {\r\n  destroyEditOverlay();\r\n\r\n  overlay = document.createElement(\"div\");\r\n  let anchor = document.createElement(\"a\");\r\n  let parentNode = findSVGContainer(target).parentNode;\r\n  let id = target.getAttribute(\"data-pdf-annotate-id\");\r\n  let rect = getAnnotationRect(target);\r\n\r\n  showOverlay(rect, id, anchor, parentNode);\r\n}\r\n\r\n/**\r\n * Show the overlay.\r\n * @param {any} rect The rect.\r\n * @param {any} id The Id.\r\n * @param {any} anchor The anchor.\r\n * @param {any} parentNode The parent node.\r\n */\r\nfunction showOverlay(rect, id, anchor, parentNode) {\r\n  let styleLeft = rect.left - OVERLAY_BORDER_SIZE;\r\n  let styleTop = rect.top - OVERLAY_BORDER_SIZE;\r\n\r\n  overlay.setAttribute(\"id\", \"pdf-annotate-edit-overlay\");\r\n  overlay.setAttribute(\"data-target-id\", id);\r\n  overlay.style.boxSizing = \"content-box\";\r\n  overlay.style.position = \"absolute\";\r\n  overlay.style.top = `${styleTop}px`;\r\n  overlay.style.left = `${styleLeft}px`;\r\n  overlay.style.width = `${rect.width}px`;\r\n  overlay.style.height = `${rect.height}px`;\r\n  overlay.style.border = `${OVERLAY_BORDER_SIZE}px solid ${BORDER_COLOR}`;\r\n  overlay.style.borderRadius = `${OVERLAY_BORDER_SIZE}px`;\r\n\r\n  anchor.innerHTML = \"\";\r\n  anchor.setAttribute(\"href\", \"javascript://\");\r\n  anchor.style.background = \"#fff\";\r\n  anchor.style.borderRadius = \"20px\";\r\n  anchor.style.border = \"1px solid #bbb\";\r\n  anchor.style.color = \"#bbb\";\r\n  anchor.style.fontSize = \"16px\";\r\n  anchor.style.padding = \"2px\";\r\n  anchor.style.textAlign = \"center\";\r\n  anchor.style.textDecoration = \"none\";\r\n  anchor.style.position = \"absolute\";\r\n  anchor.style.top = \"-13px\";\r\n  anchor.style.right = \"-13px\";\r\n  anchor.style.width = \"25px\";\r\n  anchor.style.height = \"25px\";\r\n\r\n  overlay.appendChild(anchor);\r\n  parentNode.appendChild(overlay);\r\n  document.addEventListener(\"click\", handleDocumentClick);\r\n  document.addEventListener(\"keyup\", handleDocumentKeyup);\r\n  document.addEventListener(\"mousedown\", handleDocumentMousedown);\r\n  anchor.addEventListener(\"click\", deleteAnnotation);\r\n  anchor.addEventListener(\"mouseover\", () => {\r\n    anchor.style.color = \"#35A4DC\";\r\n    anchor.style.borderColor = \"#999\";\r\n    anchor.style.boxShadow = \"0 1px 1px #ccc\";\r\n  });\r\n  anchor.addEventListener(\"mouseout\", () => {\r\n    anchor.style.color = \"#bbb\";\r\n    anchor.style.borderColor = \"#bbb\";\r\n    anchor.style.boxShadow = \"\";\r\n  });\r\n  overlay.addEventListener(\"mouseover\", () => {\r\n    if (!isDragging) {\r\n      anchor.style.display = \"\";\r\n    }\r\n  });\r\n  overlay.addEventListener(\"mouseout\", () => {\r\n    anchor.style.display = \"none\";\r\n  });\r\n\r\n  // Create and dispatch an event that can be listened to outside of pdf-annotate.\r\n  const event = new Event(\"annotation:select\");\r\n  document.dispatchEvent(event);\r\n}\r\n\r\n/**\r\n * Destroy the edit overlay if it exists.\r\n */\r\nfunction destroyEditOverlay() {\r\n  if (overlay) {\r\n    overlay.parentNode.removeChild(overlay);\r\n    overlay = null;\r\n  }\r\n\r\n  document.removeEventListener(\"click\", handleDocumentClick);\r\n  document.removeEventListener(\"keyup\", handleDocumentKeyup);\r\n  document.removeEventListener(\"mousedown\", handleDocumentMousedown);\r\n  document.removeEventListener(\"mousemove\", handleDocumentMousemove);\r\n  document.removeEventListener(\"mouseup\", handleDocumentMouseup);\r\n\r\n  // Create and dispatch an event that can be listened to outside of pdf-annotate.\r\n  const event = new Event(\"annotation:deselect\");\r\n  document.dispatchEvent(event);\r\n\r\n  enableUserSelect();\r\n}\r\n\r\n/**\r\n * Delete currently selected annotation\r\n */\r\nfunction deleteAnnotation() {\r\n  if (!overlay) {\r\n    return;\r\n  }\r\n\r\n  let annotationId = overlay.getAttribute(\"data-target-id\");\r\n  let nodes = document.querySelectorAll(\r\n    `[data-pdf-annotate-id=\"${annotationId}\"]`\r\n  );\r\n  let svg = overlay.parentNode.querySelector(\"svg.drawingLayer\");\r\n  let { documentId } = getMetadata(svg);\r\n\r\n  [...nodes].forEach((n) => {\r\n    n.parentNode.removeChild(n);\r\n  });\r\n\r\n  PDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, annotationId);\r\n\r\n  // Create and dispatch an event that can be listened to outside of pdf-annotate.\r\n  const event = new Event(\"annotation:delete\");\r\n  document.dispatchEvent(event);\r\n\r\n  destroyEditOverlay();\r\n}\r\n\r\n/**\r\n * Handle document.click event\r\n *\r\n * @param {Event} e The DOM event that needs to be handled\r\n */\r\nfunction handleDocumentClick(e) {\r\n  if (!findSVGAtPoint(e.clientX, e.clientY)) {\r\n    return;\r\n  }\r\n\r\n  // Remove current overlay\r\n  let overlay = document.getElementById(\"pdf-annotate-edit-overlay\");\r\n  if (overlay) {\r\n    if (isDragging || e.target === overlay) {\r\n      return;\r\n    }\r\n\r\n    destroyEditOverlay();\r\n  }\r\n}\r\n\r\n/**\r\n * Handle document.keyup event\r\n *\r\n * @param {Event} e The DOM event that needs to be handled\r\n */\r\nfunction handleDocumentKeyup(e) {\r\n  if (\r\n    overlay &&\r\n    e.keyCode === 46 &&\r\n    e.target.nodeName.toLowerCase() !== \"textarea\" &&\r\n    e.target.nodeName.toLowerCase() !== \"input\"\r\n  ) {\r\n    deleteAnnotation();\r\n  }\r\n}\r\n\r\n/**\r\n * Handle document.mousedown event\r\n *\r\n * @param {Event} e The DOM event that needs to be handled\r\n */\r\nfunction handleDocumentMousedown(e) {\r\n  if (e.target !== overlay) {\r\n    return;\r\n  }\r\n\r\n  // Highlight and strikeout annotations are bound to text within the document.\r\n  // It doesn't make sense to allow repositioning these types of annotations.\r\n  let annotationId = overlay.getAttribute(\"data-target-id\");\r\n  let target = document.querySelector(\r\n    `[data-pdf-annotate-id=\"${annotationId}\"]`\r\n  );\r\n  let type = target.getAttribute(\"data-pdf-annotate-type\");\r\n\r\n  if (type === \"highlight\" || type === \"strikeout\") {\r\n    return;\r\n  }\r\n\r\n  isDragging = true;\r\n  dragOffsetX = e.clientX;\r\n  dragOffsetY = e.clientY;\r\n  dragStartX = overlay.offsetLeft;\r\n  dragStartY = overlay.offsetTop;\r\n\r\n  overlay.style.background = \"rgba(255, 255, 255, 0.7)\";\r\n  overlay.style.cursor = \"move\";\r\n  overlay.querySelector(\"a\").style.display = \"none\";\r\n\r\n  document.addEventListener(\"mousemove\", handleDocumentMousemove);\r\n  document.addEventListener(\"mouseup\", handleDocumentMouseup);\r\n  disableUserSelect();\r\n}\r\n\r\n/**\r\n * Handle document.mousemove event\r\n *\r\n * @param {Event} e The DOM event that needs to be handled\r\n */\r\nfunction handleDocumentMousemove(e) {\r\n  let annotationId = overlay.getAttribute(\"data-target-id\");\r\n  let parentNode = overlay.parentNode;\r\n  let rect = parentNode.getBoundingClientRect();\r\n  let y = dragStartY + (e.clientY - dragOffsetY);\r\n  let x = dragStartX + (e.clientX - dragOffsetX);\r\n  let minY = 0;\r\n  let maxY = rect.height;\r\n  let minX = 0;\r\n  let maxX = rect.width;\r\n\r\n  if (y > minY && y + overlay.offsetHeight < maxY) {\r\n    overlay.style.top = `${y}px`;\r\n  }\r\n\r\n  if (x > minX && x + overlay.offsetWidth < maxX) {\r\n    overlay.style.left = `${x}px`;\r\n  }\r\n}\r\n\r\n/**\r\n * Handle document.mouseup event\r\n *\r\n * @param {Event} e The DOM event that needs to be handled\r\n */\r\nfunction handleDocumentMouseup(e) {\r\n  let annotationId = overlay.getAttribute(\"data-target-id\");\r\n  let target = document.querySelectorAll(\r\n    `[data-pdf-annotate-id=\"${annotationId}\"]`\r\n  );\r\n  let type = target[0].getAttribute(\"data-pdf-annotate-type\");\r\n  let svg = overlay.parentNode.querySelector(\"svg.drawingLayer\");\r\n  let { documentId } = getMetadata(svg);\r\n\r\n  overlay.querySelector(\"a\").style.display = \"\";\r\n\r\n  function getDelta(propX, propY) {\r\n    return calcDelta(\r\n      parseInt(target[0].getAttribute(propX), 10),\r\n      parseInt(target[0].getAttribute(propY), 10)\r\n    );\r\n  }\r\n\r\n  function calcDelta(x, y) {\r\n    return {\r\n      deltaX:\r\n        OVERLAY_BORDER_SIZE + scaleDown(svg, { x: overlay.offsetLeft }).x - x,\r\n      deltaY:\r\n        OVERLAY_BORDER_SIZE + scaleDown(svg, { y: overlay.offsetTop }).y - y,\r\n    };\r\n  }\r\n\r\n  PDFJSAnnotate.getStoreAdapter()\r\n    .getAnnotation(documentId, annotationId)\r\n    .then((annotation) => {\r\n      if ([\"area\", \"highlight\", \"point\", \"textbox\"].indexOf(type) > -1) {\r\n        let { deltaX, deltaY } = getDelta(\"x\", \"y\");\r\n        [...target].forEach((t, i) => {\r\n          if (deltaY !== 0) {\r\n            let modelY = parseInt(t.getAttribute(\"y\"), 10) + deltaY;\r\n            let viewY = modelY;\r\n\r\n            if (type === \"point\") {\r\n              viewY = scaleUp(svg, { viewY }).viewY;\r\n            }\r\n\r\n            t.setAttribute(\"y\", viewY);\r\n            if (annotation.rectangles) {\r\n              annotation.rectangles[i].y = modelY;\r\n            } else if (annotation.y) {\r\n              annotation.y = modelY;\r\n            }\r\n          }\r\n          if (deltaX !== 0) {\r\n            let modelX = parseInt(t.getAttribute(\"x\"), 10) + deltaX;\r\n            let viewX = modelX;\r\n\r\n            if (type === \"point\") {\r\n              viewX = scaleUp(svg, { viewX }).viewX;\r\n            }\r\n\r\n            t.setAttribute(\"x\", viewX);\r\n            if (annotation.rectangles) {\r\n              annotation.rectangles[i].x = modelX;\r\n            } else if (annotation.x) {\r\n              annotation.x = modelX;\r\n              if (type === \"textbox\") {\r\n                Array.from(t.children).forEach((child) =>\r\n                  child.setAttribute(\"x\", modelX)\r\n                );\r\n              }\r\n            }\r\n          }\r\n        });\r\n        // } else if (type === 'strikeout') {\r\n        //   let { deltaX, deltaY } = getDelta('x1', 'y1');\r\n        //   [...target].forEach(target, (t, i) => {\r\n        //     if (deltaY !== 0) {\r\n        //       t.setAttribute('y1', parseInt(t.getAttribute('y1'), 10) + deltaY);\r\n        //       t.setAttribute('y2', parseInt(t.getAttribute('y2'), 10) + deltaY);\r\n        //       annotation.rectangles[i].y = parseInt(t.getAttribute('y1'), 10);\r\n        //     }\r\n        //     if (deltaX !== 0) {\r\n        //       t.setAttribute('x1', parseInt(t.getAttribute('x1'), 10) + deltaX);\r\n        //       t.setAttribute('x2', parseInt(t.getAttribute('x2'), 10) + deltaX);\r\n        //       annotation.rectangles[i].x = parseInt(t.getAttribute('x1'), 10);\r\n        //     }\r\n        //   });\r\n      } else if (type === \"drawing\") {\r\n        let rect = scaleDown(svg, getAnnotationRect(target[0]));\r\n        let [originX, originY] = annotation.lines[0];\r\n        let { deltaX, deltaY } = calcDelta(originX, originY);\r\n\r\n        // origin isn't necessarily at 0/0 in relation to overlay x/y\r\n        // adjust the difference between overlay and drawing coords\r\n        deltaY += originY - rect.top;\r\n        deltaX += originX - rect.left;\r\n\r\n        annotation.lines.forEach((line, i) => {\r\n          let [x, y] = annotation.lines[i];\r\n          annotation.lines[i][0] = x + deltaX;\r\n          annotation.lines[i][1] = y + deltaY;\r\n        });\r\n\r\n        target[0].parentNode.removeChild(target[0]);\r\n        appendChild(svg, annotation);\r\n      }\r\n\r\n      PDFJSAnnotate.getStoreAdapter().editAnnotation(\r\n        documentId,\r\n        annotationId,\r\n        annotation\r\n      );\r\n    });\r\n\r\n  setTimeout(() => {\r\n    isDragging = false;\r\n  }, 0);\r\n\r\n  overlay.style.background = \"\";\r\n  overlay.style.cursor = \"\";\r\n\r\n  document.removeEventListener(\"mousemove\", handleDocumentMousemove);\r\n  document.removeEventListener(\"mouseup\", handleDocumentMouseup);\r\n  enableUserSelect();\r\n}\r\n\r\n/**\r\n * Handle annotation.click event\r\n *\r\n * @param {Element} e The annotation element that was clicked\r\n */\r\nfunction handleAnnotationClick(target) {\r\n  createEditOverlay(target);\r\n}\r\n\r\n/**\r\n * Select an annotation from an id.\r\n * @param {Number} id The annotation Id.\r\n */\r\nexport function selectAnnotationFromId(id) {\r\n  destroyEditOverlay();\r\n\r\n  overlay = document.createElement(\"div\");\r\n  let anchor = document.createElement(\"a\");\r\n  let parentNode = document.querySelector(\"svg.drawingLayer\").parentNode;\r\n  let target = document.querySelector(`[data-pdf-annotate-id=\"${id}\"]`);\r\n  let rect = getAnnotationRect(target);\r\n\r\n  showOverlay(rect, id, anchor, parentNode);\r\n}\r\n\r\n/**\r\n * Delete an annotation via its Id.\r\n * @param {Number} annotationId The annotation Id to delete.\r\n */\r\nexport function deleteAnnotationFromId(annotationId) {\r\n  let nodes = document.querySelectorAll(\r\n    `[data-pdf-annotate-id=\"${annotationId}\"]`\r\n  );\r\n\r\n  let svg = document.querySelector(\"svg.drawingLayer\");\r\n  let { documentId } = getMetadata(svg);\r\n\r\n  [...nodes].forEach((n) => {\r\n    n.parentNode.removeChild(n);\r\n  });\r\n\r\n  PDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, annotationId);\r\n}\r\n\r\n/**\r\n * Function to clear all annotations.\r\n */\r\nexport function clearAll() {\r\n  let svg = document.querySelector(\"svg.drawingLayer\");\r\n  let { documentId, pageNumber } = getMetadata(svg);\r\n\r\n  PDFJSAnnotate.getStoreAdapter()\r\n    .getAnnotations(documentId, pageNumber)\r\n    .then((annotations) => {\r\n      annotations.annotations.forEach((annotation) =>\r\n        PDFJSAnnotate.getStoreAdapter().deleteAnnotation(\r\n          documentId,\r\n          annotation.annotationId\r\n        )\r\n      );\r\n    });\r\n}\r\n\r\n/**\r\n * Enable edit mode behavior.\r\n */\r\nexport function enableEdit() {\r\n  if (_enabled) {\r\n    return;\r\n  }\r\n\r\n  _enabled = true;\r\n  addEventListener(\"annotation:click\", handleAnnotationClick);\r\n}\r\n\r\n/**\r\n * Disable edit mode behavior.\r\n */\r\nexport function disableEdit() {\r\n  destroyEditOverlay();\r\n\r\n  if (!_enabled) {\r\n    return;\r\n  }\r\n\r\n  _enabled = false;\r\n  removeEventListener(\"annotation:click\", handleAnnotationClick);\r\n}\r\n","import EventEmitter from 'events';\r\nimport {\r\n  findAnnotationAtPoint,\r\n  findSVGAtPoint\r\n} from './utils';\r\n\r\nconst emitter = new EventEmitter;\r\n\r\nlet clickNode;\r\n\r\n/**\r\n * Handle document.click event\r\n *\r\n * @param {Event} e The DOM event to be handled\r\n */\r\ndocument.addEventListener('click', function handleDocumentClick(e) {\r\n  if (!findSVGAtPoint(e.clientX, e.clientY)) { return; }\r\n\r\n  let target = findAnnotationAtPoint(e.clientX, e.clientY);\r\n\r\n  // Emit annotation:blur if clickNode is no longer clicked\r\n  if (clickNode && clickNode !== target) {\r\n    emitter.emit('annotation:blur', clickNode);\r\n  }\r\n\r\n  // Emit annotation:click if target was clicked\r\n  if (target) {\r\n    emitter.emit('annotation:click', target);\r\n  }\r\n\r\n  clickNode = target;\r\n});\r\n\r\n// let mouseOverNode;\r\n// document.addEventListener('mousemove', function handleDocumentMousemove(e) {\r\n//   let target = findAnnotationAtPoint(e.clientX, e.clientY);\r\n//\r\n//   // Emit annotation:mouseout if target was mouseout'd\r\n//   if (mouseOverNode && !target) {\r\n//     emitter.emit('annotation:mouseout', mouseOverNode);\r\n//   }\r\n//\r\n//   // Emit annotation:mouseover if target was mouseover'd\r\n//   if (target && mouseOverNode !== target) {\r\n//     emitter.emit('annotation:mouseover', target);\r\n//   }\r\n//\r\n//   mouseOverNode = target;\r\n// });\r\n\r\nexport function fireEvent() { emitter.emit(...arguments); };\r\nexport function addEventListener() { emitter.on(...arguments); };\r\nexport function removeEventListener() { emitter.removeListener(...arguments); };\r\n","import { addEventListener, removeEventListener, fireEvent } from \"./event\";\r\nimport {\r\n  disableEdit,\r\n  enableEdit,\r\n  deleteAnnotationFromId,\r\n  clearAll,\r\n  selectAnnotationFromId,\r\n} from \"./edit\";\r\nimport { disablePen, enablePen, setPen } from \"./pen\";\r\nimport { disablePoint, enablePoint } from \"./point\";\r\nimport { disableRect, enableRect, highlightText, editRect } from \"./rect\";\r\nimport {\r\n  disableText,\r\n  enableText,\r\n  setText,\r\n  openTextInput,\r\n  editText,\r\n} from \"./text\";\r\nimport { createPage, renderPage } from \"./page\";\r\n\r\nexport default {\r\n  addEventListener,\r\n  removeEventListener,\r\n  fireEvent,\r\n  disableEdit,\r\n  enableEdit,\r\n  disablePen,\r\n  enablePen,\r\n  deleteAnnotationFromId,\r\n  clearAll,\r\n  selectAnnotationFromId,\r\n  setPen,\r\n  disablePoint,\r\n  enablePoint,\r\n  disableRect,\r\n  enableRect,\r\n  highlightText,\r\n  editRect,\r\n  disableText,\r\n  enableText,\r\n  setText,\r\n  openTextInput,\r\n  editText,\r\n  createPage,\r\n  renderPage,\r\n};\r\n","import PDFJSAnnotate from \"../PDFJSAnnotate\";\r\nimport renderScreenReaderHints from \"../a11y/renderScreenReaderHints\";\r\n\r\n// Template for creating a new page\r\nconst PAGE_TEMPLATE = `\r\n  <div style=\"visibility: hidden;\" class=\"page\" data-loaded=\"false\">\r\n    <div class=\"canvasWrapper\">\r\n      <canvas></canvas>\r\n    </div>\r\n    <svg class=\"drawingLayer\"></svg>\r\n    <div class=\"textLayer\"></div>\r\n    <div class=\"annotationLayer\"></div>\r\n  </div>\r\n`;\r\n\r\n/**\r\n * Create a new page to be appended to the DOM.\r\n *\r\n * @param {Number} pageNumber The page number that is being created\r\n * @return {HTMLElement}\r\n */\r\nexport function createPage(pageNumber) {\r\n  let temp = document.createElement(\"div\");\r\n  temp.innerHTML = PAGE_TEMPLATE;\r\n\r\n  let page = temp.children[0];\r\n  let canvas = page.querySelector(\"canvas\");\r\n\r\n  page.setAttribute(\"id\", `pageContainer${pageNumber}`);\r\n  page.setAttribute(\"data-page-number\", pageNumber);\r\n\r\n  canvas.mozOpaque = true;\r\n  canvas.setAttribute(\"id\", `page${pageNumber}`);\r\n\r\n  return page;\r\n}\r\n\r\n/**\r\n * Render a page that has already been created.\r\n *\r\n * @param {Number} pageNumber The page number to be rendered\r\n * @param {Object} renderOptions The options for rendering\r\n * @return {Promise} Settled once rendering has completed\r\n *  A settled Promise will be either:\r\n *    - fulfilled: [pdfPage, annotations]\r\n *    - rejected: Error\r\n */\r\nexport function renderPage(pageNumber, renderOptions) {\r\n  let { documentId, pdfDocument, scale, rotate } = renderOptions;\r\n\r\n  let eventBus = new pdfjsViewer.EventBus();\r\n\r\n  // Load the page and annotations\r\n  return Promise.all([\r\n    pdfDocument.getPage(pageNumber),\r\n    PDFJSAnnotate.getAnnotations(documentId, pageNumber),\r\n  ]).then(([pdfPage, annotations]) => {\r\n    let page = document.getElementById(`pageContainer${pageNumber}`);\r\n    let svg = page.querySelector(\".drawingLayer\");\r\n    let canvas = page.querySelector(\".canvasWrapper canvas\");\r\n    let canvasContext = canvas.getContext(\"2d\", { alpha: false });\r\n    let viewport = pdfPage.getViewport({ scale, rotation: rotate });\r\n    let transform = scalePage(pageNumber, viewport, canvasContext);\r\n\r\n    // Render the page\r\n    return Promise.all([\r\n      pdfPage.render({\r\n        canvasContext,\r\n        viewport,\r\n        transform,\r\n        renderInteractiveForms: true,\r\n      }),\r\n      PDFJSAnnotate.render(svg, viewport, annotations),\r\n    ])\r\n      .then(() => {\r\n        // Text content is needed for a11y, but is also necessary for creating\r\n        // highlight and strikeout annotations which require selecting text.\r\n        return pdfPage\r\n          .getTextContent({ normalizeWhitespace: true })\r\n          .then((textContent) => {\r\n            return new Promise((resolve, reject) => {\r\n              // Render text layer for a11y of text content\r\n              let textLayer = page.querySelector(`.textLayer`);\r\n              let textLayerFactory = new pdfjsViewer.DefaultTextLayerFactory();\r\n              let textLayerBuilder = textLayerFactory.createTextLayerBuilder(\r\n                textLayer,\r\n                pageNumber - 1,\r\n                viewport,\r\n                false,\r\n                eventBus\r\n              );\r\n              textLayerBuilder.setTextContent(textContent);\r\n              textLayerBuilder.render();\r\n\r\n              let annotationLayer = page.querySelector(\".annotationLayer\");\r\n              let annotationLayerFactory =\r\n                new pdfjsViewer.DefaultAnnotationLayerFactory();\r\n              let annotationLayerBuilder =\r\n                annotationLayerFactory.createAnnotationLayerBuilder(\r\n                  annotationLayer,\r\n                  pdfPage\r\n                );\r\n              annotationLayerBuilder.render(viewport);\r\n\r\n              // Enable a11y for annotations\r\n              // Timeout is needed to wait for `textLayerBuilder.render`\r\n              setTimeout(() => {\r\n                try {\r\n                  renderScreenReaderHints(annotations.annotations);\r\n                  resolve();\r\n                } catch (e) {\r\n                  reject(e);\r\n                }\r\n              });\r\n            });\r\n          });\r\n      })\r\n      .then(() => {\r\n        // Indicate that the page was loaded\r\n        page.setAttribute(\"data-loaded\", \"true\");\r\n\r\n        return [pdfPage, annotations];\r\n      });\r\n  });\r\n}\r\n\r\n/**\r\n * Scale the elements of a page.\r\n *\r\n * @param {Number} pageNumber The page number to be scaled\r\n * @param {Object} viewport The viewport of the PDF page (see pdfPage.getViewport(scale, rotate))\r\n * @param {Object} context The canvas context that the PDF page is rendered to\r\n * @return {Array} The transform data for rendering the PDF page\r\n */\r\nfunction scalePage(pageNumber, viewport, context) {\r\n  let page = document.getElementById(`pageContainer${pageNumber}`);\r\n  let canvas = page.querySelector(\".canvasWrapper canvas\");\r\n  let svg = page.querySelector(\".drawingLayer\");\r\n  let wrapper = page.querySelector(\".canvasWrapper\");\r\n  let textLayer = page.querySelector(\".textLayer\");\r\n  let outputScale = getOutputScale(context);\r\n  let transform = !outputScale.scaled\r\n    ? null\r\n    : [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\r\n  let sfx = approximateFraction(outputScale.sx);\r\n  let sfy = approximateFraction(outputScale.sy);\r\n\r\n  // Adjust width/height for scale\r\n  page.style.visibility = \"\";\r\n  canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\r\n  canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\r\n  canvas.style.width = roundToDivide(viewport.width, sfx[1]) + \"px\";\r\n  canvas.style.height = roundToDivide(viewport.height, sfx[1]) + \"px\";\r\n  svg.setAttribute(\"width\", viewport.width);\r\n  svg.setAttribute(\"height\", viewport.height);\r\n  svg.style.width = `${viewport.width}px`;\r\n  svg.style.height = `${viewport.height}px`;\r\n  page.style.width = `${viewport.width}px`;\r\n  page.style.height = `${viewport.height}px`;\r\n  wrapper.style.width = `${viewport.width}px`;\r\n  wrapper.style.height = `${viewport.height}px`;\r\n  textLayer.style.width = `${viewport.width}px`;\r\n  textLayer.style.height = `${viewport.height}px`;\r\n\r\n  return transform;\r\n}\r\n\r\n/**\r\n * The following methods are taken from mozilla/pdf.js and as such fall under\r\n * the Apache License (http://www.apache.org/licenses/).\r\n *\r\n * Original source can be found at mozilla/pdf.js:\r\n * https://github.com/mozilla/pdf.js/blob/master/web/ui_utils.js\r\n */\r\n\r\n/**\r\n * Approximates a float number as a fraction using Farey sequence (max order\r\n * of 8).\r\n *\r\n * @param {Number} x Positive float number\r\n * @return {Array} Estimated fraction: the first array item is a numerator,\r\n *                 the second one is a denominator.\r\n */\r\nfunction approximateFraction(x) {\r\n  // Fast path for int numbers or their inversions.\r\n  if (Math.floor(x) === x) {\r\n    return [x, 1];\r\n  }\r\n\r\n  const xinv = 1 / x;\r\n  const limit = 8;\r\n  if (xinv > limit) {\r\n    return [1, limit];\r\n  } else if (Math.floor(xinv) === xinv) {\r\n    return [1, xinv];\r\n  }\r\n\r\n  const x_ = x > 1 ? xinv : x;\r\n\r\n  // a/b and c/d are neighbours in Farey sequence.\r\n  let a = 0,\r\n    b = 1,\r\n    c = 1,\r\n    d = 1;\r\n\r\n  // Limit search to order 8.\r\n  while (true) {\r\n    // Generating next term in sequence (order of q).\r\n    let p = a + c,\r\n      q = b + d;\r\n    if (q > limit) {\r\n      break;\r\n    }\r\n    if (x_ <= p / q) {\r\n      c = p;\r\n      d = q;\r\n    } else {\r\n      a = p;\r\n      b = q;\r\n    }\r\n  }\r\n\r\n  // Select closest of neighbours to x.\r\n  if (x_ - a / b < c / d - x_) {\r\n    return x_ === x ? [a, b] : [b, a];\r\n  } else {\r\n    return x_ === x ? [c, d] : [d, c];\r\n  }\r\n}\r\n\r\nfunction getOutputScale(ctx) {\r\n  let devicePixelRatio = window.devicePixelRatio || 1;\r\n  let backingStoreRatio = ctx.webkitBackingStorePixelRatio || 1;\r\n  let pixelRatio = devicePixelRatio / backingStoreRatio;\r\n  return {\r\n    sx: pixelRatio,\r\n    sy: pixelRatio,\r\n    scaled: pixelRatio !== 1,\r\n  };\r\n}\r\n\r\nfunction roundToDivide(x, div) {\r\n  let r = x % div;\r\n  return r === 0 ? x : Math.round(x - r + div);\r\n}\r\n","import PDFJSAnnotate from '../PDFJSAnnotate';\r\nimport appendChild from '../render/appendChild';\r\nimport {\r\n  disableUserSelect,\r\n  enableUserSelect,\r\n  findSVGAtPoint,\r\n  getMetadata,\r\n  scaleDown\r\n} from './utils';\r\n\r\nlet _enabled = false;\r\nlet _penSize;\r\nlet _penColor;\r\nlet path;\r\nlet lines;\r\n\r\n/**\r\n * Handle document.mousedown event\r\n */\r\nfunction handleDocumentMousedown() {\r\n  path = null;\r\n  lines = [];\r\n\r\n  document.addEventListener('mousemove', handleDocumentMousemove);\r\n  document.addEventListener('mouseup', handleDocumentMouseup);\r\n}\r\n\r\n/**\r\n * Handle document.mouseup event\r\n *\r\n * @param {Event} e The DOM event to be handled\r\n */\r\nfunction handleDocumentMouseup(e) {\r\n  let svg;\r\n  if (lines.length > 1 && (svg = findSVGAtPoint(e.clientX, e.clientY))) {\r\n    let { documentId, pageNumber } = getMetadata(svg);\r\n\r\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, {\r\n        type: 'drawing',\r\n        width: _penSize,\r\n        color: _penColor,\r\n        lines\r\n      }\r\n    ).then((annotation) => {\r\n      if (path) {\r\n        svg.removeChild(path);\r\n      }\r\n\r\n      appendChild(svg, annotation);\r\n    });\r\n  }\r\n\r\n  document.removeEventListener('mousemove', handleDocumentMousemove);\r\n  document.removeEventListener('mouseup', handleDocumentMouseup);\r\n}\r\n\r\n/**\r\n * Handle document.mousemove event\r\n *\r\n * @param {Event} e The DOM event to be handled\r\n */\r\nfunction handleDocumentMousemove(e) {\r\n  savePoint(e.clientX, e.clientY);\r\n}\r\n\r\n/**\r\n * Handle document.keyup event\r\n *\r\n * @param {Event} e The DOM event to be handled\r\n */\r\nfunction handleDocumentKeyup(e) {\r\n  // Cancel rect if Esc is pressed\r\n  if (e.keyCode === 27) {\r\n    lines = null;\r\n    path.parentNode.removeChild(path);\r\n    document.removeEventListener('mousemove', handleDocumentMousemove);\r\n    document.removeEventListener('mouseup', handleDocumentMouseup);\r\n  }\r\n}\r\n\r\n/**\r\n * Save a point to the line being drawn.\r\n *\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n */\r\nfunction savePoint(x, y) {\r\n  let svg = findSVGAtPoint(x, y);\r\n  if (!svg) {\r\n    return;\r\n  }\r\n\r\n  let rect = svg.getBoundingClientRect();\r\n  let point = scaleDown(svg, {\r\n    x: x - rect.left,\r\n    y: y - rect.top\r\n  });\r\n\r\n  lines.push([point.x, point.y]);\r\n\r\n  if (lines.length <= 1) {\r\n    return;\r\n  }\r\n\r\n  if (path) {\r\n    svg.removeChild(path);\r\n  }\r\n\r\n  path = appendChild(svg, {\r\n    type: 'drawing',\r\n    color: _penColor,\r\n    width: _penSize,\r\n    lines\r\n  });\r\n}\r\n\r\n/**\r\n * Set the attributes of the pen.\r\n *\r\n * @param {Number} penSize The size of the lines drawn by the pen\r\n * @param {String} penColor The color of the lines drawn by the pen\r\n */\r\nexport function setPen(penSize = 1, penColor = '000000') {\r\n  _penSize = parseInt(penSize, 10);\r\n  _penColor = penColor;\r\n}\r\n\r\n/**\r\n * Enable the pen behavior\r\n */\r\nexport function enablePen() {\r\n  if (_enabled) { return; }\r\n\r\n  _enabled = true;\r\n  document.addEventListener('mousedown', handleDocumentMousedown);\r\n  document.addEventListener('keyup', handleDocumentKeyup);\r\n  disableUserSelect();\r\n}\r\n\r\n/**\r\n * Disable the pen behavior\r\n */\r\nexport function disablePen() {\r\n  if (!_enabled) { return; }\r\n\r\n  _enabled = false;\r\n  document.removeEventListener('mousedown', handleDocumentMousedown);\r\n  document.removeEventListener('keyup', handleDocumentKeyup);\r\n  enableUserSelect();\r\n}\r\n\r\n","import PDFJSAnnotate from \"../PDFJSAnnotate\";\r\nimport appendChild from \"../render/appendChild\";\r\nimport { BORDER_COLOR, findSVGAtPoint, getMetadata, scaleDown } from \"./utils\";\r\n\r\nlet _enabled = false;\r\nlet input;\r\n\r\n/**\r\n * Handle document.mouseup event\r\n *\r\n * @param {Event} The DOM event to be handled\r\n */\r\nfunction handleDocumentMouseup(e) {\r\n  if (input || !findSVGAtPoint(e.clientX, e.clientY)) {\r\n    return;\r\n  }\r\n\r\n  input = document.createElement(\"input\");\r\n  input.setAttribute(\"id\", \"pdf-annotate-point-input\");\r\n  input.setAttribute(\"placeholder\", \"Enter comment\");\r\n  input.style.border = `3px solid ${BORDER_COLOR}`;\r\n  input.style.borderRadius = \"3px\";\r\n  input.style.position = \"fixed\";\r\n  input.style.top = `${e.clientY}px`;\r\n  input.style.left = `${e.clientX}px`;\r\n\r\n  input.addEventListener(\"blur\", handleInputBlur);\r\n  input.addEventListener(\"keyup\", handleInputKeyup);\r\n\r\n  document.getElementById(\"content-wrapper\").appendChild(input);\r\n  input.focus();\r\n}\r\n\r\n/**\r\n * Handle input.blur event\r\n */\r\nfunction handleInputBlur() {\r\n  savePoint();\r\n}\r\n\r\n/**\r\n * Handle input.keyup event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleInputKeyup(e) {\r\n  if (e.keyCode === 27) {\r\n    closeInput();\r\n  } else if (e.keyCode === 13) {\r\n    savePoint();\r\n  }\r\n}\r\n\r\n/**\r\n * Save a new point annotation from input\r\n */\r\nfunction savePoint() {\r\n  if (input.value.trim().length > 0) {\r\n    let clientX = parseInt(input.style.left, 10);\r\n    let clientY = parseInt(input.style.top, 10);\r\n    let content = input.value.trim();\r\n    let svg = findSVGAtPoint(clientX, clientY);\r\n    if (!svg) {\r\n      return;\r\n    }\r\n\r\n    let rect = svg.getBoundingClientRect();\r\n    let { documentId, pageNumber } = getMetadata(svg);\r\n    let annotation = Object.assign(\r\n      {\r\n        type: \"point\",\r\n      },\r\n      scaleDown(svg, {\r\n        x: clientX - rect.left,\r\n        y: clientY - rect.top,\r\n      })\r\n    );\r\n\r\n    PDFJSAnnotate.getStoreAdapter()\r\n      .addAnnotation(documentId, pageNumber, annotation)\r\n      .then((annotation) => {\r\n        PDFJSAnnotate.getStoreAdapter().addComment(\r\n          documentId,\r\n          annotation.uuid,\r\n          content\r\n        );\r\n\r\n        appendChild(svg, annotation);\r\n      });\r\n  }\r\n\r\n  closeInput();\r\n}\r\n\r\n/**\r\n * Close the input element\r\n */\r\nfunction closeInput() {\r\n  input.removeEventListener(\"blur\", handleInputBlur);\r\n  input.removeEventListener(\"keyup\", handleInputKeyup);\r\n  document.getElementById(\"content-wrapper\").removeChild(input);\r\n  input = null;\r\n}\r\n\r\n/**\r\n * Enable point annotation behavior\r\n */\r\nexport function enablePoint() {\r\n  if (_enabled) {\r\n    return;\r\n  }\r\n\r\n  _enabled = true;\r\n  document.addEventListener(\"mouseup\", handleDocumentMouseup);\r\n}\r\n\r\n/**\r\n * Disable point annotation behavior\r\n */\r\nexport function disablePoint() {\r\n  if (!_enabled) {\r\n    return;\r\n  }\r\n\r\n  _enabled = false;\r\n  document.removeEventListener(\"mouseup\", handleDocumentMouseup);\r\n}\r\n","import PDFJSAnnotate from \"../PDFJSAnnotate\";\r\nimport appendChild from \"../render/appendChild\";\r\nimport {\r\n  BORDER_COLOR,\r\n  disableUserSelect,\r\n  enableUserSelect,\r\n  findSVGAtPoint,\r\n  getMetadata,\r\n  getOffset,\r\n  scaleDown,\r\n  scaleUp,\r\n} from \"./utils\";\r\n\r\nlet _enabled = false;\r\nlet _type;\r\nlet overlay;\r\nlet originY;\r\nlet originX;\r\n\r\n/**\r\n * Get the current window selection as rects\r\n *\r\n * @return {Array} An Array of rects\r\n */\r\nfunction getSelectionRects() {\r\n  try {\r\n    let selection = window.getSelection();\r\n    let range = selection.getRangeAt(0);\r\n    let rects = range.getClientRects();\r\n\r\n    if (rects.length > 0 && rects[0].width > 0 && rects[0].height > 0) {\r\n      return rects;\r\n    }\r\n  } catch (e) {}\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Handle document.mousedown event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleDocumentMousedown(e) {\r\n  let svg;\r\n  if (_type !== \"area\" || !(svg = findSVGAtPoint(e.clientX, e.clientY))) {\r\n    return;\r\n  }\r\n\r\n  let rect = svg.getBoundingClientRect();\r\n  originY = e.clientY;\r\n  originX = e.clientX;\r\n\r\n  overlay = document.createElement(\"div\");\r\n  overlay.style.position = \"absolute\";\r\n  overlay.style.top = `${originY - rect.top}px`;\r\n  overlay.style.left = `${originX - rect.left}px`;\r\n  overlay.style.border = `3px solid ${BORDER_COLOR}`;\r\n  overlay.style.borderRadius = \"3px\";\r\n  svg.parentNode.appendChild(overlay);\r\n\r\n  document.addEventListener(\"mousemove\", handleDocumentMousemove);\r\n  disableUserSelect();\r\n}\r\n\r\n/**\r\n * Handle document.mousemove event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleDocumentMousemove(e) {\r\n  let svg = overlay.parentNode.querySelector(\"svg.drawingLayer\");\r\n  let rect = svg.getBoundingClientRect();\r\n\r\n  if (originX + (e.clientX - originX) < rect.right) {\r\n    overlay.style.width = `${e.clientX - originX}px`;\r\n  }\r\n\r\n  if (originY + (e.clientY - originY) < rect.bottom) {\r\n    overlay.style.height = `${e.clientY - originY}px`;\r\n  }\r\n}\r\n\r\n/**\r\n * Handle document.mouseup event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleDocumentMouseup(e) {\r\n  let rects;\r\n  let annotation;\r\n\r\n  if (_type !== \"area\" && (rects = getSelectionRects())) {\r\n    let svg = findSVGAtPoint(rects[0].left, rects[0].top);\r\n    annotation = saveRect(\r\n      _type,\r\n      [...rects].map((r) => {\r\n        return {\r\n          top: r.top,\r\n          left: r.left,\r\n          width: r.width,\r\n          height: r.height,\r\n        };\r\n      })\r\n    );\r\n  } else if (_type === \"area\" && overlay) {\r\n    let svg = overlay.parentNode.querySelector(\"svg.drawingLayer\");\r\n    let rect = svg.getBoundingClientRect();\r\n    annotation = saveRect(_type, [\r\n      {\r\n        top: parseInt(overlay.style.top, 10) + rect.top,\r\n        left: parseInt(overlay.style.left, 10) + rect.left,\r\n        width: parseInt(overlay.style.width, 10),\r\n        height: parseInt(overlay.style.height, 10),\r\n      },\r\n    ]);\r\n\r\n    overlay.parentNode.removeChild(overlay);\r\n    overlay = null;\r\n\r\n    document.removeEventListener(\"mousemove\", handleDocumentMousemove);\r\n    enableUserSelect();\r\n  }\r\n\r\n  return annotation;\r\n}\r\n\r\n/**\r\n * Handle document.keyup event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleDocumentKeyup(e) {\r\n  // Cancel rect if Esc is pressed\r\n  if (e.keyCode === 27) {\r\n    let selection = window.getSelection();\r\n    selection.removeAllRanges();\r\n    if (overlay && overlay.parentNode) {\r\n      overlay.parentNode.removeChild(overlay);\r\n      overlay = null;\r\n      document.removeEventListener(\"mousemove\", handleDocumentMousemove);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Save a rect annotation\r\n *\r\n * @param {String} type The type of rect (area, highlight, strikeout)\r\n * @param {Array} rects The rects to use for annotation\r\n * @param {String} color The color of the rects\r\n */\r\nfunction saveRect(type, rects, color) {\r\n  let svg = findSVGAtPoint(rects[0].left, rects[0].top);\r\n  let node;\r\n  let annotation;\r\n\r\n  if (!svg) {\r\n    return;\r\n  }\r\n\r\n  let boundingRect = svg.getBoundingClientRect();\r\n\r\n  if (!color) {\r\n    if (type === \"highlight\") {\r\n      color = \"FFFF00\";\r\n    } else if (type === \"strikeout\") {\r\n      color = \"FF0000\";\r\n    }\r\n  }\r\n\r\n  // Initialize the annotation\r\n  annotation = {\r\n    type,\r\n    color,\r\n    rectangles: [...rects]\r\n      .map((r) => {\r\n        let offset = 0;\r\n\r\n        if (type === \"strikeout\") {\r\n          offset = r.height / 2;\r\n        }\r\n\r\n        return scaleDown(svg, {\r\n          y: r.top + offset - boundingRect.top,\r\n          x: r.left - boundingRect.left,\r\n          width: r.width,\r\n          height: r.height,\r\n        });\r\n      })\r\n      .filter((r) => r.width > 0 && r.height > 0 && r.x > -1 && r.y > -1),\r\n  };\r\n\r\n  // Short circuit if no rectangles exist\r\n  if (annotation.rectangles.length === 0) {\r\n    return;\r\n  }\r\n\r\n  // Special treatment for area as it only supports a single rect\r\n  if (type === \"area\") {\r\n    let rect = annotation.rectangles[0];\r\n    delete annotation.rectangles;\r\n    annotation.x = rect.x;\r\n    annotation.y = rect.y;\r\n    annotation.width = rect.width;\r\n    annotation.height = rect.height;\r\n  }\r\n\r\n  let { documentId, pageNumber } = getMetadata(svg);\r\n\r\n  // Add the annotation\r\n  PDFJSAnnotate.getStoreAdapter()\r\n    .addAnnotation(documentId, pageNumber, annotation)\r\n    .then((newAnnotation) => {\r\n      annotation = newAnnotation;\r\n      appendChild(svg, newAnnotation);\r\n    });\r\n\r\n  return annotation;\r\n}\r\n\r\n/**\r\n * Enable rect behavior\r\n */\r\nexport function enableRect(type) {\r\n  _type = type;\r\n\r\n  if (_enabled) {\r\n    return;\r\n  }\r\n\r\n  _enabled = true;\r\n  document.addEventListener(\"mouseup\", handleDocumentMouseup);\r\n  document.addEventListener(\"mousedown\", handleDocumentMousedown);\r\n  document.addEventListener(\"keyup\", handleDocumentKeyup);\r\n}\r\n\r\n/**\r\n * Disable rect behavior\r\n */\r\nexport function disableRect() {\r\n  if (!_enabled) {\r\n    return;\r\n  }\r\n\r\n  _enabled = false;\r\n  document.removeEventListener(\"mouseup\", handleDocumentMouseup);\r\n  document.removeEventListener(\"mousedown\", handleDocumentMousedown);\r\n  document.removeEventListener(\"keyup\", handleDocumentKeyup);\r\n}\r\n\r\n/**\r\n * Highlight the selected text.\r\n * @param {string} type The type of selection.\r\n * @param {Event} event The event.\r\n */\r\nexport function highlightText(type, event) {\r\n  // Set the tool as enabled and set the type.\r\n  _enabled = true;\r\n  _type = type;\r\n\r\n  // Perform the select.\r\n  let annotation = handleDocumentMouseup(event);\r\n\r\n  // Clear the selected text.\r\n  let selection = window.getSelection();\r\n  selection.removeAllRanges();\r\n  _enabled = false;\r\n\r\n  return annotation;\r\n}\r\n\r\nexport async function editRect(type, annotationId, attributes) {\r\n  const annotation = await PDFJSAnnotate.getStoreAdapter().getAnnotation(\r\n    \"\",\r\n    annotationId\r\n  );\r\n\r\n  annotation.color = attributes.color || annotation.color;\r\n  annotation.stroke = `#${attributes.stroke}`;\r\n  annotation.opacity = attributes.opacity || annotation.opacity;\r\n  annotation.strokeWidth = attributes.strokeWidth || annotation.strokeWidth;\r\n\r\n  PDFJSAnnotate.getStoreAdapter().editAnnotation(\"\", annotationId, annotation);\r\n}\r\n","import PDFJSAnnotate from \"../PDFJSAnnotate\";\r\nimport appendChild from \"../render/appendChild\";\r\nimport { processTextContent } from \"../render/renderText\";\r\nimport { BORDER_COLOR, findSVGAtPoint, getMetadata, scaleDown } from \"./utils\";\r\n\r\nlet _enabled = false;\r\nlet textArea;\r\nlet _textSize;\r\nlet _textColor;\r\n\r\n/**\r\n * Handle document.mouseup event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleDocumentMouseup(e) {\r\n  if (textArea || !findSVGAtPoint(e.clientX, e.clientY)) {\r\n    return;\r\n  }\r\n\r\n  textArea = document.createElement(\"textarea\");\r\n  textArea.setAttribute(\"id\", \"pdf-annotate-text-input\");\r\n  textArea.style.border = `3px solid ${BORDER_COLOR}`;\r\n  textArea.style.borderRadius = \"3px\";\r\n  textArea.style.position = \"fixed\";\r\n  textArea.style.top = `${e.clientY}px`;\r\n  textArea.style.left = `${e.clientX}px`;\r\n  textArea.style.fontSize = `${_textSize}px`;\r\n  textArea.style.background = \"transparent\";\r\n  textArea.style.whiteSpace = \"pre-line\";\r\n\r\n  textArea.addEventListener(\"blur\", handleInputBlur);\r\n  textArea.addEventListener(\"keyup\", handleInputKeyup);\r\n\r\n  document.getElementById(\"content-wrapper\").appendChild(textArea);\r\n  textArea.focus();\r\n}\r\n\r\n/**\r\n * Handle input.blur event\r\n */\r\nfunction handleInputBlur() {\r\n  saveText();\r\n}\r\n\r\n/**\r\n * Handle input.keyup event\r\n *\r\n * @param {Event} e The DOM event to handle\r\n */\r\nfunction handleInputKeyup(e) {\r\n  if (e.keyCode === 27) {\r\n    closeInput();\r\n  }\r\n}\r\n\r\n/**\r\n * Save a text annotation from input\r\n */\r\nfunction saveText() {\r\n  if (textArea.value.trim().length > 0) {\r\n    let clientX = parseInt(textArea.style.left, 10);\r\n    let clientY = parseInt(textArea.style.top, 10);\r\n    let svg = findSVGAtPoint(clientX, clientY);\r\n    if (!svg) {\r\n      return;\r\n    }\r\n\r\n    let { documentId, pageNumber } = getMetadata(svg);\r\n    let rect = svg.getBoundingClientRect();\r\n    let annotation = Object.assign(\r\n      {\r\n        type: \"textbox\",\r\n        size: _textSize,\r\n        color: _textColor,\r\n        content: textArea.value.trim(),\r\n      },\r\n      scaleDown(svg, {\r\n        x: clientX - rect.left,\r\n        y: clientY - rect.top,\r\n        width: textArea.offsetWidth,\r\n        height: textArea.offsetHeight,\r\n      })\r\n    );\r\n\r\n    PDFJSAnnotate.getStoreAdapter()\r\n      .addAnnotation(documentId, pageNumber, annotation)\r\n      .then((annotation) => {\r\n        appendChild(svg, annotation);\r\n        // Create and dispatch an event that can be listened to outside of pdf-annotate.\r\n        let event = new CustomEvent(\"text:saved\", {\r\n          detail: {\r\n            uuid: annotation.uuid,\r\n            content: annotation.content,\r\n          },\r\n        });\r\n        document.dispatchEvent(event);\r\n      });\r\n  }\r\n\r\n  closeInput();\r\n}\r\n\r\n/**\r\n * Close the input\r\n */\r\nfunction closeInput() {\r\n  if (textArea) {\r\n    textArea.removeEventListener(\"blur\", handleInputBlur);\r\n    textArea.removeEventListener(\"keyup\", handleInputKeyup);\r\n    document.getElementById(\"content-wrapper\").removeChild(textArea);\r\n    textArea = null;\r\n\r\n    disableText();\r\n  }\r\n}\r\n\r\n/**\r\n * Set the text attributes\r\n *\r\n * @param {Number} textSize The size of the text\r\n * @param {String} textColor The color of the text\r\n */\r\nexport function setText(textSize = 12, textColor = \"000000\") {\r\n  _textSize = parseInt(textSize, 10);\r\n  _textColor = textColor;\r\n}\r\n\r\n/**\r\n * Enable text behavior\r\n */\r\nexport function enableText() {\r\n  if (_enabled) {\r\n    return;\r\n  }\r\n\r\n  _enabled = true;\r\n  document.addEventListener(\"mouseup\", handleDocumentMouseup);\r\n}\r\n\r\n/**\r\n * Disable text behavior\r\n */\r\nexport function disableText() {\r\n  if (!_enabled) {\r\n    return;\r\n  }\r\n\r\n  _enabled = false;\r\n  document.removeEventListener(\"mouseup\", handleDocumentMouseup);\r\n}\r\n\r\nexport async function openTextInput(e) {\r\n  handleDocumentMouseup(e);\r\n}\r\n\r\n/**\r\n * Edit the text for a text annotation.\r\n * @param {Number} annotationId The annotation id.\r\n * @param {String} newText The new text to set\r\n */\r\nexport async function editText(annotationId, newText) {\r\n  let svg = document.querySelector(\"svg.drawingLayer\");\r\n\r\n  let nodes = document.querySelector(\r\n    `[data-pdf-annotate-id=\"${annotationId}\"]`\r\n  );\r\n\r\n  let { documentId } = getMetadata(svg);\r\n\r\n  let annotation = await PDFJSAnnotate.getStoreAdapter().getAnnotation(\r\n    documentId,\r\n    annotationId\r\n  );\r\n\r\n  annotation.content = newText;\r\n\r\n  nodes.innerHTML = processTextContent(annotation);\r\n\r\n  PDFJSAnnotate.getStoreAdapter().editAnnotation(\r\n    documentId,\r\n    annotationId,\r\n    annotation\r\n  );\r\n}\r\n","import createStyleSheet from \"create-stylesheet\";\r\n\r\nexport const BORDER_COLOR = \"#00BFFF\";\r\n\r\nconst userSelectStyleSheet = createStyleSheet({\r\n  body: {\r\n    \"-webkit-user-select\": \"none\",\r\n    \"-moz-user-select\": \"none\",\r\n    \"-ms-user-select\": \"none\",\r\n    \"user-select\": \"none\",\r\n  },\r\n});\r\nuserSelectStyleSheet.setAttribute(\"data-pdf-annotate-user-select\", \"true\");\r\n\r\n/**\r\n * Find the SVGElement that contains all the annotations for a page\r\n *\r\n * @param {Element} node An annotation within that container\r\n * @return {SVGElement} The container SVG or null if it can't be found\r\n */\r\nexport function findSVGContainer(node) {\r\n  let parentNode = node;\r\n\r\n  while ((parentNode = parentNode.parentNode) && parentNode !== document) {\r\n    if (\r\n      parentNode.nodeName.toUpperCase() === \"SVG\" &&\r\n      parentNode.getAttribute(\"data-pdf-annotate-container\") === \"true\"\r\n    ) {\r\n      return parentNode;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Find an SVGElement container at a given point\r\n *\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @return {SVGElement} The container SVG or null if one can't be found\r\n */\r\nexport function findSVGAtPoint(x, y) {\r\n  let elements = document.querySelectorAll(\r\n    'svg[data-pdf-annotate-container=\"true\"]'\r\n  );\r\n\r\n  for (let i = 0, l = elements.length; i < l; i++) {\r\n    let el = elements[i];\r\n    let rect = el.getBoundingClientRect();\r\n\r\n    if (pointIntersectsRect(x, y, rect)) {\r\n      return el;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Find an Element that represents an annotation at a given point\r\n *\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @return {Element} The annotation element or null if one can't be found\r\n */\r\nexport function findAnnotationAtPoint(x, y) {\r\n  let svg = findSVGAtPoint(x, y);\r\n  if (!svg) {\r\n    return;\r\n  }\r\n  let elements = svg.querySelectorAll(\"[data-pdf-annotate-type]\");\r\n\r\n  // Find a target element within SVG\r\n  for (let i = 0, l = elements.length; i < l; i++) {\r\n    let el = elements[i];\r\n    if (pointIntersectsRect(x, y, getOffsetAnnotationRect(el))) {\r\n      return el;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Determine if a point intersects a rect\r\n *\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @param {Object} rect The points of a rect (likely from getBoundingClientRect)\r\n * @return {Boolean} True if a collision occurs, otherwise false\r\n */\r\nexport function pointIntersectsRect(x, y, rect) {\r\n  return y >= rect.top && y <= rect.bottom && x >= rect.left && x <= rect.right;\r\n}\r\n\r\n/**\r\n * Get the rect of an annotation element accounting for offset.\r\n *\r\n * @param {Element} el The element to get the rect of\r\n * @return {Object} The dimensions of the element\r\n */\r\nexport function getOffsetAnnotationRect(el) {\r\n  let rect = getAnnotationRect(el);\r\n  let { offsetLeft, offsetTop } = getOffset(el);\r\n  return {\r\n    top: rect.top + offsetTop,\r\n    left: rect.left + offsetLeft,\r\n    right: rect.right + offsetLeft,\r\n    bottom: rect.bottom + offsetTop,\r\n  };\r\n}\r\n\r\n/**\r\n * Get the rect of an annotation element.\r\n *\r\n * @param {Element} el The element to get the rect of\r\n * @return {Object} The dimensions of the element\r\n */\r\nexport function getAnnotationRect(el) {\r\n  let h = 0,\r\n    w = 0,\r\n    x = 0,\r\n    y = 0;\r\n  let rect = el.getBoundingClientRect();\r\n  // TODO this should be calculated somehow\r\n  const LINE_OFFSET = 16;\r\n\r\n  switch (el.nodeName.toLowerCase()) {\r\n    case \"path\":\r\n      let minX, maxX, minY, maxY;\r\n\r\n      el.getAttribute(\"d\")\r\n        .replace(/Z/, \"\")\r\n        .split(\"M\")\r\n        .splice(1)\r\n        .forEach((p) => {\r\n          var s = p.split(\" \").map((i) => parseInt(i, 10));\r\n\r\n          if (typeof minX === \"undefined\" || s[0] < minX) {\r\n            minX = s[0];\r\n          }\r\n          if (typeof maxX === \"undefined\" || s[2] > maxX) {\r\n            maxX = s[2];\r\n          }\r\n          if (typeof minY === \"undefined\" || s[1] < minY) {\r\n            minY = s[1];\r\n          }\r\n          if (typeof maxY === \"undefined\" || s[3] > maxY) {\r\n            maxY = s[3];\r\n          }\r\n        });\r\n\r\n      h = maxY - minY;\r\n      w = maxX - minX;\r\n      x = minX;\r\n      y = minY;\r\n      break;\r\n\r\n    case \"line\":\r\n      h =\r\n        parseInt(el.getAttribute(\"y2\"), 10) -\r\n        parseInt(el.getAttribute(\"y1\"), 10);\r\n      w =\r\n        parseInt(el.getAttribute(\"x2\"), 10) -\r\n        parseInt(el.getAttribute(\"x1\"), 10);\r\n      x = parseInt(el.getAttribute(\"x1\"), 10);\r\n      y = parseInt(el.getAttribute(\"y1\"), 10);\r\n\r\n      if (h === 0) {\r\n        h += LINE_OFFSET;\r\n        y -= LINE_OFFSET / 2;\r\n      }\r\n      break;\r\n\r\n    case \"text\":\r\n      h = rect.height;\r\n      w = rect.width;\r\n      x = parseInt(el.getAttribute(\"x\"), 10);\r\n      y = parseInt(el.getAttribute(\"y\"), 10);\r\n      break;\r\n\r\n    case \"g\":\r\n      let { offsetLeft, offsetTop } = getOffset(el);\r\n      h = rect.height;\r\n      w = rect.width;\r\n      x = rect.left - offsetLeft;\r\n      y = rect.top - offsetTop;\r\n\r\n      if (el.getAttribute(\"data-pdf-annotate-type\") === \"strikeout\") {\r\n        h += LINE_OFFSET;\r\n        y -= LINE_OFFSET / 2;\r\n      }\r\n      break;\r\n\r\n    case \"rect\":\r\n    case \"svg\":\r\n      h = parseInt(el.getAttribute(\"height\"), 10);\r\n      w = parseInt(el.getAttribute(\"width\"), 10);\r\n      x = parseInt(el.getAttribute(\"x\"), 10);\r\n      y = parseInt(el.getAttribute(\"y\"), 10);\r\n      break;\r\n  }\r\n\r\n  // Result provides same properties as getBoundingClientRect\r\n  let result = {\r\n    top: y,\r\n    left: x,\r\n    width: w,\r\n    height: h,\r\n    right: x + w,\r\n    bottom: y + h,\r\n  };\r\n\r\n  // For the case of nested SVG (point annotations) and grouped\r\n  // lines or rects no adjustment needs to be made for scale.\r\n  // I assume that the scale is already being handled\r\n  // natively by virtue of the `transform` attribute.\r\n  if (![\"svg\", \"g\"].includes(el.nodeName.toLowerCase())) {\r\n    result = scaleUp(findSVGAtPoint(rect.left, rect.top), result);\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Adjust scale from normalized scale (100%) to rendered scale.\r\n *\r\n * @param {SVGElement} svg The SVG to gather metadata from\r\n * @param {Object} rect A map of numeric values to scale\r\n * @return {Object} A copy of `rect` with values scaled up\r\n */\r\nexport function scaleUp(svg, rect) {\r\n  let result = {};\r\n  let { viewport } = getMetadata(svg);\r\n\r\n  Object.keys(rect).forEach((key) => {\r\n    result[key] = rect[key] * viewport.scale;\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Adjust scale from rendered scale to a normalized scale (100%).\r\n *\r\n * @param {SVGElement} svg The SVG to gather metadata from\r\n * @param {Object} rect A map of numeric values to scale\r\n * @return {Object} A copy of `rect` with values scaled down\r\n */\r\nexport function scaleDown(svg, rect) {\r\n  let result = {};\r\n  let { viewport } = getMetadata(svg);\r\n\r\n  Object.keys(rect).forEach((key) => {\r\n    result[key] = rect[key] / viewport.scale;\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Get the scroll position of an element, accounting for parent elements\r\n *\r\n * @param {Element} el The element to get the scroll position for\r\n * @return {Object} The scrollTop and scrollLeft position\r\n */\r\nexport function getScroll(el) {\r\n  let scrollTop = 0;\r\n  let scrollLeft = 0;\r\n  let parentNode = el;\r\n\r\n  while ((parentNode = parentNode.parentNode) && parentNode !== document) {\r\n    scrollTop += parentNode.scrollTop;\r\n    scrollLeft += parentNode.scrollLeft;\r\n  }\r\n\r\n  return { scrollTop, scrollLeft };\r\n}\r\n\r\n/**\r\n * Get the offset position of an element, accounting for parent elements\r\n *\r\n * @param {Element} el The element to get the offset position for\r\n * @return {Object} The offsetTop and offsetLeft position\r\n */\r\nexport function getOffset(el) {\r\n  let parentNode = el;\r\n\r\n  while ((parentNode = parentNode.parentNode) && parentNode !== document) {\r\n    if (parentNode.nodeName.toUpperCase() === \"SVG\") {\r\n      break;\r\n    }\r\n  }\r\n\r\n  let rect = parentNode.getBoundingClientRect();\r\n\r\n  return { offsetLeft: rect.left, offsetTop: rect.top };\r\n}\r\n\r\n/**\r\n * Disable user ability to select text on page\r\n */\r\nexport function disableUserSelect() {\r\n  if (!userSelectStyleSheet.parentNode) {\r\n    document.head.appendChild(userSelectStyleSheet);\r\n  }\r\n}\r\n\r\n/**\r\n * Enable user ability to select text on page\r\n */\r\nexport function enableUserSelect() {\r\n  if (userSelectStyleSheet.parentNode) {\r\n    userSelectStyleSheet.parentNode.removeChild(userSelectStyleSheet);\r\n  }\r\n}\r\n\r\n/**\r\n * Get the metadata for a SVG container\r\n *\r\n * @param {SVGElement} svg The SVG container to get metadata for\r\n */\r\nexport function getMetadata(svg) {\r\n  return {\r\n    documentId: svg.getAttribute(\"data-pdf-annotate-document\"),\r\n    pageNumber: parseInt(svg.getAttribute(\"data-pdf-annotate-page\"), 10),\r\n    viewport: JSON.parse(svg.getAttribute(\"data-pdf-annotate-viewport\")),\r\n  };\r\n}\r\n","/**\r\n * Create a node that is only visible to screen readers\r\n *\r\n * @param {String} content The text content that should be read by screen reader\r\n * @param {String} [annotationId] The ID of the annotation assocaited\r\n * @return {Element} An Element that is only visible to screen readers\r\n */\r\nexport default function createScreenReaderOnly(content, annotationId) {\r\n  let node = document.createElement('div');\r\n  let text = document.createTextNode(content);\r\n  node.appendChild(text);\r\n  node.setAttribute('id', `pdf-annotate-screenreader-${annotationId}`);\r\n  node.style.position = 'absolute';\r\n  node.style.left = '-10000px';\r\n  node.style.top = 'auto';\r\n  node.style.width = '1px';\r\n  node.style.height = '1px';\r\n  node.style.overflow = 'hidden';\r\n  return node;\r\n}\r\n","import insertScreenReaderHint from './insertScreenReaderHint';\r\nimport renderScreenReaderHints from './renderScreenReaderHints';\r\nimport insertScreenReaderComment from './insertScreenReaderComment';\r\nimport renderScreenReaderComments from './renderScreenReaderComments';\r\nimport { addEventListener } from '../UI/event';\r\nimport PDFJSAnnotate from '../PDFJSAnnotate';\r\n\r\n/**\r\n * Initialize the event handlers for keeping screen reader hints synced with data\r\n */\r\nexport default function initEventHandlers() {\r\n  addEventListener('annotation:add', (documentId, pageNumber, annotation) => {\r\n    reorderAnnotationsByType(documentId, pageNumber, annotation.type);\r\n  });\r\n  addEventListener('annotation:edit', (documentId, annotationId, annotation) => {\r\n    reorderAnnotationsByType(documentId, annotation.page, annotation.type);\r\n  });\r\n  addEventListener('annotation:delete', removeAnnotation);\r\n  addEventListener('comment:add', insertComment);\r\n  addEventListener('comment:delete', removeComment);\r\n}\r\n\r\n/**\r\n * Reorder the annotation numbers by annotation type\r\n *\r\n * @param {String} documentId The ID of the document\r\n * @param {Number} pageNumber The page number of the annotations\r\n * @param {Strig} type The annotation type\r\n */\r\nfunction reorderAnnotationsByType(documentId, pageNumber, type) {\r\n  PDFJSAnnotate.getStoreAdapter().getAnnotations(documentId, pageNumber)\r\n    .then((annotations) => {\r\n      return annotations.annotations.filter((a) => {\r\n        return a.type === type;\r\n      });\r\n    })\r\n    .then((annotations) => {\r\n      annotations.forEach((a) => {\r\n        removeAnnotation(documentId, a.uuid);\r\n      });\r\n\r\n      return annotations;\r\n    })\r\n    .then(renderScreenReaderHints);\r\n}\r\n\r\n/**\r\n * Remove the screen reader hint for an annotation\r\n *\r\n * @param {String} documentId The ID of the document\r\n * @param {String} annotationId The Id of the annotation\r\n */\r\nfunction removeAnnotation(documentId, annotationId) {\r\n  removeElementById(`pdf-annotate-screenreader-${annotationId}`);\r\n  removeElementById(`pdf-annotate-screenreader-${annotationId}-end`);\r\n}\r\n\r\n/**\r\n * Insert a screen reader hint for a comment\r\n *\r\n * @param {String} documentId The ID of the document\r\n * @param {String} annotationId The ID of tha assocated annotation\r\n * @param {Object} comment The comment to insert a hint for\r\n */\r\nfunction insertComment(documentId, annotationId, comment) {\r\n  let list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\r\n  let promise;\r\n\r\n  if (!list) {\r\n    promise = renderScreenReaderComments(documentId, annotationId, []).then(() => {\r\n      list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\r\n      return true;\r\n    });\r\n  } else {\r\n    promise = Promise.resolve(true);\r\n  }\r\n\r\n  promise.then(() => {\r\n    insertScreenReaderComment(comment);\r\n  });\r\n}\r\n\r\n/**\r\n * Remove a screen reader hint for a comment\r\n *\r\n * @param {String} documentId The ID of the document\r\n * @param {String} commentId The ID of the comment\r\n */\r\nfunction removeComment(documentId, commentId) {\r\n  removeElementById(`pdf-annotate-screenreader-comment-${commentId}`);\r\n}\r\n\r\n/**\r\n * Remove an element from the DOM by it's ID if it exists\r\n *\r\n * @param {String} elementID The ID of the element to be removed\r\n */\r\nfunction removeElementById(elementId) {\r\n  let el = document.getElementById(elementId);\r\n  if (el) {\r\n    el.parentNode.removeChild(el);\r\n  }\r\n}\r\n","import insertElementWithinElement from './insertElementWithinElement';\r\nimport { pointIntersectsRect } from '../UI/utils';\r\nimport { scaleUp } from '../UI/utils'; \r\n\r\n/**\r\n * Insert an element at a point within the document.\r\n * This algorithm will try to insert between elements if possible.\r\n * It will however use `insertElementWithinElement` if it is more accurate.\r\n *\r\n * @param {Element} el The element to be inserted\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @param {Number} pageNumber The page number to limit elements to\r\n * @return {Boolean} True if element was able to be inserted, otherwise false\r\n */\r\nexport default function insertElementWithinChildren(el, x, y, pageNumber) {\r\n  // Try and use most accurate method of inserting within an element\r\n  if (insertElementWithinElement(el, x, y, pageNumber, true)) {\r\n    return true;\r\n  }\r\n\r\n  // Fall back to inserting between elements\r\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\r\n  let rect = svg.getBoundingClientRect();\r\n  let nodes = [...svg.parentNode.querySelectorAll('.textLayer > div')];\r\n\r\n  y = scaleUp(svg, {y}).y + rect.top;\r\n  x = scaleUp(svg, {x}).x + rect.left;\r\n\r\n  // Find the best node to insert before\r\n  for (let i=0, l=nodes.length; i<l; i++) {\r\n    let n = nodes[i];\r\n    let r = n.getBoundingClientRect();\r\n    if (y <= r.top) {\r\n      n.parentNode.insertBefore(el, n);\r\n      return true;\r\n    }\r\n  }\r\n\r\n  // If all else fails try to append to the bottom\r\n  let textLayer = svg.parentNode.querySelector('.textLayer');\r\n  if (textLayer) {\r\n    let textRect = textLayer.getBoundingClientRect();\r\n    if (pointIntersectsRect(x, y, textRect)) {\r\n      textLayer.appendChild(el);\r\n      return true;\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n","import {\r\n  pointIntersectsRect,\r\n  scaleUp,\r\n  scaleDown\r\n} from '../UI/utils'; \r\n\r\n/**\r\n * Insert an element at a point within the document.\r\n * This algorithm will only insert within an element amidst it's text content.\r\n *\r\n * @param {Element} el The element to be inserted\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @param {Number} pageNumber The page number to limit elements to\r\n * @param {Boolean} insertBefore Whether the element is to be inserted before or after x\r\n * @return {Boolean} True if element was able to be inserted, otherwise false\r\n */\r\nexport default function insertElementWithinElement(el, x, y, pageNumber, insertBefore) {\r\n  const OFFSET_ADJUST = 2;\r\n\r\n  // If inserting before adjust `x` by looking for element a few px to the right\r\n  // Otherwise adjust a few px to the left\r\n  // This is to allow a little tolerance by searching within the box, instead\r\n  // of getting a false negative by testing right on the border.\r\n  x = Math.max(x + (OFFSET_ADJUST * (insertBefore ? 1 : -1)), 0);\r\n\r\n  let node = textLayerElementFromPoint(x, y + OFFSET_ADJUST, pageNumber);\r\n  if (!node) {\r\n    return false;\r\n  }\r\n  \r\n  // Now that node has been found inverse the adjustment for `x`.\r\n  // This is done to accomodate tolerance by cutting off on the outside of the\r\n  // text boundary, instead of missing a character by cutting off within.\r\n  x = x + (OFFSET_ADJUST * (insertBefore ? -1 : 1));\r\n\r\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\r\n  let left = scaleDown(svg, {left: node.getBoundingClientRect().left}).left - svg.getBoundingClientRect().left;\r\n  let temp = node.cloneNode(true);\r\n  let head = temp.innerHTML.split('');\r\n  let tail = [];\r\n\r\n  // Insert temp off screen\r\n  temp.style.position = 'absolute';\r\n  temp.style.top = '-10000px';\r\n  temp.style.left = '-10000px';\r\n  document.body.appendChild(temp);\r\n\r\n  while (head.length) {\r\n    // Don't insert within HTML tags\r\n    if (head[head.length - 1] === '>') {\r\n      while(head.length) {\r\n        tail.unshift(head.pop());\r\n        if (tail[0] === '<') {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Check if width of temp based on current head value satisfies x\r\n    temp.innerHTML = head.join('');\r\n    let width = scaleDown(svg, {width: temp.getBoundingClientRect().width}).width;\r\n    if (left + width <= x) {\r\n      break;\r\n    }\r\n    tail.unshift(head.pop());\r\n  }\r\n  \r\n  // Update original node with new markup, including element to be inserted\r\n  node.innerHTML = head.join('') + el.outerHTML + tail.join('');\r\n  temp.parentNode.removeChild(temp);\r\n\r\n  return true;\r\n}\r\n\r\n/**\r\n * Get a text layer element at a given point on a page\r\n *\r\n * @param {Number} x The x coordinate of the point\r\n * @param {Number} y The y coordinate of the point\r\n * @param {Number} pageNumber The page to limit elements to\r\n * @return {Element} First text layer element found at the point\r\n */\r\nfunction textLayerElementFromPoint(x, y, pageNumber) {\r\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\r\n  let rect = svg.getBoundingClientRect();\r\n  y = scaleUp(svg, {y}).y + rect.top;\r\n  x = scaleUp(svg, {x}).x + rect.left;\r\n  return [...svg.parentNode.querySelectorAll('.textLayer [data-canvas-width]')].filter((el) => {\r\n    return pointIntersectsRect(x, y, el.getBoundingClientRect());\r\n  })[0];\r\n}\r\n","/**\r\n * Insert a comment into the DOM to be available by screen reader\r\n *\r\n * @param {Object} comment The comment to be inserted\r\n */\r\nexport default function insertScreenReaderComment(comment) {\r\n  if (!comment) {\r\n    return;\r\n  }\r\n\r\n  let list = document.querySelector(`#pdf-annotate-screenreader-${comment.annotation} ol`);\r\n  if (list) {\r\n    let item = document.createElement('li');\r\n    item.setAttribute('id', `pdf-annotate-screenreader-comment-${comment.uuid}`);\r\n    item.appendChild(document.createTextNode(`${comment.content}`));\r\n    list.appendChild(item);\r\n  }\r\n}\r\n","import createScreenReaderOnly from './createScreenReaderOnly';\r\nimport insertElementWithinChildren from './insertElementWithinChildren';\r\nimport insertElementWithinElement from './insertElementWithinElement';\r\nimport renderScreenReaderComments from './renderScreenReaderComments';\r\n\r\n// Annotation types that support comments\r\nconst COMMENT_TYPES = ['highlight', 'point', 'area'];\r\n\r\n/**\r\n * Insert a hint into the DOM for screen readers for a specific annotation.\r\n *\r\n * @param {Object} annotation The annotation to insert a hint for\r\n * @param {Number} num The number of the annotation out of all annotations of the same type\r\n */\r\nexport default function insertScreenReaderHint(annotation, num = 0) {\r\n  switch (annotation.type) {\r\n    case 'highlight':\r\n    case 'strikeout':\r\n      let rects = annotation.rectangles;\r\n      let first = rects[0];\r\n      let last = rects[rects.length - 1];\r\n\r\n      insertElementWithinElement(\r\n        createScreenReaderOnly(`Begin ${annotation.type} annotation ${num}`, annotation.uuid),\r\n        first.x, first.y, annotation.page, true\r\n      );\r\n\r\n      insertElementWithinElement(\r\n        createScreenReaderOnly(`End ${annotation.type} annotation ${num}`, `${annotation.uuid}-end`),\r\n        last.x + last.width, last.y, annotation.page, false\r\n      );\r\n      break;\r\n\r\n    case 'textbox':\r\n    case 'point':\r\n      let text = annotation.type === 'textbox' ? ` (content: ${annotation.content})` : '';\r\n\r\n      insertElementWithinChildren(\r\n        createScreenReaderOnly(`${annotation.type} annotation ${num}${text}`, annotation.uuid),\r\n        annotation.x, annotation.y, annotation.page\r\n      );\r\n      break;\r\n\r\n    case 'drawing':\r\n    case 'area':\r\n      let x = typeof annotation.x !== 'undefined' ? annotation.x : annotation.lines[0][0];\r\n      let y = typeof annotation.y !== 'undefined' ? annotation.y : annotation.lines[0][1];\r\n\r\n      insertElementWithinChildren(\r\n        createScreenReaderOnly(`Unlabeled drawing`, annotation.uuid),\r\n        x, y, annotation.page\r\n      );\r\n      break;\r\n  }\r\n\r\n  // Include comments in screen reader hint\r\n  if (COMMENT_TYPES.includes(annotation.type)) {\r\n    renderScreenReaderComments(annotation.documentId, annotation.uuid);\r\n  }\r\n}\r\n","import PDFJSAnnotate from '../PDFJSAnnotate';\r\nimport insertScreenReaderComment from './insertScreenReaderComment';\r\n\r\n/**\r\n * Insert the comments into the DOM to be available by screen reader\r\n *\r\n * Example output:\r\n *   <div class=\"screenReaderOnly\">\r\n *    <div>Begin highlight 1</div>\r\n *    <ol aria-label=\"Comments\">\r\n *      <li>Foo</li>\r\n *      <li>Bar</li>\r\n *      <li>Baz</li>\r\n *      <li>Qux</li>\r\n *    </ol>\r\n *  </div>\r\n *  <div>Some highlighted text goes here...</div>\r\n *  <div class=\"screenReaderOnly\">End highlight 1</div>\r\n *\r\n * NOTE: `screenReaderOnly` is not a real class, just used for brevity\r\n *\r\n * @param {String} documentId The ID of the document\r\n * @param {String} annotationId The ID of the annotation\r\n * @param {Array} [comments] Optionally preloaded comments to be rendered\r\n * @return {Promise}\r\n */\r\nexport default function renderScreenReaderComments(documentId, annotationId, comments) {\r\n  let promise;\r\n\r\n  if (Array.isArray(comments)) {\r\n    promise = Promise.resolve(comments);\r\n  } else {\r\n    promise = PDFJSAnnotate.getStoreAdapter().getComments(documentId, annotationId);\r\n  }\r\n\r\n  return promise.then((comments) => {\r\n    // Node needs to be found by querying DOM as it may have been inserted as innerHTML\r\n    // leaving `screenReaderNode` as an invalid reference (see `insertElementWithinElement`).\r\n    let node = document.getElementById(`pdf-annotate-screenreader-${annotationId}`);\r\n    if (node) { \r\n      let list = document.createElement('ol');\r\n      list.setAttribute('id', `pdf-annotate-screenreader-comment-list-${annotationId}`);\r\n      list.setAttribute('aria-label', 'Comments');\r\n      node.appendChild(list);\r\n      comments.forEach(insertScreenReaderComment);\r\n    }\r\n  });\r\n}\r\n","import insertScreenReaderHint from './insertScreenReaderHint';\r\nimport initEventHandlers from './initEventHandlers';\r\n\r\n// TODO This is not the right place for this to live\r\ninitEventHandlers();\r\n\r\n/**\r\n * Insert hints into the DOM for screen readers.\r\n *\r\n * @param {Array} annotations The annotations that hints are inserted for\r\n */\r\nexport default function renderScreenReaderHints(annotations) {\r\n  annotations = Array.isArray(annotations) ? annotations : [];\r\n\r\n  // Insert hints for each type\r\n  Object.keys(SORT_TYPES).forEach((type) => {\r\n    let sortBy = SORT_TYPES[type];\r\n    annotations\r\n      .filter((a) => a.type === type)\r\n      .sort(sortBy)\r\n      .forEach((a, i) => insertScreenReaderHint(a, i + 1));\r\n  });\r\n}\r\n\r\n// Sort annotations first by y, then by x.\r\n// This allows hints to be injected in the order they appear,\r\n// which makes numbering them easier.\r\nfunction sortByPoint(a, b) {\r\n  if (a.y < b.y) {\r\n    return a.x - b.x;\r\n  } else {\r\n    return 1;\r\n  }\r\n}\r\n\r\n// Sort annotation by it's first rectangle\r\nfunction sortByRectPoint(a, b) {\r\n  return sortByPoint(a.rectangles[0], b.rectangles[0]);\r\n}\r\n\r\n// Sort annotation by it's first line\r\nfunction sortByLinePoint(a, b) {\r\n  let lineA = a.lines[0];\r\n  let lineB = b.lines[0];\r\n  return sortByPoint(\r\n    {x: lineA[0], y: lineA[1]},\r\n    {x: lineB[0], y: lineB[1]}\r\n  );\r\n}\r\n\r\n// Arrange supported types and associated sort methods\r\nconst SORT_TYPES = {\r\n  'highlight': sortByRectPoint,\r\n  'strikeout': sortByRectPoint,\r\n  'drawing': sortByLinePoint,\r\n  'textbox': sortByPoint,\r\n  'point': sortByPoint,\r\n  'area': sortByPoint\r\n};\r\n\r\n","import uuid from '../utils/uuid';\r\nimport StoreAdapter from './StoreAdapter';\r\n\r\n// StoreAdapter for working with localStorage\r\n// This is ideal for testing, examples, and prototyping\r\nexport default class LocalStoreAdapter extends StoreAdapter {\r\n  constructor() {\r\n    super({\r\n      getAnnotations(documentId, pageNumber) {\r\n        return new Promise((resolve, reject) => {\r\n          let annotations = getAnnotations(documentId).filter((i) => {\r\n            return i.page === pageNumber && i.class === 'Annotation';\r\n          });\r\n\r\n          resolve({\r\n            documentId,\r\n            pageNumber,\r\n            annotations\r\n          });\r\n        });\r\n      },\r\n\r\n      getAnnotation(documentId, annotationId) {\r\n        return Promise.resolve(getAnnotations(documentId)[findAnnotation(documentId, annotationId)]);\r\n      },\r\n\r\n      addAnnotation(documentId, pageNumber, annotation) {\r\n        return new Promise((resolve, reject) => {\r\n          annotation.class = 'Annotation';\r\n          annotation.uuid = uuid();\r\n          annotation.page = pageNumber;\r\n\r\n          let annotations = getAnnotations(documentId);\r\n          annotations.push(annotation);\r\n          updateAnnotations(documentId, annotations);\r\n\r\n          resolve(annotation);\r\n        });\r\n      },\r\n\r\n      editAnnotation(documentId, annotationId, annotation) {\r\n        return new Promise((resolve, reject) => {\r\n          let annotations = getAnnotations(documentId);\r\n          annotations[findAnnotation(documentId, annotationId)] = annotation;\r\n          updateAnnotations(documentId, annotations);\r\n\r\n          resolve(annotation);\r\n        });\r\n      },\r\n\r\n      deleteAnnotation(documentId, annotationId) {\r\n        return new Promise((resolve, reject) => {\r\n          let index = findAnnotation(documentId, annotationId);\r\n          if (index > -1) {\r\n            let annotations = getAnnotations(documentId);\r\n            annotations.splice(index, 1);\r\n            updateAnnotations(documentId, annotations);\r\n          }\r\n\r\n          resolve(true);\r\n        });\r\n      },\r\n\r\n      getComments(documentId, annotationId) {\r\n        return new Promise((resolve, reject) => {\r\n          resolve(getAnnotations(documentId).filter((i) => {\r\n            return i.class === 'Comment' && i.annotation === annotationId;\r\n          }));\r\n        });\r\n      },\r\n\r\n      addComment(documentId, annotationId, content) {\r\n        return new Promise((resolve, reject) => {\r\n          let comment = {\r\n            class: 'Comment',\r\n            uuid: uuid(),\r\n            annotation: annotationId,\r\n            content: content\r\n          };\r\n\r\n          let annotations = getAnnotations(documentId);\r\n          annotations.push(comment);\r\n          updateAnnotations(documentId, annotations);\r\n\r\n          resolve(comment);\r\n        });\r\n      },\r\n\r\n      deleteComment(documentId, commentId) {\r\n        return new Promise((resolve, reject) => {\r\n          getAnnotations(documentId);\r\n          let index = -1;\r\n          let annotations = getAnnotations(documentId);\r\n          for (let i=0, l=annotations.length; i<l; i++) {\r\n            if (annotations[i].uuid === commentId) {\r\n              index = i;\r\n              break;\r\n            }\r\n          }\r\n\r\n          if (index > -1) {\r\n            annotations.splice(index, 1);\r\n            updateAnnotations(documentId, annotations);\r\n          }\r\n\r\n          resolve(true);\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction getAnnotations(documentId) {\r\n  return JSON.parse(localStorage.getItem(`${documentId}/annotations`)) || [];\r\n}\r\n\r\nfunction updateAnnotations(documentId, annotations) {\r\n  localStorage.setItem(`${documentId}/annotations`, JSON.stringify(annotations));\r\n}\r\n\r\nfunction findAnnotation(documentId, annotationId) {\r\n  let index = -1;\r\n  let annotations = getAnnotations(documentId);\r\n  for (let i=0, l=annotations.length; i<l; i++) {\r\n    if (annotations[i].uuid === annotationId) {\r\n      index = i;\r\n      break;\r\n    }\r\n  }\r\n  return index;\r\n}\r\n","import abstractFunction from '../utils/abstractFunction';\r\nimport { fireEvent } from '../UI/event';\r\n\r\n// Adapter should never be invoked publicly\r\nexport default class StoreAdapter {\r\n  /**\r\n   * Create a new StoreAdapter instance\r\n   *\r\n   * @param {Object} [definition] The definition to use for overriding abstract methods\r\n   */\r\n  constructor(definition = {}) {\r\n    // Copy each function from definition if it is a function we know about\r\n    Object.keys(definition).forEach((key) => {\r\n      if (typeof definition[key] === 'function' &&\r\n          typeof this[key] === 'function') {\r\n        this[key] = definition[key];\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get all the annotations for a given document and page number.\r\n   *\r\n   * @param {String} documentId The ID for the document the annotations belong to\r\n   * @param {Number} pageNumber The number of the page the annotations belong to\r\n   * @return {Promise}\r\n   */\r\n  __getAnnotations(documentId, pageNumber) { abstractFunction('getAnnotations'); }\r\n  get getAnnotations() { return this.__getAnnotations; }\r\n  set getAnnotations(fn) {\r\n    this.__getAnnotations = function getAnnotations(documentId, pageNumber) {\r\n      return fn(...arguments).then((annotations) => {\r\n        // TODO may be best to have this happen on the server\r\n        if (annotations.annotations) {\r\n          annotations.annotations.forEach((a) => {\r\n            a.documentId = documentId;\r\n          });\r\n        }\r\n        return annotations;\r\n      });\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get the definition for a specific annotation.\r\n   *\r\n   * @param {String} documentId The ID for the document the annotation belongs to\r\n   * @param {String} annotationId The ID for the annotation\r\n   * @return {Promise}\r\n   */\r\n  getAnnotation(documentId, annotationId) { abstractFunction('getAnnotation'); }\r\n\r\n  /**\r\n   * Add an annotation\r\n   *\r\n   * @param {String} documentId The ID for the document to add the annotation to\r\n   * @param {String} pageNumber The page number to add the annotation to\r\n   * @param {Object} annotation The definition for the new annotation\r\n   * @return {Promise}\r\n   */\r\n  __addAnnotation(documentId, pageNumber, annotation) { abstractFunction('addAnnotation'); }\r\n  get addAnnotation() { return this.__addAnnotation; }\r\n  set addAnnotation(fn) {\r\n    this.__addAnnotation = function addAnnotation(documentId, pageNumber, annotation) {\r\n      return fn(...arguments).then((annotation) => {\r\n        fireEvent('annotation:add', documentId, pageNumber, annotation);\r\n        return annotation;\r\n      });\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Edit an annotation\r\n   *\r\n   * @param {String} documentId The ID for the document\r\n   * @param {String} pageNumber the page number of the annotation\r\n   * @param {Object} annotation The definition of the modified annotation\r\n   * @return {Promise}\r\n   */\r\n  __editAnnotation(documentId, pageNumber, annotation) { abstractFunction('editAnnotation'); }\r\n  get editAnnotation() { return this.__editAnnotation; }\r\n  set editAnnotation(fn) {\r\n    this.__editAnnotation = function editAnnotation(documentId, annotationId, annotation) {\r\n      return fn(...arguments).then((annotation) => {\r\n        fireEvent('annotation:edit', documentId, annotationId, annotation);\r\n        return annotation;\r\n      });\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Delete an annotation\r\n   *\r\n   * @param {String} documentId The ID for the document\r\n   * @param {String} annotationId The ID for the annotation\r\n   * @return {Promise}\r\n   */\r\n  __deleteAnnotation(documentId, annotationId) { abstractFunction('deleteAnnotation'); }\r\n  get deleteAnnotation() { return this.__deleteAnnotation; }\r\n  set deleteAnnotation(fn) {\r\n    this.__deleteAnnotation = function deleteAnnotation(documentId, annotationId) {\r\n      return fn(...arguments).then((success) => {\r\n        if (success) {\r\n          fireEvent('annotation:delete', documentId, annotationId);\r\n        }\r\n        return success;\r\n      });\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get all the comments for an annotation\r\n   *\r\n   * @param {String} documentId The ID for the document\r\n   * @param {String} annotationId The ID for the annotation\r\n   * @return {Promise}\r\n   */\r\n  getComments(documentId, annotationId) { abstractFunction('getComments'); }\r\n\r\n  /**\r\n   * Add a new comment\r\n   *\r\n   * @param {String} documentId The ID for the document\r\n   * @param {String} annotationId The ID for the annotation\r\n   * @param {Object} content The definition of the comment\r\n   * @return {Promise}\r\n   */\r\n  __addComment(documentId, annotationId, content) { abstractFunction('addComment'); }\r\n  get addComment() { return this.__addComment; }\r\n  set addComment(fn) {\r\n    this.__addComment = function addComment(documentId, annotationId, content) {\r\n      return fn(...arguments).then((comment) => {\r\n        fireEvent('comment:add', documentId, annotationId, comment);\r\n        return comment;\r\n      });\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Delete a comment\r\n   *\r\n   * @param {String} documentId The ID for the document\r\n   * @param {String} commentId The ID for the comment\r\n   * @return {Promise}\r\n   */\r\n  __deleteComment(documentId, commentId) { abstractFunction('deleteComment'); }\r\n  get deleteComment() { return this.__deleteComment; }\r\n  set deleteComment(fn) {\r\n    this.__deleteComment = function deleteComment(documentId, commentId) {\r\n      return fn(...arguments).then((success) => {\r\n        if (success) {\r\n          fireEvent('comment:delete', documentId, commentId);\r\n        }\r\n        return success;\r\n      });\r\n    };\r\n  }\r\n}\r\n","import objectAssign from 'object-assign';\r\nimport renderLine from './renderLine';\r\nimport renderPath from './renderPath';\r\nimport renderPoint from './renderPoint';\r\nimport renderRect from './renderRect';\r\nimport renderText from './renderText';\r\n\r\nconst isFirefox = /firefox/i.test(navigator.userAgent);\r\n\r\n/**\r\n * Get the x/y translation to be used for transforming the annotations\r\n * based on the rotation of the viewport.\r\n *\r\n * @param {Object} viewport The viewport data from the page\r\n * @return {Object}\r\n */\r\nfunction getTranslation(viewport) {\r\n  let x;\r\n  let y;\r\n\r\n  // Modulus 360 on the rotation so that we only\r\n  // have to worry about four possible values.\r\n  switch(viewport.rotation % 360) {\r\n    case 0:\r\n      x = y = 0;\r\n      break;\r\n    case 90:\r\n      x = 0;\r\n      y = (viewport.width / viewport.scale) * -1;\r\n      break;\r\n    case 180:\r\n      x = (viewport.width / viewport.scale) * -1;\r\n      y = (viewport.height / viewport.scale) * -1;\r\n      break;\r\n    case 270:\r\n      x = (viewport.height / viewport.scale) * -1;\r\n      y = 0;\r\n      break;\r\n  }\r\n\r\n  return { x, y };\r\n}\r\n\r\n/**\r\n * Transform the rotation and scale of a node using SVG's native transform attribute.\r\n *\r\n * @param {Node} node The node to be transformed\r\n * @param {Object} viewport The page's viewport data\r\n * @return {Node}\r\n */\r\nfunction transform(node, viewport) {\r\n  let trans = getTranslation(viewport);\r\n\r\n  // Let SVG natively transform the element\r\n  node.setAttribute('transform', `scale(${viewport.scale}) rotate(${viewport.rotation}) translate(${trans.x}, ${trans.y})`);\r\n  \r\n  // Manually adjust x/y for nested SVG nodes\r\n  if (!isFirefox && node.nodeName.toLowerCase() === 'svg') {\r\n    node.setAttribute('x', parseInt(node.getAttribute('x'), 10) * viewport.scale);\r\n    node.setAttribute('y', parseInt(node.getAttribute('y'), 10) * viewport.scale);\r\n\r\n    let x = parseInt(node.getAttribute('x', 10));\r\n    let y = parseInt(node.getAttribute('y', 10));\r\n    let width = parseInt(node.getAttribute('width'), 10);\r\n    let height = parseInt(node.getAttribute('height'), 10);\r\n    let path = node.querySelector('path');\r\n    let svg = path.parentNode;\r\n   \r\n    // Scale width/height\r\n    [node, svg, path, node.querySelector('rect')].forEach((n) => {\r\n      n.setAttribute('width', parseInt(n.getAttribute('width'), 10) * viewport.scale);\r\n      n.setAttribute('height', parseInt(n.getAttribute('height'), 10) * viewport.scale);\r\n    });\r\n\r\n    // Transform path but keep scale at 100% since it will be handled natively\r\n    transform(path, objectAssign({}, viewport, { scale: 1 }));\r\n    \r\n    switch(viewport.rotation % 360) {\r\n      case 90:\r\n        node.setAttribute('x', viewport.width - y - width);\r\n        node.setAttribute('y', x);\r\n        svg.setAttribute('x', 1);\r\n        svg.setAttribute('y', 0);\r\n        break;\r\n      case 180:\r\n        node.setAttribute('x', viewport.width - x - width);\r\n        node.setAttribute('y', viewport.height - y - height);\r\n        svg.setAttribute('y', 2);\r\n        break;\r\n      case 270:\r\n        node.setAttribute('x', y);\r\n        node.setAttribute('y', viewport.height - x - height);\r\n        svg.setAttribute('x', -1);\r\n        svg.setAttribute('y', 0);\r\n        break;\r\n    }\r\n  }\r\n\r\n  return node;\r\n}\r\n\r\n/**\r\n * Append an annotation as a child of an SVG.\r\n *\r\n * @param {SVGElement} svg The SVG element to append the annotation to\r\n * @param {Object} annotation The annotation definition to render and append\r\n * @param {Object} viewport The page's viewport data\r\n * @return {SVGElement} A node that was created and appended by this function\r\n */\r\nexport default function appendChild(svg, annotation, viewport) {\r\n  if (!viewport) {\r\n    viewport = JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'));\r\n  }\r\n  \r\n  let child;\r\n  switch (annotation.type) {\r\n    case 'area':\r\n    case 'highlight':\r\n      child = renderRect(annotation);\r\n      break;\r\n    case 'strikeout':\r\n      child = renderLine(annotation);\r\n      break;\r\n    case 'point':\r\n      child = renderPoint(annotation);\r\n      break;\r\n    case 'textbox':\r\n      child = renderText(annotation);\r\n      break;\r\n    case 'drawing':\r\n      child = renderPath(annotation);\r\n      break;\r\n  }\r\n\r\n  // If no type was provided for an annotation it will result in node being null.\r\n  // Skip appending/transforming if node doesn't exist.\r\n  if (child) {\r\n    // Set attributes\r\n    child.setAttribute('data-pdf-annotate-id', annotation.uuid);\r\n    child.setAttribute('data-pdf-annotate-type', annotation.type);\r\n    child.setAttribute('aria-hidden', true);\r\n\r\n    svg.appendChild(transform(child, viewport));\r\n  }\r\n\r\n  return child;\r\n}\r\n","import PDFJSAnnotate from '../PDFJSAnnotate';\r\nimport appendChild from './appendChild';\r\nimport renderScreenReaderHints from '../a11y/renderScreenReaderHints';\r\n\r\n/**\r\n * Render the response from PDFJSAnnotate.getStoreAdapter().getAnnotations to SVG\r\n *\r\n * @param {SVGElement} svg The SVG element to render the annotations to\r\n * @param {Object} viewport The page viewport data\r\n * @param {Object} data The response from PDFJSAnnotate.getStoreAdapter().getAnnotations\r\n * @return {Promise} Settled once rendering has completed\r\n *  A settled Promise will be either:\r\n *    - fulfilled: SVGElement\r\n *    - rejected: Error\r\n */\r\nexport default function render(svg, viewport, data) {\r\n  return new Promise((resolve, reject) => {\r\n    // Reset the content of the SVG\r\n    svg.innerHTML = ''; \r\n    svg.setAttribute('data-pdf-annotate-container', true);\r\n    svg.setAttribute('data-pdf-annotate-viewport', JSON.stringify(viewport));\r\n    svg.removeAttribute('data-pdf-annotate-document');\r\n    svg.removeAttribute('data-pdf-annotate-page');\r\n\r\n    // If there's no data nothing can be done\r\n    if (!data) {\r\n      return resolve(svg);\r\n    }\r\n\r\n    svg.setAttribute('data-pdf-annotate-document', data.documentId);\r\n    svg.setAttribute('data-pdf-annotate-page', data.pageNumber);\r\n  \r\n    // Make sure annotations is an array\r\n    if (!Array.isArray(data.annotations) || data.annotations.length === 0) {\r\n      return resolve(svg);\r\n    }\r\n\r\n    // Append annotation to svg\r\n    data.annotations.forEach((a) => {\r\n      appendChild(svg, a, viewport);\r\n    });\r\n\r\n    resolve(svg);\r\n  });\r\n}\r\n","import setAttributes from \"../utils/setAttributes\";\r\nimport normalizeColor from \"../utils/normalizeColor\";\r\n\r\n/**\r\n * Create SVGLineElements from an annotation definition.\r\n * This is used for anntations of type `strikeout`.\r\n *\r\n * @param {Object} a The annotation definition\r\n * @return {SVGGElement} A group of all lines to be rendered\r\n */\r\nexport default function renderLine(a) {\r\n  let group = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\r\n  setAttributes(group, {\r\n    stroke: normalizeColor(a.color || \"#f00\"),\r\n    strokeWidth: a.strokeWidth || 1,\r\n    opacity: a.opacity || 1,\r\n    color: a.color,\r\n  });\r\n\r\n  a.rectangles.forEach((r) => {\r\n    let line = document.createElementNS(\"http://www.w3.org/2000/svg\", \"line\");\r\n\r\n    setAttributes(line, {\r\n      x1: r.x,\r\n      y1: r.y,\r\n      x2: r.x + r.width,\r\n      y2: r.y,\r\n    });\r\n\r\n    group.appendChild(line);\r\n  });\r\n\r\n  return group;\r\n}\r\n","import setAttributes from '../utils/setAttributes';\r\nimport normalizeColor from '../utils/normalizeColor';\r\n\r\n/**\r\n * Create SVGPathElement from an annotation definition.\r\n * This is used for anntations of type `drawing`.\r\n *\r\n * @param {Object} a The annotation definition\r\n * @return {SVGPathElement} The path to be rendered\r\n */\r\nexport default function renderPath(a) {\r\n  let d = [];\r\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n  \r\n  for (let i=0, l=a.lines.length; i<l; i++) {\r\n    var p1 = a.lines[i];\r\n    var p2 = a.lines[i+1];\r\n    if (p2) {\r\n      d.push(`M${p1[0]} ${p1[1]} ${p2[0]} ${p2[1]}`);\r\n    }\r\n  }\r\n  \r\n  setAttributes(path, {\r\n    d: `${d.join(' ')}Z`,\r\n    stroke: normalizeColor(a.color || '#000'),\r\n    strokeWidth: a.width || 1,\r\n    fill: 'none'\r\n  });\r\n\r\n  return path;\r\n}\r\n","import setAttributes from '../utils/setAttributes';\r\n\r\nconst SIZE = 25;\r\nconst D = 'M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z';\r\n\r\n/**\r\n * Create SVGElement from an annotation definition.\r\n * This is used for anntations of type `comment`.\r\n *\r\n * @param {Object} a The annotation definition\r\n * @return {SVGElement} A svg to be rendered\r\n */\r\nexport default function renderPoint(a) {\r\n  let outerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n  let innerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n  let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n\r\n  setAttributes(outerSVG,  {\r\n    width: SIZE,\r\n    height: SIZE,\r\n    x: a.x,\r\n    y: a.y\r\n  });\r\n\r\n  setAttributes(innerSVG, {\r\n    width: SIZE,\r\n    height: SIZE,\r\n    x: 0,\r\n    y: (SIZE * 0.05) * -1,\r\n    viewBox: '0 0 1000 1000'\r\n  });\r\n\r\n  setAttributes(rect, {\r\n    width: SIZE,\r\n    height: SIZE,\r\n    stroke: '#000',\r\n    fill: '#ff0'\r\n  });\r\n\r\n  setAttributes(path, {\r\n    d: D,\r\n    strokeWidth: 50,\r\n    stroke: '#000',\r\n    fill: '#fff'\r\n  });\r\n\r\n  innerSVG.appendChild(path);\r\n  outerSVG.appendChild(rect);\r\n  outerSVG.appendChild(innerSVG);\r\n\r\n  return outerSVG;\r\n}\r\n","import setAttributes from \"../utils/setAttributes\";\r\nimport normalizeColor from \"../utils/normalizeColor\";\r\n\r\n/**\r\n * Create SVGRectElements from an annotation definition.\r\n * This is used for anntations of type `area` and `highlight`.\r\n *\r\n * @param {Object} a The annotation definition\r\n * @return {SVGGElement|SVGRectElement} A group of all rects to be rendered\r\n */\r\nexport default function renderRect(a) {\r\n  if (a.type === \"highlight\") {\r\n    let group = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\r\n    setAttributes(group, {\r\n      fill: normalizeColor(a.color || \"#ff0\"),\r\n      fillOpacity: 0.2,\r\n    });\r\n\r\n    a.rectangles.forEach((r) => {\r\n      group.appendChild(createRect(r));\r\n    });\r\n\r\n    return group;\r\n  } else {\r\n    let rect = createRect(a);\r\n    setAttributes(rect, {\r\n      stroke: normalizeColor(a.color || \"#f00\"),\r\n      fill: \"none\",\r\n    });\r\n\r\n    return rect;\r\n  }\r\n}\r\n\r\nfunction createRect(r) {\r\n  let rect = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\r\n\r\n  setAttributes(rect, {\r\n    x: r.x,\r\n    y: r.y,\r\n    width: r.width,\r\n    height: r.height,\r\n  });\r\n\r\n  return rect;\r\n}\r\n","import setAttributes from \"../utils/setAttributes\";\r\nimport normalizeColor from \"../utils/normalizeColor\";\r\n\r\n/**\r\n * Create SVGTextElement from an annotation definition.\r\n * This is used for anntations of type `textbox`.\r\n *\r\n * @param {Object} a The annotation definition\r\n * @return {SVGTextElement} A text to be rendered\r\n */\r\nexport default function renderText(a) {\r\n  var text = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\r\n\r\n  setAttributes(text, {\r\n    x: a.x,\r\n    y: a.y + parseInt(a.size, 10),\r\n    fill: normalizeColor(a.color || \"#000\"),\r\n    fontSize: a.size,\r\n  });\r\n\r\n  text.innerHTML = processTextContent(a);\r\n\r\n  return text;\r\n}\r\n\r\n/**\r\n * Process the content of the annotation to convert to html.\r\n * @param {*} comment The comment annotation.\r\n * @returns The processes annotation.\r\n */\r\nexport function processTextContent(comment) {\r\n  let lines = comment.content.split(\"\\n\");\r\n  let tspans = [];\r\n\r\n  // If we only have 1 line, we don't need to split anything up into smaller tspans.\r\n  if (lines.length === 1) {\r\n    return `<tspan x=\"${comment.x}\" dy=\"1em\">${comment.content}</tspan>`;\r\n  }\r\n  for (let index = 0; index < lines.length; index++) {\r\n    const line = lines[index];\r\n    if (line == \" \" || line == \"\") {\r\n      tspans.push(\r\n        `<tspan x=\"${comment.x}\" visibility=\"hidden\" dy=\"1em\">.</tspan>`\r\n      );\r\n    } else {\r\n      tspans.push(`<tspan x=\"${comment.x}\" dy=\"1em\">${line}</tspan>`);\r\n    }\r\n  }\r\n\r\n  return tspans.join(\"\");\r\n}\r\n","/**\r\n * Throw an Error for an abstract function that hasn't been implemented.\r\n *\r\n * @param {String} name The name of the abstract function\r\n */\r\nexport default function abstractFunction(name) {\r\n  throw new Error(name + ' is not implemented');\r\n}\r\n","const REGEX_HASHLESS_HEX = /^([a-f0-9]{6}|[a-f0-9]{3})$/i;\r\n\r\n/**\r\n * Normalize a color value\r\n *\r\n * @param {String} color The color to normalize\r\n * @return {String}\r\n */\r\nexport default function normalizeColor(color) {\r\n  if (REGEX_HASHLESS_HEX.test(color)) {\r\n    color = `#${color}`;\r\n  }\r\n  return color;\r\n}\r\n","const UPPER_REGEX = /[A-Z]/g;\r\n\r\n// Don't convert these attributes from camelCase to hyphenated-attributes\r\nconst BLACKLIST = [\r\n  'viewBox'\r\n];\r\n\r\nlet keyCase = (key) => {\r\n  if (BLACKLIST.indexOf(key) === -1) {\r\n    key = key.replace(UPPER_REGEX, match => '-' + match.toLowerCase());\r\n  }\r\n  return key;\r\n}\r\n\r\n/**\r\n * Set attributes for a node from a map\r\n *\r\n * @param {Node} node The node to set attributes on\r\n * @param {Object} attributes The map of key/value pairs to use for attributes\r\n */\r\nexport default function setAttributes(node, attributes) {\r\n  Object.keys(attributes).forEach((key) => {\r\n    node.setAttribute(keyCase(key), attributes[key]);\r\n  });\r\n}\r\n","const REGEXP = /[xy]/g\r\nconst PATTERN = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\r\n\r\nfunction replacement(c) {\r\n  let r = Math.random()*16|0;\r\n  let v = c == 'x' ? r : (r&0x3|0x8);\r\n  return v.toString(16);\r\n}\r\n\r\n/**\r\n * Generate a univierally unique identifier\r\n *\r\n * @return {String}\r\n */\r\nexport default function uuid() {\r\n  return PATTERN.replace(REGEXP, replacement);\r\n}\r\n","module.exports = function createStyleSheet(blocks) {\n  var style = document.createElement('style');\n  var text = Object.keys(blocks).map(function (selector) {\n    return processRuleSet(selector, blocks[selector]);\n  }).join('\\n');\n  \n  style.setAttribute('type', 'text/css');\n  style.appendChild(document.createTextNode(text));\n\n  return style;\n}\n\nfunction processRuleSet(selector, block) {\n  return selector + ' {\\n' + processDeclarationBlock(block) + '\\n}';\n}\n\nfunction processDeclarationBlock(block) {\n  return Object.keys(block).map(function (prop) {\n    return processDeclaration(prop, block[prop]);\n  }).join('\\n');\n}\n\nfunction processDeclaration(prop, value) {\n  if (!isNaN(value) && value != 0) {\n    value = value + 'px';\n  }\n\n  return hyphenate(prop) + ': ' + value + ';';\n}\n\nfunction hyphenate(prop) {\n  return prop.replace(/[A-Z]/g, function (match) {\n    return '-' + match.toLowerCase();\n  });\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import PDFJSAnnotate from './src/PDFJSAnnotate';\r\n\r\nexport default PDFJSAnnotate;\r\n"],"names":["StoreAdapter","LocalStoreAdapter","render","UI","__storeAdapter","getStoreAdapter","setStoreAdapter","adapter","getAnnotations","documentId","pageNumber","arguments","PDFJSAnnotate","appendChild","addEventListener","removeEventListener","BORDER_COLOR","disableUserSelect","enableUserSelect","findSVGContainer","findSVGAtPoint","getAnnotationRect","getMetadata","scaleDown","scaleUp","_enabled","isDragging","overlay","dragOffsetX","dragOffsetY","dragStartX","dragStartY","OVERLAY_BORDER_SIZE","createEditOverlay","target","destroyEditOverlay","document","createElement","anchor","parentNode","id","getAttribute","rect","showOverlay","styleLeft","left","styleTop","top","setAttribute","style","boxSizing","position","width","height","border","borderRadius","innerHTML","background","color","fontSize","padding","textAlign","textDecoration","right","handleDocumentClick","handleDocumentKeyup","handleDocumentMousedown","deleteAnnotation","borderColor","boxShadow","display","event","Event","dispatchEvent","removeChild","handleDocumentMousemove","handleDocumentMouseup","annotationId","nodes","querySelectorAll","svg","querySelector","forEach","n","e","clientX","clientY","getElementById","keyCode","nodeName","toLowerCase","type","offsetLeft","offsetTop","cursor","getBoundingClientRect","y","x","minY","maxY","minX","maxX","offsetHeight","offsetWidth","getDelta","propX","propY","calcDelta","parseInt","deltaX","deltaY","getAnnotation","then","annotation","indexOf","t","i","modelY","viewY","rectangles","modelX","viewX","Array","from","children","child","lines","originX","originY","line","editAnnotation","setTimeout","handleAnnotationClick","selectAnnotationFromId","deleteAnnotationFromId","clearAll","annotations","enableEdit","disableEdit","EventEmitter","findAnnotationAtPoint","emitter","clickNode","emit","fireEvent","on","removeListener","disablePen","enablePen","setPen","disablePoint","enablePoint","disableRect","enableRect","highlightText","editRect","disableText","enableText","setText","openTextInput","editText","createPage","renderPage","renderScreenReaderHints","PAGE_TEMPLATE","temp","page","canvas","mozOpaque","renderOptions","pdfDocument","scale","rotate","eventBus","pdfjsViewer","EventBus","Promise","all","getPage","pdfPage","canvasContext","getContext","alpha","viewport","getViewport","rotation","transform","scalePage","renderInteractiveForms","getTextContent","normalizeWhitespace","textContent","resolve","reject","textLayer","textLayerFactory","DefaultTextLayerFactory","textLayerBuilder","createTextLayerBuilder","setTextContent","annotationLayer","annotationLayerFactory","DefaultAnnotationLayerFactory","annotationLayerBuilder","createAnnotationLayerBuilder","context","wrapper","outputScale","getOutputScale","scaled","sx","sy","sfx","approximateFraction","sfy","visibility","roundToDivide","Math","floor","xinv","limit","x_","a","b","c","d","p","q","ctx","devicePixelRatio","window","backingStoreRatio","webkitBackingStorePixelRatio","pixelRatio","div","r","round","_penSize","_penColor","path","length","addAnnotation","savePoint","point","push","penSize","penColor","input","handleInputBlur","handleInputKeyup","focus","closeInput","value","trim","content","Object","assign","addComment","uuid","getOffset","_type","getSelectionRects","selection","getSelection","range","getRangeAt","rects","getClientRects","bottom","saveRect","map","removeAllRanges","node","boundingRect","offset","filter","newAnnotation","attributes","stroke","opacity","strokeWidth","processTextContent","textArea","_textSize","_textColor","whiteSpace","saveText","size","CustomEvent","detail","textSize","textColor","newText","createStyleSheet","userSelectStyleSheet","body","toUpperCase","elements","l","el","pointIntersectsRect","getOffsetAnnotationRect","h","w","LINE_OFFSET","replace","split","splice","s","result","includes","keys","key","getScroll","scrollTop","scrollLeft","head","JSON","parse","createScreenReaderOnly","text","createTextNode","overflow","insertScreenReaderHint","insertScreenReaderComment","renderScreenReaderComments","initEventHandlers","reorderAnnotationsByType","removeAnnotation","insertComment","removeComment","removeElementById","comment","list","promise","commentId","elementId","insertElementWithinElement","insertElementWithinChildren","insertBefore","textRect","OFFSET_ADJUST","max","textLayerElementFromPoint","cloneNode","tail","unshift","pop","join","outerHTML","item","COMMENT_TYPES","num","first","last","comments","isArray","getComments","SORT_TYPES","sortBy","sort","sortByPoint","sortByRectPoint","sortByLinePoint","lineA","lineB","findAnnotation","updateAnnotations","index","deleteComment","localStorage","getItem","setItem","stringify","abstractFunction","definition","__getAnnotations","fn","__addAnnotation","__editAnnotation","__deleteAnnotation","success","__addComment","__deleteComment","objectAssign","renderLine","renderPath","renderPoint","renderRect","renderText","isFirefox","test","navigator","userAgent","getTranslation","trans","data","removeAttribute","setAttributes","normalizeColor","group","createElementNS","x1","y1","x2","y2","p1","p2","fill","SIZE","D","outerSVG","innerSVG","viewBox","fillOpacity","createRect","tspans","name","Error","REGEX_HASHLESS_HEX","UPPER_REGEX","BLACKLIST","keyCase","match","REGEXP","PATTERN","replacement","random","v","toString"],"sourceRoot":""}